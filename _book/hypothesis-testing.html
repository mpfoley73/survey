<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>1.2 Hypothesis Testing | Statistical Inference</title>
  <meta name="description" content="Notes cobbled together from books, online classes, etc. to be used as quick reference for common work projects." />
  <meta name="generator" content="bookdown 0.33 and GitBook 2.6.7" />

  <meta property="og:title" content="1.2 Hypothesis Testing | Statistical Inference" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="Notes cobbled together from books, online classes, etc. to be used as quick reference for common work projects." />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="1.2 Hypothesis Testing | Statistical Inference" />
  
  <meta name="twitter:description" content="Notes cobbled together from books, online classes, etc. to be used as quick reference for common work projects." />
  

<meta name="author" content="Michael Foley" />


<meta name="date" content="2023-04-09" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="central-tendancy-and-dispersion.html"/>
<link rel="next" href="likelihood-statistics.html"/>
<script src="assets/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="assets/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="assets/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="assets/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="assets/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="assets/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="assets/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="assets/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="assets/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="assets/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="assets/anchor-sections-1.1.0/anchor-sections.js"></script>
<script src="assets/kePrint-0.0.1/kePrint.js"></script>
<link href="assets/lightable-0.0.1/lightable.css" rel="stylesheet" />
<link href="assets/tabwid-1.1.3/tabwid.css" rel="stylesheet" />
<script src="assets/tabwid-1.1.3/tabwid.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Preface</a></li>
<li class="chapter" data-level="1" data-path="frequentist-statistics.html"><a href="frequentist-statistics.html"><i class="fa fa-check"></i><b>1</b> Frequentist Statistics</a>
<ul>
<li class="chapter" data-level="1.1" data-path="central-tendancy-and-dispersion.html"><a href="central-tendancy-and-dispersion.html"><i class="fa fa-check"></i><b>1.1</b> Central Tendancy and Dispersion</a></li>
<li class="chapter" data-level="1.2" data-path="hypothesis-testing.html"><a href="hypothesis-testing.html"><i class="fa fa-check"></i><b>1.2</b> Hypothesis Testing</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="likelihood-statistics.html"><a href="likelihood-statistics.html"><i class="fa fa-check"></i><b>2</b> Likelihood Statistics</a>
<ul>
<li class="chapter" data-level="2.1" data-path="maximum-likelihood-estimation.html"><a href="maximum-likelihood-estimation.html"><i class="fa fa-check"></i><b>2.1</b> Maximum Likelihood Estimation</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="bayesian-statistics.html"><a href="bayesian-statistics.html"><i class="fa fa-check"></i><b>3</b> Bayesian Statistics</a>
<ul>
<li class="chapter" data-level="3.1" data-path="bayes-law.html"><a href="bayes-law.html"><i class="fa fa-check"></i><b>3.1</b> Bayes’ Law</a></li>
<li class="chapter" data-level="3.2" data-path="bayesian-inference.html"><a href="bayesian-inference.html"><i class="fa fa-check"></i><b>3.2</b> Bayesian Inference</a></li>
<li class="chapter" data-level="3.3" data-path="discrete-cases.html"><a href="discrete-cases.html"><i class="fa fa-check"></i><b>3.3</b> Discrete Cases</a></li>
<li class="chapter" data-level="3.4" data-path="continuous-cases.html"><a href="continuous-cases.html"><i class="fa fa-check"></i><b>3.4</b> Continuous Cases</a></li>
<li class="chapter" data-level="3.5" data-path="bayes-factors.html"><a href="bayes-factors.html"><i class="fa fa-check"></i><b>3.5</b> Bayes Factors</a></li>
<li class="chapter" data-level="3.6" data-path="a-gentler-introduction.html"><a href="a-gentler-introduction.html"><i class="fa fa-check"></i><b>3.6</b> A Gentler Introduction</a></li>
<li class="chapter" data-level="3.7" data-path="coursera-notes-inference.html"><a href="coursera-notes-inference.html"><i class="fa fa-check"></i><b>3.7</b> Coursera Notes Inference</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="one-sample.html"><a href="one-sample.html"><i class="fa fa-check"></i><b>4</b> One-Sample</a>
<ul>
<li class="chapter" data-level="4.1" data-path="one-sample-mean-z-test.html"><a href="one-sample-mean-z-test.html"><i class="fa fa-check"></i><b>4.1</b> One-Sample Mean z Test</a></li>
<li class="chapter" data-level="4.2" data-path="one-sample-mean-t-test.html"><a href="one-sample-mean-t-test.html"><i class="fa fa-check"></i><b>4.2</b> One-Sample Mean t Test</a></li>
<li class="chapter" data-level="4.3" data-path="one-sample-median-wilcoxon-test.html"><a href="one-sample-median-wilcoxon-test.html"><i class="fa fa-check"></i><b>4.3</b> One-Sample Median Wilcoxon Test</a></li>
<li class="chapter" data-level="4.4" data-path="chi-squared-goodness-of-fit-test.html"><a href="chi-squared-goodness-of-fit-test.html"><i class="fa fa-check"></i><b>4.4</b> Chi-Squared Goodness-of-Fit Test</a></li>
<li class="chapter" data-level="4.5" data-path="g-test.html"><a href="g-test.html"><i class="fa fa-check"></i><b>4.5</b> G-Test</a></li>
<li class="chapter" data-level="4.6" data-path="one-sample-poisson-test.html"><a href="one-sample-poisson-test.html"><i class="fa fa-check"></i><b>4.6</b> One-Sample Poisson Test</a></li>
<li class="chapter" data-level="4.7" data-path="exact-binomial-test.html"><a href="exact-binomial-test.html"><i class="fa fa-check"></i><b>4.7</b> Exact Binomial Test</a></li>
<li class="chapter" data-level="4.8" data-path="one-sample-proportion-z-test.html"><a href="one-sample-proportion-z-test.html"><i class="fa fa-check"></i><b>4.8</b> One-Sample Proportion z Test</a></li>
<li class="chapter" data-level="4.9" data-path="sample-t-test-for-categorical-var.html"><a href="sample-t-test-for-categorical-var.html"><i class="fa fa-check"></i><b>4.9</b> 1 sample t Test for Categorical Var</a></li>
<li class="chapter" data-level="4.10" data-path="wilcoxon-1-sample-median-test-for-categorical-var.html"><a href="wilcoxon-1-sample-median-test-for-categorical-var.html"><i class="fa fa-check"></i><b>4.10</b> Wilcoxon 1-Sample Median Test for Categorical Var</a></li>
<li class="chapter" data-level="4.11" data-path="multivariate-statistics.html"><a href="multivariate-statistics.html"><i class="fa fa-check"></i><b>4.11</b> Multivariate Statistics</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="group-differences.html"><a href="group-differences.html"><i class="fa fa-check"></i><b>5</b> Group Differences</a>
<ul>
<li class="chapter" data-level="5.1" data-path="ttest.html"><a href="ttest.html"><i class="fa fa-check"></i><b>5.1</b> Independent Samples t-Test</a></li>
<li class="chapter" data-level="5.2" data-path="wilcoxonranksum.html"><a href="wilcoxonranksum.html"><i class="fa fa-check"></i><b>5.2</b> Wilcoxon Rank Sum Test</a></li>
<li class="chapter" data-level="" data-path="case-study-1.html"><a href="case-study-1.html"><i class="fa fa-check"></i>Case Study 1</a></li>
<li class="chapter" data-level="5.3" data-path="pairedttest.html"><a href="pairedttest.html"><i class="fa fa-check"></i><b>5.3</b> Paired Samples t-Test</a></li>
<li class="chapter" data-level="5.4" data-path="wilcoxonsignedrank.html"><a href="wilcoxonsignedrank.html"><i class="fa fa-check"></i><b>5.4</b> Wilcoxon Signed-Rank Test</a></li>
<li class="chapter" data-level="" data-path="case-study-2.html"><a href="case-study-2.html"><i class="fa fa-check"></i>Case Study 2</a></li>
<li class="chapter" data-level="5.5" data-path="onewayanova.html"><a href="onewayanova.html"><i class="fa fa-check"></i><b>5.5</b> One-way ANOVA</a></li>
<li class="chapter" data-level="5.6" data-path="kw.html"><a href="kw.html"><i class="fa fa-check"></i><b>5.6</b> Kruskal–Wallis Test</a></li>
<li class="chapter" data-level="" data-path="groupdiffscs3.html"><a href="groupdiffscs3.html"><i class="fa fa-check"></i>Case Study 3</a></li>
<li class="chapter" data-level="5.7" data-path="chisqhomogeneity.html"><a href="chisqhomogeneity.html"><i class="fa fa-check"></i><b>5.7</b> Chi-Square Test of Homogeneity</a></li>
<li class="chapter" data-level="5.8" data-path="fisherexact.html"><a href="fisherexact.html"><i class="fa fa-check"></i><b>5.8</b> Fisher’s Exact Test</a></li>
<li class="chapter" data-level="" data-path="case-study-4.html"><a href="case-study-4.html"><i class="fa fa-check"></i>Case Study 4</a></li>
<li class="chapter" data-level="5.9" data-path="pairwiseproptest.html"><a href="pairwiseproptest.html"><i class="fa fa-check"></i><b>5.9</b> Pairwise Prop Test</a></li>
<li class="chapter" data-level="5.10" data-path="mcnemar.html"><a href="mcnemar.html"><i class="fa fa-check"></i><b>5.10</b> McNemar’s Test</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="association.html"><a href="association.html"><i class="fa fa-check"></i><b>6</b> Association</a>
<ul>
<li class="chapter" data-level="6.1" data-path="pearson.html"><a href="pearson.html"><i class="fa fa-check"></i><b>6.1</b> Pearson’s Correlation</a></li>
<li class="chapter" data-level="6.2" data-path="spearman.html"><a href="spearman.html"><i class="fa fa-check"></i><b>6.2</b> Spearman’s Rho</a></li>
<li class="chapter" data-level="6.3" data-path="kendall.html"><a href="kendall.html"><i class="fa fa-check"></i><b>6.3</b> Kendal’s Tau</a></li>
<li class="chapter" data-level="6.4" data-path="case-study-pearson-spearman-kendall.html"><a href="case-study-pearson-spearman-kendall.html"><i class="fa fa-check"></i><b>6.4</b> Case Study: Pearson, Spearman, Kendall</a></li>
<li class="chapter" data-level="6.5" data-path="chisq-independence.html"><a href="chisq-independence.html"><i class="fa fa-check"></i><b>6.5</b> Chi-Square Test of Independence</a></li>
<li class="chapter" data-level="6.6" data-path="fisher-exact.html"><a href="fisher-exact.html"><i class="fa fa-check"></i><b>6.6</b> Fisher’s Exact Test</a></li>
<li class="chapter" data-level="6.7" data-path="case-study-chi-square-fisher.html"><a href="case-study-chi-square-fisher.html"><i class="fa fa-check"></i><b>6.7</b> Case Study: Chi-Square, Fisher</a></li>
<li class="chapter" data-level="6.8" data-path="kruskals-lambda.html"><a href="kruskals-lambda.html"><i class="fa fa-check"></i><b>6.8</b> Kruskal’s Lambda</a></li>
<li class="chapter" data-level="6.9" data-path="relative-risk.html"><a href="relative-risk.html"><i class="fa fa-check"></i><b>6.9</b> Relative Risk</a></li>
<li class="chapter" data-level="6.10" data-path="odds-ratio.html"><a href="odds-ratio.html"><i class="fa fa-check"></i><b>6.10</b> Odds Ratio</a></li>
<li class="chapter" data-level="6.11" data-path="partial-correlation.html"><a href="partial-correlation.html"><i class="fa fa-check"></i><b>6.11</b> Partial Correlation</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="matrix-algebra.html"><a href="matrix-algebra.html"><i class="fa fa-check"></i><b>7</b> Matrix Algebra</a>
<ul>
<li class="chapter" data-level="7.1" data-path="central-tendancy-dispersion-and-association.html"><a href="central-tendancy-dispersion-and-association.html"><i class="fa fa-check"></i><b>7.1</b> Central Tendancy, Dispersion, and Association</a></li>
<li class="chapter" data-level="7.2" data-path="linear-transformations.html"><a href="linear-transformations.html"><i class="fa fa-check"></i><b>7.2</b> Linear Transformations</a></li>
<li class="chapter" data-level="7.3" data-path="multivariate-normal-distribution.html"><a href="multivariate-normal-distribution.html"><i class="fa fa-check"></i><b>7.3</b> Multivariate Normal Distribution</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Statistical Inference</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="hypothesis-testing" class="section level2 hasAnchor" number="1.2">
<h2><span class="header-section-number">1.2</span> Hypothesis Testing<a href="hypothesis-testing.html#hypothesis-testing" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p><em>P</em>-values express how surprising a summary measure is given the null hypothesis (H0). Suppose you hypothesize that IQs have increased from the intended mean of <span class="math inline">\(\mu\)</span> = 100, <span class="math inline">\(\sigma\)</span> = 15. H0 is <span class="math inline">\(\mu_0\)</span> = 100 with alternative H1 that <span class="math inline">\(\mu\)</span> &gt; 100. Suppose also that you are <em>right</em>: <span class="math inline">\(\mu\)</span> is actually 106.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="hypothesis-testing.html#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123456</span>)</span>
<span id="cb1-2"><a href="hypothesis-testing.html#cb1-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-3"><a href="hypothesis-testing.html#cb1-3" aria-hidden="true" tabindex="-1"></a>mu_0 <span class="ot">&lt;-</span> <span class="dv">100</span></span>
<span id="cb1-4"><a href="hypothesis-testing.html#cb1-4" aria-hidden="true" tabindex="-1"></a>sigma <span class="ot">&lt;-</span> <span class="dv">15</span></span>
<span id="cb1-5"><a href="hypothesis-testing.html#cb1-5" aria-hidden="true" tabindex="-1"></a>mu <span class="ot">&lt;-</span> <span class="dv">106</span></span>
<span id="cb1-6"><a href="hypothesis-testing.html#cb1-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-7"><a href="hypothesis-testing.html#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a population of size N with values plucked from normal dist centered at</span></span>
<span id="cb1-8"><a href="hypothesis-testing.html#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="co"># mu_0 and mu.</span></span>
<span id="cb1-9"><a href="hypothesis-testing.html#cb1-9" aria-hidden="true" tabindex="-1"></a>N <span class="ot">&lt;-</span> <span class="fl">1E6</span> <span class="co"># a big number</span></span>
<span id="cb1-10"><a href="hypothesis-testing.html#cb1-10" aria-hidden="true" tabindex="-1"></a>pop_100 <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">person =</span> <span class="fu">seq</span>(<span class="dv">1</span>, N), <span class="at">iq =</span> <span class="fu">rnorm</span>(N, mu_0, sigma))</span>
<span id="cb1-11"><a href="hypothesis-testing.html#cb1-11" aria-hidden="true" tabindex="-1"></a>pop_106 <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">person =</span> <span class="fu">seq</span>(<span class="dv">1</span>, N), <span class="at">iq =</span> <span class="fu">rnorm</span>(N, mu, sigma))</span></code></pre></div>
<p>The presumed distribution of IQs might look like this.</p>
<p><img src="statistics_files/figure-html/unnamed-chunk-4-1.png" width="672" /></p>
<p>Take a random sample of <em>n</em> = 30 IQs from the population.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="hypothesis-testing.html#cb2-1" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">30</span></span>
<span id="cb2-2"><a href="hypothesis-testing.html#cb2-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-3"><a href="hypothesis-testing.html#cb2-3" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">sample</span>(pop_106<span class="sc">$</span>iq, n)</span>
<span id="cb2-4"><a href="hypothesis-testing.html#cb2-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-5"><a href="hypothesis-testing.html#cb2-5" aria-hidden="true" tabindex="-1"></a>(x_bar <span class="ot">&lt;-</span> <span class="fu">mean</span>(x)) <span class="sc">%&gt;%</span> scales<span class="sc">::</span><span class="fu">comma</span>(.<span class="dv">1</span>)</span>
<span id="cb2-6"><a href="hypothesis-testing.html#cb2-6" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] &quot;105.6&quot;</span></span>
<span id="cb2-7"><a href="hypothesis-testing.html#cb2-7" aria-hidden="true" tabindex="-1"></a>(s <span class="ot">&lt;-</span> <span class="fu">sd</span>(x)) <span class="sc">%&gt;%</span> scales<span class="sc">::</span><span class="fu">comma</span>(.<span class="dv">1</span>)</span>
<span id="cb2-8"><a href="hypothesis-testing.html#cb2-8" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] &quot;15.2&quot;</span></span></code></pre></div>
<p>The sample has <span class="math inline">\(\bar{x}\)</span> = 105.6, SD = 15.2. How surprising is this if H0 is true? I.e., what is the <em>probability</em> of observing 105.6 when <span class="math inline">\(\mu\)</span> is 100? According to the Central Limit Theorem (CLM), repeated samples of size <em>n</em> from a large population will yield <span class="math inline">\(\bar{x}\)</span> values that approach a normal distribution centered at <span class="math inline">\(\mu\)</span> with a standard deviation equal to the the <em>standard error</em>, <span class="math inline">\(SE = \frac{\sigma}{\sqrt{n}}\)</span> where <span class="math inline">\(\sigma\)</span> is the population SD. In this example, <em>n</em> = 30, so <em>SE</em> = <span class="math inline">\(15/\sqrt{30}\)</span> = 2.7 and repeated samples would be expected to be distributed <span class="math inline">\(\sim N(100.0, 2.7^2).\)</span> You can verify this empirically with a simulation.</p>
<p><img src="statistics_files/figure-html/unnamed-chunk-6-1.png" width="672" /></p>
<p>But you measured <span class="math inline">\(\bar{x}\)</span> = 105.6. The probability of measuring a value <span class="math inline">\(z = \frac{\bar{x} - \mu_0}{\sigma / \sqrt{n}} = \frac{105.6 - 100}{2.7}\)</span> &gt;= 2.0 standard errors greater than 100 is 0.020. A common threshold probability is <span class="math inline">\(\alpha\)</span> = .05 level of significance. A sample of 30 from a population with <span class="math inline">\(\mu\)</span> = 100 that has a mean greater than <code>qnorm(.05, 100, 15 / sqrt(30), lower.tail = FALSE)</code> = 104.5 would occur with less than 5% probability.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="hypothesis-testing.html#cb3-1" aria-hidden="true" tabindex="-1"></a>z <span class="ot">&lt;-</span> (x_bar <span class="sc">-</span> mu_0) <span class="sc">/</span> (sigma <span class="sc">/</span> <span class="fu">sqrt</span>(n))</span>
<span id="cb3-2"><a href="hypothesis-testing.html#cb3-2" aria-hidden="true" tabindex="-1"></a>critical_value <span class="ot">&lt;-</span> <span class="fu">qnorm</span>(.<span class="dv">95</span>, mu_0, sigma <span class="sc">/</span> <span class="fu">sqrt</span>(n))</span></code></pre></div>
<p><img src="statistics_files/figure-html/unnamed-chunk-8-1.png" width="672" /></p>
<p>The sampling mean is <span class="math inline">\(\bar{x}\)</span> = 105.6, well into the <span class="math inline">\(\alpha\)</span> &lt;= .05 shaded region. The probability of measuring a mean IQ of 105.6 from a sample of size <em>n</em> = 30 when the population mean is 100 is <em>p</em> = 0.020, meaning only 2.0% of the area under the distribution is to the right of 105.6. Using an <span class="math inline">\(\alpha\)</span> = .05 level of significance, reject H0. This is a <em>true positive</em> because the population mean is 106, not 100. Imagine a stricter level of significance, shrinking the shaded region right of 105.6. You would mistakenly fail to reject H0, a <em>false negative</em> (Type II error). The <span class="math inline">\(\beta\)</span> blue-shaded region is Type II error probability. Any measured mean in this region would be greater than <span class="math inline">\(mu_0\)</span> = 100, yet not be rejected by the statistical test.</p>
<div id="type-i-and-ii-errors" class="section level3 unnumbered hasAnchor">
<h3>Type I and II Errors<a href="hypothesis-testing.html#type-i-and-ii-errors" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Either H0 or H1 is correct, and you must choose to either reject or not reject H0. That means there are four possible states at the end of your analysis. If your summary measure is extreme enough for you to declare a “positive” result and reject H0, you are either correct (true positive) or incorrect (false positive). False positives are called <em>Type I errors</em>. Alternatively, if it is <em>not</em> extreme enough, you are either correct (true negative) or incorrect (false negative). False negatives are called <em>Type II errors</em>.</p>
<p>The probabilities of landing in these four states depend on your chosen significance level, <span class="math inline">\(\alpha\)</span>, and on the statistical power of the study, 1 - <span class="math inline">\(\beta\)</span>.</p>
<table>
<colgroup>
<col width="28%" />
<col width="36%" />
<col width="34%" />
</colgroup>
<thead>
<tr class="header">
<th></th>
<th>H0 True</th>
<th>H1 True</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Significance test is positive, so you reject H0.</td>
<td>False Positive <br>Type I Error<br> Probability = <span class="math inline">\(\alpha\)</span></td>
<td>True Positive <br>Good Call! <br> Probability = 1 - <span class="math inline">\(\beta\)</span></td>
</tr>
<tr class="even">
<td>Significance test is negative, so you do <em>not</em> reject H0.</td>
<td>True Negative <br> Good Call!<br> Probability = (<span class="math inline">\(1 - \alpha\)</span>)</td>
<td>False Negative <br>Type II Error <br>Probability = <span class="math inline">\(\beta\)</span></td>
</tr>
</tbody>
</table>
<p><span class="math inline">\(\alpha\)</span> is the expected Type I error rate - extreme summary measures occurring by chance. <span class="math inline">\(\beta\)</span> is the expected Type II error rate - summary measures that by chance were not extreme enough to reject H0. In the IQ example, if the population mean was <span class="math inline">\(\mu\)</span> = 100, any sample mean greater than <code>qnorm(.95, 100, 15/sqrt(n))</code> = 104.5 would be mistakenly rejected at the <span class="math inline">\(\alpha\)</span> = .05 significance level, a false positive. If the population mean was <span class="math inline">\(\mu\)</span> = 106, any sample mean less than 104.5 would be mistakenly <em>not</em> rejected, a false negative.</p>
<p>The plot below shows how the sampling distributions of the null hypothesis and a potentially different true population overlap to create the four zones. The first facet uses a sample size of <em>n</em> = 30. The second uses <em>n</em> = 50, resulting in tighter distributions.</p>
<ul>
<li><p>If the presumed (H0) population value is accurate, then your risk is in accidentally rejecting H0. Any sample mean in the <span class="math inline">\(\alpha\)</span> region would incorrectly reject H0 (Type I).</p></li>
<li><p>If the presumed (H0) population value is wrong, and the true value is actually the (unknown) gold color population to the right, then your risk is in failing to reject H0. Any sample mean in the <span class="math inline">\(\beta\)</span> region would incorrectly fail to reject H0 (Type II).</p></li>
</ul>
<p><img src="statistics_files/figure-html/unnamed-chunk-9-1.png" width="672" /></p>
<p>You don’t see much discussion of <span class="math inline">\(\beta\)</span> is reports because <span class="math inline">\(\beta\)</span> is an unknown value based on the true population whose center you do not know. <span class="math inline">\(\beta\)</span> is relevant at the <em>design</em> stage where it informs how large your sample size needs to be in order to reject H0. In this example, <span class="math inline">\(\mu\)</span> is 6 points larger than <span class="math inline">\(\mu_0\)</span>. With a sample size of <em>n</em> = 30, the sample mean needs to be at least 104.5 for you to reject H0 at the <span class="math inline">\(\alpha\)</span> = .05 level. If you want to reject H0 with a smaller difference, you need a larger sample size. A sample size of <em>n</em> = 50 lets you reject H0 with a sample mean of only 103.5. Interestingly, you can see how there can be such a thing as too much power. If <em>n</em> is large enough, you can reject H0 with a sample mean that is only trivially larger than the presumed value.</p>
</div>
<div id="statistical-power" class="section level3 unnumbered hasAnchor">
<h3>Statistical Power<a href="hypothesis-testing.html#statistical-power" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The ability to detect a difference when it exists (the true positive) is called the power of the test. Its measured by the area outside of <span class="math inline">\(\beta\)</span>. Changing <em>n</em> from 30 to 50 reduced the area in the <span class="math inline">\(\beta\)</span> region, and therefore increased the power of the test.</p>
<p>Statistical power is an increasing function of sample size, effect size, and significance level. The positive association with significance level means there is a trade-off between Type I and Type II error rates. A small <span class="math inline">\(\alpha\)</span> sets a high bar for rejecting H0, but you run the risk of failing to appreciate a <em>real</em> difference. On the other hand, a large <span class="math inline">\(\alpha\)</span> sets a low bar for rejecting H0, but you run the risk of mistaking a random difference as real.</p>
<p>The 1 - <span class="math inline">\(\beta\)</span> statistical power threshold is usually set at .80, similar to the <span class="math inline">\(\alpha\)</span> = .05 level of significance threshold convention. Given a real effect, a study with a statistical power of .80 will only find a positive test result 80% of the time. You may think more power is better, but beware that with a large enough sample size, even trivial effect sizes may yield a positive test result. You need to consider both sides of this coin.</p>
<p>A <em>power analysis</em> is frequently used to determine the sample size required to detect a threshold effect size given an <span class="math inline">\(\alpha\)</span> level of significance. A power analysis expresses the relationship among four components. If you know any three, it tells you the fourth: The components are i) 1 - <span class="math inline">\(\beta\)</span>, ii) <em>n</em>, iii) <span class="math inline">\(\alpha\)</span>, and iv) expected effect size, Cohen’s d = <span class="math inline">\((\bar{x} - \mu_0)/\sigma\)</span>.</p>
<p>Suppose you set power at .80, significance level at .05, and <em>n</em> = 30. What effect size will this design detect?</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="hypothesis-testing.html#cb4-1" aria-hidden="true" tabindex="-1"></a>(pwr <span class="ot">&lt;-</span> pwr<span class="sc">::</span><span class="fu">pwr.t.test</span>(</span>
<span id="cb4-2"><a href="hypothesis-testing.html#cb4-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">n =</span> <span class="dv">30</span>,</span>
<span id="cb4-3"><a href="hypothesis-testing.html#cb4-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">sig.level =</span> .<span class="dv">05</span>,</span>
<span id="cb4-4"><a href="hypothesis-testing.html#cb4-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">power =</span> <span class="fl">0.80</span>,</span>
<span id="cb4-5"><a href="hypothesis-testing.html#cb4-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">type =</span> <span class="st">&quot;one.sample&quot;</span>,</span>
<span id="cb4-6"><a href="hypothesis-testing.html#cb4-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">alternative =</span> <span class="st">&quot;greater&quot;</span></span>
<span id="cb4-7"><a href="hypothesis-testing.html#cb4-7" aria-hidden="true" tabindex="-1"></a>))</span>
<span id="cb4-8"><a href="hypothesis-testing.html#cb4-8" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb4-9"><a href="hypothesis-testing.html#cb4-9" aria-hidden="true" tabindex="-1"></a><span class="do">##      One-sample t test power calculation </span></span>
<span id="cb4-10"><a href="hypothesis-testing.html#cb4-10" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb4-11"><a href="hypothesis-testing.html#cb4-11" aria-hidden="true" tabindex="-1"></a><span class="do">##               n = 30</span></span>
<span id="cb4-12"><a href="hypothesis-testing.html#cb4-12" aria-hidden="true" tabindex="-1"></a><span class="do">##               d = 0.464949</span></span>
<span id="cb4-13"><a href="hypothesis-testing.html#cb4-13" aria-hidden="true" tabindex="-1"></a><span class="do">##       sig.level = 0.05</span></span>
<span id="cb4-14"><a href="hypothesis-testing.html#cb4-14" aria-hidden="true" tabindex="-1"></a><span class="do">##           power = 0.8</span></span>
<span id="cb4-15"><a href="hypothesis-testing.html#cb4-15" aria-hidden="true" tabindex="-1"></a><span class="do">##     alternative = greater</span></span></code></pre></div>
<p>An effect size of <em>d</em> = 0.465 will fall in the <span class="math inline">\(\alpha\)</span> = .05 region with probability 1 - <span class="math inline">\(\beta\)</span> = .80 if the sample size is <em>n</em> = 30. Multiply <em>d</em> = 0.465 by <span class="math inline">\(\sigma\)</span> = 15 to convert to the IQ units, 7.0. More likely, you will use the power test to detect the required sample size. Suppose you set <span class="math inline">\(1 - \beta\)</span> = .8 and <span class="math inline">\(\alpha = .05\)</span>, and want to detect an effect size of <span class="math inline">\(5 / 15\)</span>.</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="hypothesis-testing.html#cb5-1" aria-hidden="true" tabindex="-1"></a>(pwr <span class="ot">&lt;-</span> pwr<span class="sc">::</span><span class="fu">pwr.t.test</span>(</span>
<span id="cb5-2"><a href="hypothesis-testing.html#cb5-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">d =</span> <span class="dv">5</span> <span class="sc">/</span> <span class="dv">15</span>,</span>
<span id="cb5-3"><a href="hypothesis-testing.html#cb5-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">sig.level =</span> .<span class="dv">05</span>,</span>
<span id="cb5-4"><a href="hypothesis-testing.html#cb5-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">power =</span> <span class="fl">0.80</span>,</span>
<span id="cb5-5"><a href="hypothesis-testing.html#cb5-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">type =</span> <span class="st">&quot;one.sample&quot;</span>,</span>
<span id="cb5-6"><a href="hypothesis-testing.html#cb5-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">alternative =</span> <span class="st">&quot;greater&quot;</span></span>
<span id="cb5-7"><a href="hypothesis-testing.html#cb5-7" aria-hidden="true" tabindex="-1"></a>))</span>
<span id="cb5-8"><a href="hypothesis-testing.html#cb5-8" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb5-9"><a href="hypothesis-testing.html#cb5-9" aria-hidden="true" tabindex="-1"></a><span class="do">##      One-sample t test power calculation </span></span>
<span id="cb5-10"><a href="hypothesis-testing.html#cb5-10" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb5-11"><a href="hypothesis-testing.html#cb5-11" aria-hidden="true" tabindex="-1"></a><span class="do">##               n = 57.02048</span></span>
<span id="cb5-12"><a href="hypothesis-testing.html#cb5-12" aria-hidden="true" tabindex="-1"></a><span class="do">##               d = 0.3333333</span></span>
<span id="cb5-13"><a href="hypothesis-testing.html#cb5-13" aria-hidden="true" tabindex="-1"></a><span class="do">##       sig.level = 0.05</span></span>
<span id="cb5-14"><a href="hypothesis-testing.html#cb5-14" aria-hidden="true" tabindex="-1"></a><span class="do">##           power = 0.8</span></span>
<span id="cb5-15"><a href="hypothesis-testing.html#cb5-15" aria-hidden="true" tabindex="-1"></a><span class="do">##     alternative = greater</span></span></code></pre></div>
<p>You need a larger sample, <em>n</em> = 58. You can use the power test formula for various <em>n</em> sizes to see the relationship with effect size. <em>Note: the y-axis multiplies Cohen’s d by <span class="math inline">\(\sigma\)</span> to get the effect size in original units</em>.</p>
<pre><code>## Warning: Using `size` aesthetic for lines was deprecated in ggplot2
## 3.4.0.
## ℹ Please use `linewidth` instead.
## This warning is displayed once every 8 hours.
## Call `lifecycle::last_lifecycle_warnings()` to see where this
## warning was generated.</code></pre>
<p><img src="statistics_files/figure-html/unnamed-chunk-12-1.png" width="672" /></p>
<p>The dashed lines show a sample size of 30 is required to detect an effect size of 7 at a .05 significance level with 80% probability.</p>
</div>
<div id="what-p-values-would-you-expect" class="section level3 unnumbered hasAnchor">
<h3>What p-values would you expect?<a href="hypothesis-testing.html#what-p-values-would-you-expect" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>What distribution of p-values would you expect if there <em>is</em> a true effect and you repeated the study many times? What if there is <em>no</em> true effect? The answer is completely determined by the statistical power of the study.<a href="#fn1" class="footnote-ref" id="fnref1"><sup>1</sup></a></p>
<p>To see this, run 100,000 simulations of an experiment measuring the average IQ from a sample of size <em>n</em> = 26. The samples will be 26 random values from the normal distribution centered at 106 with a standard deviation of 15. H0 is <span class="math inline">\(\mu\)</span> = 100.</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="hypothesis-testing.html#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 100,000 random samples of IQ simulations from a normal distribution where</span></span>
<span id="cb7-2"><a href="hypothesis-testing.html#cb7-2" aria-hidden="true" tabindex="-1"></a><span class="co"># sigma = 15. True population value is 100, but we&#39;ll try other values.</span></span>
<span id="cb7-3"><a href="hypothesis-testing.html#cb7-3" aria-hidden="true" tabindex="-1"></a>n_sims <span class="ot">&lt;-</span> <span class="fl">1E5</span></span>
<span id="cb7-4"><a href="hypothesis-testing.html#cb7-4" aria-hidden="true" tabindex="-1"></a>mu <span class="ot">&lt;-</span> <span class="dv">100</span></span>
<span id="cb7-5"><a href="hypothesis-testing.html#cb7-5" aria-hidden="true" tabindex="-1"></a>sigma <span class="ot">&lt;-</span> <span class="dv">15</span></span>
<span id="cb7-6"><a href="hypothesis-testing.html#cb7-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-7"><a href="hypothesis-testing.html#cb7-7" aria-hidden="true" tabindex="-1"></a>run_sim <span class="ot">&lt;-</span> <span class="cf">function</span>(<span class="at">mu_0 =</span> <span class="dv">106</span>, <span class="at">n =</span> <span class="dv">26</span>) {</span>
<span id="cb7-8"><a href="hypothesis-testing.html#cb7-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">data.frame</span>(<span class="at">i =</span> <span class="dv">1</span><span class="sc">:</span>n_sims) <span class="sc">%&gt;%</span></span>
<span id="cb7-9"><a href="hypothesis-testing.html#cb7-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(</span>
<span id="cb7-10"><a href="hypothesis-testing.html#cb7-10" aria-hidden="true" tabindex="-1"></a>      <span class="at">x =</span> <span class="fu">map</span>(i, <span class="sc">~</span> <span class="fu">rnorm</span>(<span class="at">n =</span> n, <span class="at">mean =</span> mu_0, <span class="at">sd =</span> sigma)),</span>
<span id="cb7-11"><a href="hypothesis-testing.html#cb7-11" aria-hidden="true" tabindex="-1"></a>      <span class="at">z =</span> <span class="fu">map</span>(x, <span class="sc">~</span> <span class="fu">t.test</span>(., <span class="at">mu =</span> mu)),</span>
<span id="cb7-12"><a href="hypothesis-testing.html#cb7-12" aria-hidden="true" tabindex="-1"></a>      <span class="at">p =</span> <span class="fu">map_dbl</span>(z, <span class="sc">~</span> .x<span class="sc">$</span>p.value),</span>
<span id="cb7-13"><a href="hypothesis-testing.html#cb7-13" aria-hidden="true" tabindex="-1"></a>      <span class="at">x_bar =</span> <span class="fu">map_dbl</span>(x, mean)</span>
<span id="cb7-14"><a href="hypothesis-testing.html#cb7-14" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">%&gt;%</span></span>
<span id="cb7-15"><a href="hypothesis-testing.html#cb7-15" aria-hidden="true" tabindex="-1"></a>    <span class="fu">select</span>(x_bar, p)</span>
<span id="cb7-16"><a href="hypothesis-testing.html#cb7-16" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>The null hypothesis is that the average IQ is 100. Our rigged simulation finds an average IQ of 106 - an effect size of 6.</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="hypothesis-testing.html#cb8-1" aria-hidden="true" tabindex="-1"></a>sim_106_26 <span class="ot">&lt;-</span> <span class="fu">run_sim</span>(<span class="at">mu_0 =</span> <span class="dv">106</span>, <span class="at">n =</span> <span class="dv">26</span>)</span>
<span id="cb8-2"><a href="hypothesis-testing.html#cb8-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-3"><a href="hypothesis-testing.html#cb8-3" aria-hidden="true" tabindex="-1"></a><span class="fu">glimpse</span>(sim_106_26)</span>
<span id="cb8-4"><a href="hypothesis-testing.html#cb8-4" aria-hidden="true" tabindex="-1"></a><span class="do">## Rows: 100,000</span></span>
<span id="cb8-5"><a href="hypothesis-testing.html#cb8-5" aria-hidden="true" tabindex="-1"></a><span class="do">## Columns: 2</span></span>
<span id="cb8-6"><a href="hypothesis-testing.html#cb8-6" aria-hidden="true" tabindex="-1"></a><span class="do">## $ x_bar &lt;dbl&gt; 104.0366, 107.4146, 106.3826, 101.9452, 104.9108, 106.0985, 109.…</span></span>
<span id="cb8-7"><a href="hypothesis-testing.html#cb8-7" aria-hidden="true" tabindex="-1"></a><span class="do">## $ p     &lt;dbl&gt; 0.1764747839, 0.0345864346, 0.0419669200, 0.4522238256, 0.065089…</span></span>
<span id="cb8-8"><a href="hypothesis-testing.html#cb8-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-9"><a href="hypothesis-testing.html#cb8-9" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(sim_106_26<span class="sc">$</span>x_bar)</span>
<span id="cb8-10"><a href="hypothesis-testing.html#cb8-10" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] 106.0062</span></span></code></pre></div>
<p>The statistical power achieved by the simulations is 50%. That is, the typical simulation detected the effect size of 6 at the .05 significance level about 50% of the time.</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="hypothesis-testing.html#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="fu">pwr.t.test</span>(</span>
<span id="cb9-2"><a href="hypothesis-testing.html#cb9-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">n =</span> <span class="dv">26</span>,</span>
<span id="cb9-3"><a href="hypothesis-testing.html#cb9-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">d =</span> (<span class="dv">106</span> <span class="sc">-</span> <span class="dv">100</span>) <span class="sc">/</span> <span class="dv">15</span>,</span>
<span id="cb9-4"><a href="hypothesis-testing.html#cb9-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">sig.level =</span> .<span class="dv">05</span>,</span>
<span id="cb9-5"><a href="hypothesis-testing.html#cb9-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">type =</span> <span class="st">&quot;one.sample&quot;</span>,</span>
<span id="cb9-6"><a href="hypothesis-testing.html#cb9-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">alternative =</span> <span class="st">&quot;two.sided&quot;</span></span>
<span id="cb9-7"><a href="hypothesis-testing.html#cb9-7" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
<pre><code>## 
##      One-sample t test power calculation 
## 
##               n = 26
##               d = 0.4
##       sig.level = 0.05
##           power = 0.5004646
##     alternative = two.sided</code></pre>
<p>That means that given a population with an average IQ of 106, a two-sided hypothesis test of H0: <span class="math inline">\(\mu\)</span> = 100 from a sample of size 26 will measure an <span class="math inline">\(\bar{x}\)</span> with a <em>p</em>-value under .05 only 50% of the time. You can see that in this histogram of <em>p</em>-values.</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="hypothesis-testing.html#cb11-1" aria-hidden="true" tabindex="-1"></a>sim_106_26 <span class="sc">%&gt;%</span> <span class="fu">plot_sim</span>()</span></code></pre></div>
<p><img src="statistics_files/figure-html/unnamed-chunk-17-1.png" width="672" /></p>
<p>Had there been no effect to observe, you’d expect all <em>p</em>-values to be equally likely, so the 20 bins would all have been 5% of the number of simulations – i.e., <em>uniformly distributed under the null</em>. This is called “0 power”, although 5% of the <em>p</em>-values will still be significant at the .05 level. The 5% of <em>p</em>-values &lt; .05 is the Type II error rate - that probability of a positive test result when there is no actual effect to observe.</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="hypothesis-testing.html#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="fu">run_sim</span>(<span class="at">mu_0 =</span> <span class="dv">100</span>, <span class="at">n =</span> <span class="dv">26</span>) <span class="sc">%&gt;%</span></span>
<span id="cb12-2"><a href="hypothesis-testing.html#cb12-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot_sim</span>(<span class="at">mu_0 =</span> <span class="dv">100</span>)</span></code></pre></div>
<p><img src="statistics_files/figure-html/unnamed-chunk-18-1.png" width="672" /></p>
<p>If you want a higher powered study that would detect the effect at least 80% of the time (the normal standard), you’ll need a higher sample size. How high? Conduct the power analysis again, but specify the power while leaving out the sample size.</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="hypothesis-testing.html#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="fu">pwr.t.test</span>(</span>
<span id="cb13-2"><a href="hypothesis-testing.html#cb13-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">power =</span> <span class="fl">0.80</span>,</span>
<span id="cb13-3"><a href="hypothesis-testing.html#cb13-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">d =</span> (<span class="dv">106</span> <span class="sc">-</span> <span class="dv">100</span>) <span class="sc">/</span> <span class="dv">15</span>,</span>
<span id="cb13-4"><a href="hypothesis-testing.html#cb13-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">sig.level =</span> .<span class="dv">05</span>,</span>
<span id="cb13-5"><a href="hypothesis-testing.html#cb13-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">type =</span> <span class="st">&quot;one.sample&quot;</span>,</span>
<span id="cb13-6"><a href="hypothesis-testing.html#cb13-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">alternative =</span> <span class="st">&quot;two.sided&quot;</span></span>
<span id="cb13-7"><a href="hypothesis-testing.html#cb13-7" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
<pre><code>## 
##      One-sample t test power calculation 
## 
##               n = 51.00945
##               d = 0.4
##       sig.level = 0.05
##           power = 0.8
##     alternative = two.sided</code></pre>
<p>You need 51 people (technically, you might want to round up to 52). Here’s what that looks like. 80% of <em>p</em>-values are below .05 now.</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="hypothesis-testing.html#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="fu">run_sim</span>(<span class="at">mu_0 =</span> <span class="dv">106</span>, <span class="at">n =</span> <span class="dv">51</span>) <span class="sc">%&gt;%</span></span>
<span id="cb15-2"><a href="hypothesis-testing.html#cb15-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot_sim</span>(<span class="at">mu_0 =</span> <span class="dv">106</span>)</span></code></pre></div>
<p><img src="statistics_files/figure-html/unnamed-chunk-20-1.png" width="672" /></p>
<p>So far, we’ve discovered that when there <em>is</em> an effect, the probability that the measure <em>p</em>-value is under the <span class="math inline">\(\alpha\)</span> significance level equals the <em>power of the study</em>, 1 - <span class="math inline">\(\beta\)</span> - the <em>true positive</em> rate, and <span class="math inline">\(\beta\)</span> will be above the <span class="math inline">\(\alpha\)</span> level - the <em>false negative</em> rate. We’ve also discovered that when there is <em>no</em> effect, all <em>p</em>-values are equally likely, so <span class="math inline">\(\alpha\)</span> of them will be below the <span class="math inline">\(alpha\)</span> level of significance - the <em>false positive</em> rate, and 1 - <span class="math inline">\(\alpha\)</span> will be above <span class="math inline">\(\alpha\)</span> - the <em>true negative</em> rate.</p>
<p>It’s not the case that all p-values below 0.05 are support for the alternative hypothesis. If the statistical power is high enough, a <em>p</em>-value just under .05 can be even <em>less</em> likely under the null hypothesis.</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="hypothesis-testing.html#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="fu">run_sim</span>(<span class="at">mu_0 =</span> <span class="dv">108</span>, <span class="at">n =</span> <span class="dv">51</span>)  <span class="sc">%&gt;%</span></span>
<span id="cb16-2"><a href="hypothesis-testing.html#cb16-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">bin =</span> <span class="fu">case_when</span>(p <span class="sc">&lt;</span> .<span class="dv">01</span> <span class="sc">~</span> <span class="st">&quot;0.00 - 0.01&quot;</span>,</span>
<span id="cb16-3"><a href="hypothesis-testing.html#cb16-3" aria-hidden="true" tabindex="-1"></a>                         p <span class="sc">&lt;</span> .<span class="dv">02</span> <span class="sc">~</span> <span class="st">&quot;0.01 - 0.02&quot;</span>,</span>
<span id="cb16-4"><a href="hypothesis-testing.html#cb16-4" aria-hidden="true" tabindex="-1"></a>                         p <span class="sc">&lt;</span> .<span class="dv">03</span> <span class="sc">~</span> <span class="st">&quot;0.02 - 0.03&quot;</span>,</span>
<span id="cb16-5"><a href="hypothesis-testing.html#cb16-5" aria-hidden="true" tabindex="-1"></a>                         p <span class="sc">&lt;</span> .<span class="dv">04</span> <span class="sc">~</span> <span class="st">&quot;0.03 - 0.04&quot;</span>,</span>
<span id="cb16-6"><a href="hypothesis-testing.html#cb16-6" aria-hidden="true" tabindex="-1"></a>                         p <span class="sc">&lt;</span> .<span class="dv">05</span> <span class="sc">~</span> <span class="st">&quot;0.04 - 0.05&quot;</span>,</span>
<span id="cb16-7"><a href="hypothesis-testing.html#cb16-7" aria-hidden="true" tabindex="-1"></a>                         <span class="cn">TRUE</span> <span class="sc">~</span> <span class="st">&quot;other&quot;</span>)</span>
<span id="cb16-8"><a href="hypothesis-testing.html#cb16-8" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb16-9"><a href="hypothesis-testing.html#cb16-9" aria-hidden="true" tabindex="-1"></a>  janitor<span class="sc">::</span><span class="fu">tabyl</span>(bin)</span></code></pre></div>
<pre><code>##          bin     n percent
##  0.00 - 0.01 86618 0.86618
##  0.01 - 0.02  5011 0.05011
##  0.02 - 0.03  2353 0.02353
##  0.03 - 0.04  1353 0.01353
##  0.04 - 0.05   887 0.00887
##        other  3778 0.03778</code></pre>
<p>(Recall that under H0, all <em>p</em>-values are equally likely, so each of the percentile bins would contain 1% of <em>p</em>-values.)</p>
<p>In fact, at best, a <em>p</em>-value between .04 and .05 can only be about four times as likely under the alternative hypothesis as the null hypothesis. If your <em>p</em>-value is just under .05, it is at best weak support for the alternative hypothesis.</p>
</div>
<div id="further-reading" class="section level3 hasAnchor" number="1.2.1">
<h3><span class="header-section-number">1.2.1</span> Further Reading<a href="hypothesis-testing.html#further-reading" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Pritha Bhandari has two nice posts on <a href="https://www.scribbr.com/statistics/type-i-and-type-ii-errors/">Type I and Type II errors</a> and <a href="https://www.scribbr.com/statistics/statistical-power/">Statistical Power</a>. Daniel Lakens’s Coursera class <a href="https://www.coursera.org/learn/statistical-inferences/home/welcome">Improving your statistical inferences</a> has a great <em>p</em>-value simulation exercise in Week 1 (assignment)</p>

</div>
</div>
<!-- </div> -->
<div class="footnotes">
<hr />
<ol start="1">
<li id="fn1"><p>This section is based on ideas I learned from homework assignment 1 in Daniel Lakens’s Coursera class <a href="https://www.coursera.org/learn/statistical-inferences/home/welcome">Improving your statistical inferences</a>.<a href="hypothesis-testing.html#fnref1" class="footnote-back">↩︎</a></p></li>
</ol>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="central-tendancy-and-dispersion.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="likelihood-statistics.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="assets/gitbook-2.6.7/js/app.min.js"></script>
<script src="assets/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="assets/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="assets/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="assets/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="assets/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="assets/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="assets/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection",
"scroll_highlight": true
},
"toolbar": {
"position": "static"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
