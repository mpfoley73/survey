<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>7.3 Multivariate Normal Distribution | Statistical Inference</title>
  <meta name="description" content="Notes cobbled together from books, online classes, etc. to be used as quick reference for common work projects." />
  <meta name="generator" content="bookdown 0.33 and GitBook 2.6.7" />

  <meta property="og:title" content="7.3 Multivariate Normal Distribution | Statistical Inference" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="Notes cobbled together from books, online classes, etc. to be used as quick reference for common work projects." />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="7.3 Multivariate Normal Distribution | Statistical Inference" />
  
  <meta name="twitter:description" content="Notes cobbled together from books, online classes, etc. to be used as quick reference for common work projects." />
  

<meta name="author" content="Michael Foley" />


<meta name="date" content="2023-04-09" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="linear-transformations.html"/>
<link rel="next" href="references.html"/>
<script src="assets/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="assets/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="assets/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="assets/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="assets/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="assets/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="assets/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="assets/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="assets/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="assets/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="assets/anchor-sections-1.1.0/anchor-sections.js"></script>
<script src="assets/kePrint-0.0.1/kePrint.js"></script>
<link href="assets/lightable-0.0.1/lightable.css" rel="stylesheet" />
<link href="assets/tabwid-1.1.3/tabwid.css" rel="stylesheet" />
<script src="assets/tabwid-1.1.3/tabwid.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Preface</a></li>
<li class="chapter" data-level="1" data-path="frequentist-statistics.html"><a href="frequentist-statistics.html"><i class="fa fa-check"></i><b>1</b> Frequentist Statistics</a>
<ul>
<li class="chapter" data-level="1.1" data-path="central-tendancy-and-dispersion.html"><a href="central-tendancy-and-dispersion.html"><i class="fa fa-check"></i><b>1.1</b> Central Tendancy and Dispersion</a></li>
<li class="chapter" data-level="1.2" data-path="hypothesis-testing.html"><a href="hypothesis-testing.html"><i class="fa fa-check"></i><b>1.2</b> Hypothesis Testing</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="likelihood-statistics.html"><a href="likelihood-statistics.html"><i class="fa fa-check"></i><b>2</b> Likelihood Statistics</a>
<ul>
<li class="chapter" data-level="2.1" data-path="maximum-likelihood-estimation.html"><a href="maximum-likelihood-estimation.html"><i class="fa fa-check"></i><b>2.1</b> Maximum Likelihood Estimation</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="bayesian-statistics.html"><a href="bayesian-statistics.html"><i class="fa fa-check"></i><b>3</b> Bayesian Statistics</a>
<ul>
<li class="chapter" data-level="3.1" data-path="bayes-law.html"><a href="bayes-law.html"><i class="fa fa-check"></i><b>3.1</b> Bayes’ Law</a></li>
<li class="chapter" data-level="3.2" data-path="bayesian-inference.html"><a href="bayesian-inference.html"><i class="fa fa-check"></i><b>3.2</b> Bayesian Inference</a></li>
<li class="chapter" data-level="3.3" data-path="discrete-cases.html"><a href="discrete-cases.html"><i class="fa fa-check"></i><b>3.3</b> Discrete Cases</a></li>
<li class="chapter" data-level="3.4" data-path="continuous-cases.html"><a href="continuous-cases.html"><i class="fa fa-check"></i><b>3.4</b> Continuous Cases</a></li>
<li class="chapter" data-level="3.5" data-path="bayes-factors.html"><a href="bayes-factors.html"><i class="fa fa-check"></i><b>3.5</b> Bayes Factors</a></li>
<li class="chapter" data-level="3.6" data-path="a-gentler-introduction.html"><a href="a-gentler-introduction.html"><i class="fa fa-check"></i><b>3.6</b> A Gentler Introduction</a></li>
<li class="chapter" data-level="3.7" data-path="coursera-notes-inference.html"><a href="coursera-notes-inference.html"><i class="fa fa-check"></i><b>3.7</b> Coursera Notes Inference</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="one-sample.html"><a href="one-sample.html"><i class="fa fa-check"></i><b>4</b> One-Sample</a>
<ul>
<li class="chapter" data-level="4.1" data-path="one-sample-mean-z-test.html"><a href="one-sample-mean-z-test.html"><i class="fa fa-check"></i><b>4.1</b> One-Sample Mean z Test</a></li>
<li class="chapter" data-level="4.2" data-path="one-sample-mean-t-test.html"><a href="one-sample-mean-t-test.html"><i class="fa fa-check"></i><b>4.2</b> One-Sample Mean t Test</a></li>
<li class="chapter" data-level="4.3" data-path="one-sample-median-wilcoxon-test.html"><a href="one-sample-median-wilcoxon-test.html"><i class="fa fa-check"></i><b>4.3</b> One-Sample Median Wilcoxon Test</a></li>
<li class="chapter" data-level="4.4" data-path="chi-squared-goodness-of-fit-test.html"><a href="chi-squared-goodness-of-fit-test.html"><i class="fa fa-check"></i><b>4.4</b> Chi-Squared Goodness-of-Fit Test</a></li>
<li class="chapter" data-level="4.5" data-path="g-test.html"><a href="g-test.html"><i class="fa fa-check"></i><b>4.5</b> G-Test</a></li>
<li class="chapter" data-level="4.6" data-path="one-sample-poisson-test.html"><a href="one-sample-poisson-test.html"><i class="fa fa-check"></i><b>4.6</b> One-Sample Poisson Test</a></li>
<li class="chapter" data-level="4.7" data-path="exact-binomial-test.html"><a href="exact-binomial-test.html"><i class="fa fa-check"></i><b>4.7</b> Exact Binomial Test</a></li>
<li class="chapter" data-level="4.8" data-path="one-sample-proportion-z-test.html"><a href="one-sample-proportion-z-test.html"><i class="fa fa-check"></i><b>4.8</b> One-Sample Proportion z Test</a></li>
<li class="chapter" data-level="4.9" data-path="sample-t-test-for-categorical-var.html"><a href="sample-t-test-for-categorical-var.html"><i class="fa fa-check"></i><b>4.9</b> 1 sample t Test for Categorical Var</a></li>
<li class="chapter" data-level="4.10" data-path="wilcoxon-1-sample-median-test-for-categorical-var.html"><a href="wilcoxon-1-sample-median-test-for-categorical-var.html"><i class="fa fa-check"></i><b>4.10</b> Wilcoxon 1-Sample Median Test for Categorical Var</a></li>
<li class="chapter" data-level="4.11" data-path="multivariate-statistics.html"><a href="multivariate-statistics.html"><i class="fa fa-check"></i><b>4.11</b> Multivariate Statistics</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="group-differences.html"><a href="group-differences.html"><i class="fa fa-check"></i><b>5</b> Group Differences</a>
<ul>
<li class="chapter" data-level="5.1" data-path="ttest.html"><a href="ttest.html"><i class="fa fa-check"></i><b>5.1</b> Independent Samples t-Test</a></li>
<li class="chapter" data-level="5.2" data-path="wilcoxonranksum.html"><a href="wilcoxonranksum.html"><i class="fa fa-check"></i><b>5.2</b> Wilcoxon Rank Sum Test</a></li>
<li class="chapter" data-level="" data-path="case-study-1.html"><a href="case-study-1.html"><i class="fa fa-check"></i>Case Study 1</a></li>
<li class="chapter" data-level="5.3" data-path="pairedttest.html"><a href="pairedttest.html"><i class="fa fa-check"></i><b>5.3</b> Paired Samples t-Test</a></li>
<li class="chapter" data-level="5.4" data-path="wilcoxonsignedrank.html"><a href="wilcoxonsignedrank.html"><i class="fa fa-check"></i><b>5.4</b> Wilcoxon Signed-Rank Test</a></li>
<li class="chapter" data-level="" data-path="case-study-2.html"><a href="case-study-2.html"><i class="fa fa-check"></i>Case Study 2</a></li>
<li class="chapter" data-level="5.5" data-path="onewayanova.html"><a href="onewayanova.html"><i class="fa fa-check"></i><b>5.5</b> One-way ANOVA</a></li>
<li class="chapter" data-level="5.6" data-path="kw.html"><a href="kw.html"><i class="fa fa-check"></i><b>5.6</b> Kruskal–Wallis Test</a></li>
<li class="chapter" data-level="" data-path="groupdiffscs3.html"><a href="groupdiffscs3.html"><i class="fa fa-check"></i>Case Study 3</a></li>
<li class="chapter" data-level="5.7" data-path="chisqhomogeneity.html"><a href="chisqhomogeneity.html"><i class="fa fa-check"></i><b>5.7</b> Chi-Square Test of Homogeneity</a></li>
<li class="chapter" data-level="5.8" data-path="fisherexact.html"><a href="fisherexact.html"><i class="fa fa-check"></i><b>5.8</b> Fisher’s Exact Test</a></li>
<li class="chapter" data-level="" data-path="case-study-4.html"><a href="case-study-4.html"><i class="fa fa-check"></i>Case Study 4</a></li>
<li class="chapter" data-level="5.9" data-path="pairwiseproptest.html"><a href="pairwiseproptest.html"><i class="fa fa-check"></i><b>5.9</b> Pairwise Prop Test</a></li>
<li class="chapter" data-level="5.10" data-path="mcnemar.html"><a href="mcnemar.html"><i class="fa fa-check"></i><b>5.10</b> McNemar’s Test</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="association.html"><a href="association.html"><i class="fa fa-check"></i><b>6</b> Association</a>
<ul>
<li class="chapter" data-level="6.1" data-path="pearson.html"><a href="pearson.html"><i class="fa fa-check"></i><b>6.1</b> Pearson’s Correlation</a></li>
<li class="chapter" data-level="6.2" data-path="spearman.html"><a href="spearman.html"><i class="fa fa-check"></i><b>6.2</b> Spearman’s Rho</a></li>
<li class="chapter" data-level="6.3" data-path="kendall.html"><a href="kendall.html"><i class="fa fa-check"></i><b>6.3</b> Kendal’s Tau</a></li>
<li class="chapter" data-level="6.4" data-path="case-study-pearson-spearman-kendall.html"><a href="case-study-pearson-spearman-kendall.html"><i class="fa fa-check"></i><b>6.4</b> Case Study: Pearson, Spearman, Kendall</a></li>
<li class="chapter" data-level="6.5" data-path="chisq-independence.html"><a href="chisq-independence.html"><i class="fa fa-check"></i><b>6.5</b> Chi-Square Test of Independence</a></li>
<li class="chapter" data-level="6.6" data-path="fisher-exact.html"><a href="fisher-exact.html"><i class="fa fa-check"></i><b>6.6</b> Fisher’s Exact Test</a></li>
<li class="chapter" data-level="6.7" data-path="case-study-chi-square-fisher.html"><a href="case-study-chi-square-fisher.html"><i class="fa fa-check"></i><b>6.7</b> Case Study: Chi-Square, Fisher</a></li>
<li class="chapter" data-level="6.8" data-path="kruskals-lambda.html"><a href="kruskals-lambda.html"><i class="fa fa-check"></i><b>6.8</b> Kruskal’s Lambda</a></li>
<li class="chapter" data-level="6.9" data-path="relative-risk.html"><a href="relative-risk.html"><i class="fa fa-check"></i><b>6.9</b> Relative Risk</a></li>
<li class="chapter" data-level="6.10" data-path="odds-ratio.html"><a href="odds-ratio.html"><i class="fa fa-check"></i><b>6.10</b> Odds Ratio</a></li>
<li class="chapter" data-level="6.11" data-path="partial-correlation.html"><a href="partial-correlation.html"><i class="fa fa-check"></i><b>6.11</b> Partial Correlation</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="matrix-algebra.html"><a href="matrix-algebra.html"><i class="fa fa-check"></i><b>7</b> Matrix Algebra</a>
<ul>
<li class="chapter" data-level="7.1" data-path="central-tendancy-dispersion-and-association.html"><a href="central-tendancy-dispersion-and-association.html"><i class="fa fa-check"></i><b>7.1</b> Central Tendancy, Dispersion, and Association</a></li>
<li class="chapter" data-level="7.2" data-path="linear-transformations.html"><a href="linear-transformations.html"><i class="fa fa-check"></i><b>7.2</b> Linear Transformations</a></li>
<li class="chapter" data-level="7.3" data-path="multivariate-normal-distribution.html"><a href="multivariate-normal-distribution.html"><i class="fa fa-check"></i><b>7.3</b> Multivariate Normal Distribution</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Statistical Inference</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="multivariate-normal-distribution" class="section level2 hasAnchor" number="7.3">
<h2><span class="header-section-number">7.3</span> Multivariate Normal Distribution<a href="multivariate-normal-distribution.html#multivariate-normal-distribution" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>The univariate normal distribution, <span class="math inline">\(X \sim N(\mu, \sigma^2)\)</span>, is a function of the variable’s mean and variance, <span class="math inline">\(\phi(x) = \frac{1}{\sqrt{2 \pi \sigma^2}}\exp\{-\frac{1}{2\sigma^2} (x - \mu)^2\}\)</span>. The multivariate normal distribution is similar except that the mean is the mean vector and the variance is the variance-covariance matrix, <span class="math inline">\(\textbf{X} \sim N(\mu, \Sigma)\)</span>. Notice the determinant <span class="math inline">\(|\Sigma|\)</span> and <a href="https://www.mathsisfun.com/algebra/matrix-inverse-row-operations-gauss-jordan.html">matrix inverse</a> in the equation.</p>
<p><span class="math display" id="eq:multivariate-normal">\[
\begin{equation}
\phi(\textbf{X}) = \left(\frac{1}{2 \pi}\right)^{p/2}|\Sigma|^{-1/2}\exp\{-\frac{1}{2} (\textbf{x} - \mathbf{\mu})&#39;\Sigma^{-1}(\textbf{x} - \mathbf{\mu})\}
\end{equation}
\tag{7.1}
\]</span></p>
<p>If <span class="math inline">\(p\)</span> is 2, then you have a bi-variate normal distribution. The exponentiated term <span class="math inline">\((\textbf{x} - \mathbf{\mu})&#39;\Sigma^{-1}(\textbf{x} - \mathbf{\mu})\)</span> is called the squared <em>Mahalanobis distance</em> between <span class="math inline">\(x\)</span> and <span class="math inline">\(\mu\)</span>.</p>
<p>A linear transformation is distributed <span class="math inline">\(\textbf{Y} \sim N(\textbf{c}&#39;\mu, \textbf{c}&#39;\Sigma \textbf{c})\)</span>. It’s useful to note that each variable in the multivariate normal distribution is normal, as are subsets of variables, linear combinations, and conditional distributions.</p>
<p>For an intuitive understanding of the material, consider the bivariate case.</p>
<p><span class="math display">\[
\begin{pmatrix}X_1 \\ X_2 \end{pmatrix} \sim N \left[ \begin{pmatrix} \mu_1 \\ \mu_2 \end{pmatrix} \begin{pmatrix} \sigma_1^2 &amp; \rho \sigma_1 \sigma_2 \\ \rho \sigma_1 \sigma_2 &amp; \sigma_2^2 \end{pmatrix}\right]
\]</span></p>
<p>If <span class="math inline">\(\rho\)</span> is 0, then the bivariate normal density function is symmetric in all dimension. As <span class="math inline">\(\rho \rightarrow 1\)</span>, the curve gets increasing skinny along the diagonal.</p>
<div class="sourceCode" id="cb277"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb277-1"><a href="multivariate-normal-distribution.html#cb277-1" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="sc">-</span><span class="dv">4</span>, <span class="dv">4</span>, .<span class="dv">1</span>)</span>
<span id="cb277-2"><a href="multivariate-normal-distribution.html#cb277-2" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="sc">-</span><span class="dv">4</span>, <span class="dv">4</span>, .<span class="dv">1</span>)</span>
<span id="cb277-3"><a href="multivariate-normal-distribution.html#cb277-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb277-4"><a href="multivariate-normal-distribution.html#cb277-4" aria-hidden="true" tabindex="-1"></a>z_values <span class="ot">&lt;-</span> <span class="cf">function</span>(x, y, <span class="at">r =</span> .<span class="dv">8</span>) {</span>
<span id="cb277-5"><a href="multivariate-normal-distribution.html#cb277-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">exp</span>(<span class="sc">-</span>(x<span class="sc">^</span><span class="dv">2-2</span><span class="sc">*</span>r<span class="sc">*</span>x<span class="sc">*</span>y<span class="sc">+</span>y<span class="sc">^</span><span class="dv">2</span>)<span class="sc">/</span><span class="dv">2</span><span class="sc">/</span>(<span class="dv">1</span><span class="sc">-</span>r<span class="sc">^</span><span class="dv">2</span>))<span class="sc">/</span><span class="dv">2</span><span class="sc">/</span>pi<span class="sc">/</span><span class="fu">sqrt</span>(<span class="dv">1</span><span class="sc">-</span>r<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb277-6"><a href="multivariate-normal-distribution.html#cb277-6" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<!-- The colons (::::, :::) create a style html within document -->
<div style="display: grid; grid-template-columns: 1fr 1fr; grid-column-gap: 10px;">
<div>
<div class="sourceCode" id="cb278"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb278-1"><a href="multivariate-normal-distribution.html#cb278-1" aria-hidden="true" tabindex="-1"></a><span class="co"># correlation is .3</span></span>
<span id="cb278-2"><a href="multivariate-normal-distribution.html#cb278-2" aria-hidden="true" tabindex="-1"></a>z <span class="ot">&lt;-</span> <span class="fu">outer</span>(x, y, z_values, .<span class="dv">3</span>)</span>
<span id="cb278-3"><a href="multivariate-normal-distribution.html#cb278-3" aria-hidden="true" tabindex="-1"></a><span class="fu">persp</span>(x, y, z)</span></code></pre></div>
<p><img src="statistics_files/figure-html/unnamed-chunk-221-1.png" width="672" /></p>
</div>
<div>
<div class="sourceCode" id="cb279"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb279-1"><a href="multivariate-normal-distribution.html#cb279-1" aria-hidden="true" tabindex="-1"></a><span class="co"># correlation is .9</span></span>
<span id="cb279-2"><a href="multivariate-normal-distribution.html#cb279-2" aria-hidden="true" tabindex="-1"></a>z <span class="ot">&lt;-</span> <span class="fu">outer</span>(x, y, z_values, .<span class="dv">9</span>)</span>
<span id="cb279-3"><a href="multivariate-normal-distribution.html#cb279-3" aria-hidden="true" tabindex="-1"></a><span class="fu">persp</span>(x, y, z)</span></code></pre></div>
<p><img src="statistics_files/figure-html/unnamed-chunk-222-1.png" width="672" /></p>
</div>
</div>
<p>The squared Mahalanobis distance, <span class="math inline">\(d^2 = (\textbf{x} - \mathbf{\mu})&#39;\Sigma^{-1}(\textbf{x} - \mathbf{\mu})\)</span>, is the equation for a hyper-ellipse centered at <span class="math inline">\(\mu\)</span>. In two dimensions, it looks like this:</p>
<div class="sourceCode" id="cb280"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb280-1"><a href="multivariate-normal-distribution.html#cb280-1" aria-hidden="true" tabindex="-1"></a>bvn_mtrx <span class="ot">&lt;-</span> MASS<span class="sc">::</span><span class="fu">mvrnorm</span>(</span>
<span id="cb280-2"><a href="multivariate-normal-distribution.html#cb280-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">n =</span> <span class="dv">100</span>,</span>
<span id="cb280-3"><a href="multivariate-normal-distribution.html#cb280-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">mu =</span> <span class="fu">c</span>(<span class="dv">10</span>, <span class="dv">5</span>),</span>
<span id="cb280-4"><a href="multivariate-normal-distribution.html#cb280-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">Sigma =</span> <span class="fu">matrix</span>(<span class="fu">c</span>(<span class="dv">10</span>, <span class="dv">5</span>, <span class="dv">2</span>, <span class="dv">9</span>), <span class="at">ncol =</span> <span class="dv">2</span>)</span>
<span id="cb280-5"><a href="multivariate-normal-distribution.html#cb280-5" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb280-6"><a href="multivariate-normal-distribution.html#cb280-6" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(bvn_mtrx) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;x1&quot;</span>, <span class="st">&quot;x2&quot;</span>)</span>
<span id="cb280-7"><a href="multivariate-normal-distribution.html#cb280-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb280-8"><a href="multivariate-normal-distribution.html#cb280-8" aria-hidden="true" tabindex="-1"></a>d2 <span class="ot">&lt;-</span> <span class="fu">mahalanobis</span>(bvn_mtrx, <span class="fu">colMeans</span>(bvn_mtrx), <span class="fu">cov</span>(bvn_mtrx))</span>
<span id="cb280-9"><a href="multivariate-normal-distribution.html#cb280-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb280-10"><a href="multivariate-normal-distribution.html#cb280-10" aria-hidden="true" tabindex="-1"></a>bvn <span class="ot">&lt;-</span> <span class="fu">as_tibble</span>(bvn_mtrx) <span class="sc">%&gt;%</span> <span class="fu">bind_cols</span>(<span class="at">d2 =</span> d2)</span>
<span id="cb280-11"><a href="multivariate-normal-distribution.html#cb280-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb280-12"><a href="multivariate-normal-distribution.html#cb280-12" aria-hidden="true" tabindex="-1"></a>bvn <span class="sc">%&gt;%</span> <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> x1, <span class="at">y =</span> x2, <span class="at">color =</span> d2)) <span class="sc">+</span> </span>
<span id="cb280-13"><a href="multivariate-normal-distribution.html#cb280-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb280-14"><a href="multivariate-normal-distribution.html#cb280-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_continuous</span>(<span class="at">type =</span> <span class="st">&quot;viridis&quot;</span>)</span></code></pre></div>
<p><img src="statistics_files/figure-html/unnamed-chunk-223-1.png" width="672" /></p>
<p><span class="math inline">\(d^2\)</span> has a chi-square distribution with <span class="math inline">\(p\)</span> degrees of freedom. The distribution can be used to evaluate whether a point is an outlier or whether the data is multivariate normal. A Q-Q plot shows the ordered Mahalanobis distances versus the quantiles for a sample of size <span class="math inline">\(n\)</span> from a chi-squared distribution with <span class="math inline">\(p\)</span> degrees of freedom.</p>
<div class="sourceCode" id="cb281"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb281-1"><a href="multivariate-normal-distribution.html#cb281-1" aria-hidden="true" tabindex="-1"></a><span class="fu">qqplot</span>(<span class="fu">dchisq</span>(bvn<span class="sc">$</span>d2, <span class="dv">2</span>), bvn<span class="sc">$</span>d2)</span></code></pre></div>
<p><img src="statistics_files/figure-html/unnamed-chunk-224-1.png" width="672" /></p>
<p>Describe the shape of the ellipse mathematically with eigenvalues and eigenvectors of the variance-covariance matrix.<a href="#fn20" class="footnote-ref" id="fnref20"><sup>20</sup></a> A <span class="math inline">\(p \times p\)</span> matrix <span class="math inline">\(\textbf{A}\)</span> has <span class="math inline">\(p\)</span> <em>eigenvalues</em>, <span class="math inline">\([\lambda_1, .., \lambda_p]\)</span>, that solve the expression</p>
<p><span class="math display" id="eq:eigenvalue">\[
\begin{equation}
|\textbf{A} - \lambda \textbf{I}| = 0.
\tag{7.2}
\end{equation}
\]</span></p>
<p>Calculate <span class="math inline">\(\lambda\)</span> by taking the determinant and solving the resulting <span class="math inline">\(p\)</span>-ordered polynomial. The result is <span class="math inline">\(p\)</span> solutions, not necessarily all unique. Plug the eigenvectors into the following equation and solve for the <span class="math inline">\(p\)</span> <em>eigenvectors</em>, <span class="math inline">\(\textbf{e}\)</span>. The eigenvector solutions are generally not unique, so to obtain a unique solution, require that <span class="math inline">\(\textbf{e}_j&#39;\textbf{e}_j = 1\)</span>.</p>
<p><span class="math display" id="eq:eigenvector">\[
\begin{equation}
(\textbf{A} - \lambda_j \textbf{I}) \textbf{e}_j = \textbf{0}
\tag{7.3}
\end{equation}
\]</span></p>
<p>The eigenvalues and eigenvectors define the shape and orientation of the <span class="math inline">\((1 - \alpha)\%\)</span> <em>prediction ellipse</em>. The ellipse is centered on the means with axes pointing in the directions of the eigenvectors. The distance from the origin to the ellipse boundary is</p>
<p><span class="math display" id="eq:prediction-ellipse-dist">\[
\begin{equation}
l_j = \sqrt{\lambda_j \chi_{p, \alpha}^2}
\tag{7.4}
\end{equation}
\]</span></p>
<div class="sourceCode" id="cb282"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb282-1"><a href="multivariate-normal-distribution.html#cb282-1" aria-hidden="true" tabindex="-1"></a>dat <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">X =</span> <span class="fu">runif</span>(<span class="dv">40</span>, <span class="dv">5</span>, <span class="dv">20</span>))</span>
<span id="cb282-2"><a href="multivariate-normal-distribution.html#cb282-2" aria-hidden="true" tabindex="-1"></a>dat<span class="sc">$</span>Y <span class="ot">&lt;-</span> dat<span class="sc">$</span>X <span class="sc">+</span> <span class="fu">rnorm</span>(<span class="dv">40</span>, <span class="dv">0</span>, <span class="dv">3</span>)</span>
<span id="cb282-3"><a href="multivariate-normal-distribution.html#cb282-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb282-4"><a href="multivariate-normal-distribution.html#cb282-4" aria-hidden="true" tabindex="-1"></a>mu_X <span class="ot">&lt;-</span> <span class="fu">mean</span>(dat<span class="sc">$</span>X)</span>
<span id="cb282-5"><a href="multivariate-normal-distribution.html#cb282-5" aria-hidden="true" tabindex="-1"></a>mu_Y <span class="ot">&lt;-</span> <span class="fu">mean</span>(dat<span class="sc">$</span>Y)</span>
<span id="cb282-6"><a href="multivariate-normal-distribution.html#cb282-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb282-7"><a href="multivariate-normal-distribution.html#cb282-7" aria-hidden="true" tabindex="-1"></a>dat <span class="sc">%&gt;%</span></span>
<span id="cb282-8"><a href="multivariate-normal-distribution.html#cb282-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> X, <span class="at">y =</span> Y)) <span class="sc">+</span> </span>
<span id="cb282-9"><a href="multivariate-normal-distribution.html#cb282-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span> </span>
<span id="cb282-10"><a href="multivariate-normal-distribution.html#cb282-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_ellipse</span>(<span class="at">type =</span> <span class="st">&quot;norm&quot;</span>) <span class="sc">+</span></span>
<span id="cb282-11"><a href="multivariate-normal-distribution.html#cb282-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_segment</span>(<span class="fu">aes</span>(<span class="at">x =</span> mu_X, <span class="at">y =</span> <span class="dv">0</span>, <span class="at">xend =</span> mu_X, <span class="at">yend =</span> mu_Y), <span class="at">linetype =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb282-12"><a href="multivariate-normal-distribution.html#cb282-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_segment</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="dv">0</span>, <span class="at">y =</span> mu_Y, <span class="at">xend =</span> mu_X, <span class="at">yend =</span> mu_Y), <span class="at">linetype =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb282-13"><a href="multivariate-normal-distribution.html#cb282-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">&quot;text&quot;</span>, <span class="at">x =</span> <span class="dv">0</span>, <span class="at">y =</span> mu_Y<span class="sc">*</span><span class="fl">1.1</span>, <span class="at">label =</span> <span class="fu">expression</span>(<span class="fu">paste</span>(mu[Y])), <span class="at">parse =</span> <span class="cn">TRUE</span>, <span class="at">hjust =</span> <span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb282-14"><a href="multivariate-normal-distribution.html#cb282-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">&quot;text&quot;</span>, <span class="at">x =</span> mu_X<span class="sc">*</span><span class="fl">1.05</span>, <span class="at">y =</span> <span class="dv">0</span>, <span class="at">label =</span> <span class="fu">expression</span>(<span class="fu">paste</span>(mu[X])), <span class="at">parse =</span> <span class="cn">TRUE</span>, <span class="at">hjust =</span> <span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb282-15"><a href="multivariate-normal-distribution.html#cb282-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_segment</span>(<span class="at">x =</span> mu_X, <span class="at">y =</span> mu_Y, <span class="at">xend =</span> <span class="fl">8.5</span>, <span class="at">yend =</span> <span class="dv">16</span>, </span>
<span id="cb282-16"><a href="multivariate-normal-distribution.html#cb282-16" aria-hidden="true" tabindex="-1"></a>               <span class="at">arrow =</span> <span class="fu">arrow</span>(<span class="at">length =</span> <span class="fu">unit</span>(<span class="fl">0.03</span>, <span class="st">&quot;npc&quot;</span>)), <span class="at">color =</span> <span class="st">&quot;goldenrod&quot;</span>) <span class="sc">+</span></span>
<span id="cb282-17"><a href="multivariate-normal-distribution.html#cb282-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_segment</span>(<span class="at">x =</span> mu_X, <span class="at">y =</span> mu_Y, <span class="at">xend =</span> <span class="fl">22.5</span>, <span class="at">yend =</span> <span class="fl">24.5</span>, </span>
<span id="cb282-18"><a href="multivariate-normal-distribution.html#cb282-18" aria-hidden="true" tabindex="-1"></a>               <span class="at">arrow =</span> <span class="fu">arrow</span>(<span class="at">length =</span> <span class="fu">unit</span>(<span class="fl">0.03</span>, <span class="st">&quot;npc&quot;</span>)), <span class="at">color =</span> <span class="st">&quot;goldenrod&quot;</span>) <span class="sc">+</span></span>
<span id="cb282-19"><a href="multivariate-normal-distribution.html#cb282-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">&quot;text&quot;</span>, <span class="at">x =</span> <span class="dv">8</span>, <span class="at">y =</span> <span class="fl">14.5</span>, <span class="at">label =</span> <span class="fu">expression</span>(<span class="fu">paste</span>(lambda[Y])), </span>
<span id="cb282-20"><a href="multivariate-normal-distribution.html#cb282-20" aria-hidden="true" tabindex="-1"></a>           <span class="at">parse =</span> <span class="cn">TRUE</span>, <span class="at">hjust =</span> <span class="dv">0</span>, <span class="at">color =</span> <span class="st">&quot;darkgoldenrod&quot;</span>) <span class="sc">+</span></span>
<span id="cb282-21"><a href="multivariate-normal-distribution.html#cb282-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">&quot;text&quot;</span>, <span class="at">x =</span> <span class="dv">20</span>, <span class="at">y =</span> <span class="fl">23.5</span>, <span class="at">label =</span> <span class="fu">expression</span>(<span class="fu">paste</span>(lambda[X])), </span>
<span id="cb282-22"><a href="multivariate-normal-distribution.html#cb282-22" aria-hidden="true" tabindex="-1"></a>           <span class="at">parse =</span> <span class="cn">TRUE</span>, <span class="at">hjust =</span> <span class="dv">0</span>, <span class="at">color =</span> <span class="st">&quot;darkgoldenrod&quot;</span>) <span class="sc">+</span></span>
<span id="cb282-23"><a href="multivariate-normal-distribution.html#cb282-23" aria-hidden="true" tabindex="-1"></a>  tune<span class="sc">::</span><span class="fu">coord_obs_pred</span>()</span></code></pre></div>
<p><img src="statistics_files/figure-html/unnamed-chunk-225-1.png" width="672" /></p>
<p>The elliptical shape is due to the correlation in the data. In the two-dimensional diagram above, the ellipse would be a perfect circle if the covariances were zero. The eigenvalues would equal the variances, <span class="math inline">\(\lambda = \sigma^2\)</span>, and the eigenvectors would be parallel to the coordinate axis, <span class="math inline">\(\textbf{e} = \begin{pmatrix}1 &amp; 0 \\ 0 &amp; 1 \end{pmatrix}\)</span>. The ellipse flattens with increasing correlation.</p>
<div id="example-8" class="section level4 unnumbered hasAnchor">
<h4>Example<a href="multivariate-normal-distribution.html#example-8" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>File wechsler.txt is a 37x4 data set from <a href="https://online.stat.psu.edu/stat505/lesson/4/4.7">PSU STAT 505</a> with variance-covariance matrix</p>
<div class="sourceCode" id="cb283"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb283-1"><a href="multivariate-normal-distribution.html#cb283-1" aria-hidden="true" tabindex="-1"></a>wechsler <span class="ot">&lt;-</span> readr<span class="sc">::</span><span class="fu">read_fwf</span>(</span>
<span id="cb283-2"><a href="multivariate-normal-distribution.html#cb283-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">file =</span> <span class="st">&quot;./input/wechsler.txt&quot;</span>, </span>
<span id="cb283-3"><a href="multivariate-normal-distribution.html#cb283-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">col_positions =</span> readr<span class="sc">::</span><span class="fu">fwf_widths</span>(</span>
<span id="cb283-4"><a href="multivariate-normal-distribution.html#cb283-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">3</span>, <span class="dv">3</span>, <span class="dv">3</span>),</span>
<span id="cb283-5"><a href="multivariate-normal-distribution.html#cb283-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">col_names =</span> <span class="fu">c</span>(<span class="st">&quot;ID&quot;</span>, <span class="st">&quot;Information&quot;</span>, <span class="st">&quot;Similarities&quot;</span>, <span class="st">&quot;Arithmetic&quot;</span>, <span class="st">&quot;PictureCompletion&quot;</span>)</span>
<span id="cb283-6"><a href="multivariate-normal-distribution.html#cb283-6" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb283-7"><a href="multivariate-normal-distribution.html#cb283-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">show_col_types =</span> <span class="cn">FALSE</span></span>
<span id="cb283-8"><a href="multivariate-normal-distribution.html#cb283-8" aria-hidden="true" tabindex="-1"></a>) </span>
<span id="cb283-9"><a href="multivariate-normal-distribution.html#cb283-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb283-10"><a href="multivariate-normal-distribution.html#cb283-10" aria-hidden="true" tabindex="-1"></a>(weschler_cov <span class="ot">&lt;-</span> <span class="fu">cov</span>(wechsler[, <span class="sc">-</span><span class="dv">1</span>]))</span></code></pre></div>
<pre><code>##                   Information Similarities Arithmetic PictureCompletion
## Information         11.474474    9.0855856   6.382883         2.0713213
## Similarities         9.085586   12.0855856   5.938438         0.5435435
## Arithmetic           6.382883    5.9384384  11.090090         1.7912913
## PictureCompletion    2.071321    0.5435435   1.791291         3.6936937</code></pre>
<p>and the eigenvalues and eigenvectors</p>
<div class="sourceCode" id="cb285"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb285-1"><a href="multivariate-normal-distribution.html#cb285-1" aria-hidden="true" tabindex="-1"></a>(weschler_eigen <span class="ot">&lt;-</span> <span class="fu">eigen</span>(weschler_cov))</span></code></pre></div>
<pre><code>## eigen() decomposition
## $values
## [1] 26.245278  6.255366  3.931553  1.911647
## 
## $vectors
##            [,1]       [,2]       [,3]        [,4]
## [1,] -0.6057467  0.2176473  0.4605028  0.61125912
## [2,] -0.6047618  0.4958117 -0.3196759 -0.53501516
## [3,] -0.5051337 -0.7946452 -0.3349263  0.03468877
## [4,] -0.1103360 -0.2744802  0.7573433 -0.58216643</code></pre>
<p>Now consider the 95% prediction ellipse formed by the multivariate normal distribution whose variance-covariance matrix. The half-lengths of the ellipse axes are <span class="math inline">\(l_j = \sqrt{\lambda_j \chi_{p, \alpha}^2}\)</span> where <span class="math inline">\(\chi_{4, .05}^2\)</span> is 9.49.</p>
<div class="sourceCode" id="cb287"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb287-1"><a href="multivariate-normal-distribution.html#cb287-1" aria-hidden="true" tabindex="-1"></a>(weschler_half_len <span class="ot">&lt;-</span> (weschler_eigen<span class="sc">$</span>values <span class="sc">*</span> <span class="fu">qchisq</span>(.<span class="dv">95</span>, <span class="dv">4</span>))<span class="sc">^</span>.<span class="dv">5</span>)</span></code></pre></div>
<pre><code>## [1] 15.779990  7.703845  6.107496  4.258778</code></pre>
<p>The eigenvectors are the directions of the axes. The first vector, (-0.606, -0.605, -0.505, -0.110) has large values for the first three variables (Information, Similarities, and Arithmetic) and a small value for the fourth (PictureCompletion), so the vector points toward the first three. The second axis has a half-length that is about half the size of the first. It’s directed mostly toward the third variable (Arithmetic) and decreasing for the second variable (Similarities). Overall, the ellipse has one long axis and three shorter axes.</p>
<div class="sourceCode" id="cb289"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb289-1"><a href="multivariate-normal-distribution.html#cb289-1" aria-hidden="true" tabindex="-1"></a>mu_Information <span class="ot">&lt;-</span> <span class="fu">mean</span>(wechsler<span class="sc">$</span>Information)</span>
<span id="cb289-2"><a href="multivariate-normal-distribution.html#cb289-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb289-3"><a href="multivariate-normal-distribution.html#cb289-3" aria-hidden="true" tabindex="-1"></a>mu_Similarities <span class="ot">&lt;-</span> <span class="fu">mean</span>(wechsler<span class="sc">$</span>Similarities)</span>
<span id="cb289-4"><a href="multivariate-normal-distribution.html#cb289-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb289-5"><a href="multivariate-normal-distribution.html#cb289-5" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(wechsler, <span class="fu">aes</span>(<span class="at">x =</span> Information, <span class="at">y =</span> Similarities)) <span class="sc">+</span> </span>
<span id="cb289-6"><a href="multivariate-normal-distribution.html#cb289-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span> </span>
<span id="cb289-7"><a href="multivariate-normal-distribution.html#cb289-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_ellipse</span>(<span class="at">type =</span> <span class="st">&quot;norm&quot;</span>) <span class="sc">+</span></span>
<span id="cb289-8"><a href="multivariate-normal-distribution.html#cb289-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_segment</span>(<span class="fu">aes</span>(<span class="at">x =</span> mu_Information, <span class="at">y =</span> <span class="dv">0</span>, <span class="at">xend =</span> mu_Information, <span class="at">yend =</span> mu_Similarities), <span class="at">linetype =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb289-9"><a href="multivariate-normal-distribution.html#cb289-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_segment</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="dv">0</span>, <span class="at">y =</span> mu_Similarities, <span class="at">xend =</span> mu_Information, <span class="at">yend =</span> mu_Similarities), <span class="at">linetype =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb289-10"><a href="multivariate-normal-distribution.html#cb289-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">&quot;text&quot;</span>, <span class="at">x =</span> <span class="dv">0</span>, <span class="at">y =</span> mu_Similarities<span class="sc">*</span><span class="fl">1.1</span>, <span class="at">label =</span> <span class="fu">expression</span>(<span class="fu">paste</span>(mu[<span class="dv">2</span>])), <span class="at">parse =</span> <span class="cn">TRUE</span>, <span class="at">hjust =</span> <span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb289-11"><a href="multivariate-normal-distribution.html#cb289-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">&quot;text&quot;</span>, <span class="at">x =</span> mu_Information<span class="sc">*</span><span class="fl">1.05</span>, <span class="at">y =</span> <span class="dv">0</span>, <span class="at">label =</span> <span class="fu">expression</span>(<span class="fu">paste</span>(mu[<span class="dv">1</span>])), <span class="at">parse =</span> <span class="cn">TRUE</span>, <span class="at">hjust =</span> <span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb289-12"><a href="multivariate-normal-distribution.html#cb289-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_segment</span>(<span class="at">x =</span> mu_Information, <span class="at">y =</span> mu_Similarities, <span class="at">xend =</span> <span class="dv">10</span>, <span class="at">yend=</span><span class="fl">12.5</span>, <span class="at">arrow =</span> <span class="fu">arrow</span>(<span class="at">length =</span> <span class="fu">unit</span>(<span class="fl">0.03</span>, <span class="st">&quot;npc&quot;</span>))) <span class="sc">+</span></span>
<span id="cb289-13"><a href="multivariate-normal-distribution.html#cb289-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_segment</span>(<span class="at">x =</span> mu_Information, <span class="at">y =</span> mu_Similarities, <span class="at">xend =</span> <span class="dv">21</span>, <span class="at">yend=</span><span class="fl">17.5</span>, <span class="at">arrow =</span> <span class="fu">arrow</span>(<span class="at">length =</span> <span class="fu">unit</span>(<span class="fl">0.03</span>, <span class="st">&quot;npc&quot;</span>))) <span class="sc">+</span></span>
<span id="cb289-14"><a href="multivariate-normal-distribution.html#cb289-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">&quot;text&quot;</span>, <span class="at">x =</span> <span class="dv">11</span>, <span class="at">y =</span> <span class="dv">12</span>, <span class="at">label =</span> <span class="fu">expression</span>(<span class="fu">paste</span>(lambda[<span class="dv">2</span>])), <span class="at">parse =</span> <span class="cn">TRUE</span>, <span class="at">hjust =</span> <span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb289-15"><a href="multivariate-normal-distribution.html#cb289-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">&quot;text&quot;</span>, <span class="at">x =</span> <span class="dv">19</span>, <span class="at">y =</span> <span class="dv">17</span>, <span class="at">label =</span> <span class="fu">expression</span>(<span class="fu">paste</span>(lambda[<span class="dv">1</span>])), <span class="at">parse =</span> <span class="cn">TRUE</span>, <span class="at">hjust =</span> <span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb289-16"><a href="multivariate-normal-distribution.html#cb289-16" aria-hidden="true" tabindex="-1"></a>  tune<span class="sc">::</span><span class="fu">coord_obs_pred</span>()</span></code></pre></div>
<p><a href="https://online.stat.psu.edu/stat505/lesson/4" class="uri">https://online.stat.psu.edu/stat505/lesson/4</a></p>

</div>
</div>
<!-- </div> -->
<div class="footnotes">
<hr />
<ol start="20">
<li id="fn20"><p>Eigenvalues and eigenvectors show up in confidence ellipses, PCA, and factor analysis.<a href="multivariate-normal-distribution.html#fnref20" class="footnote-back">↩︎</a></p></li>
</ol>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="linear-transformations.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="references.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="assets/gitbook-2.6.7/js/app.min.js"></script>
<script src="assets/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="assets/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="assets/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="assets/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="assets/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="assets/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="assets/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection",
"scroll_highlight": true
},
"toolbar": {
"position": "static"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
