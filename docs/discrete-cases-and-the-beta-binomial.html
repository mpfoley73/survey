<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>3.8 Discrete Cases and the Beta Binomial | Statistical Inference</title>
  <meta name="description" content="Notes cobbled together from books, online classes, etc. to be used as quick reference for common work projects." />
  <meta name="generator" content="bookdown 0.35 and GitBook 2.6.7" />

  <meta property="og:title" content="3.8 Discrete Cases and the Beta Binomial | Statistical Inference" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="Notes cobbled together from books, online classes, etc. to be used as quick reference for common work projects." />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="3.8 Discrete Cases and the Beta Binomial | Statistical Inference" />
  
  <meta name="twitter:description" content="Notes cobbled together from books, online classes, etc. to be used as quick reference for common work projects." />
  

<meta name="author" content="Michael Foley" />


<meta name="date" content="2023-10-13" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="normal.html"/>
<link rel="next" href="appendix-gentle-introduction.html"/>
<script src="assets/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="assets/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="assets/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="assets/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="assets/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="assets/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="assets/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="assets/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="assets/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="assets/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="assets/anchor-sections-1.1.0/anchor-sections.js"></script>
<link href="assets/tabwid-1.1.3/tabwid.css" rel="stylesheet" />
<script src="assets/tabwid-1.1.3/tabwid.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Preface</a></li>
<li class="chapter" data-level="1" data-path="frequentist-statistics.html"><a href="frequentist-statistics.html"><i class="fa fa-check"></i><b>1</b> Frequentist Statistics</a>
<ul>
<li class="chapter" data-level="1.1" data-path="central-tendancy-and-dispersion.html"><a href="central-tendancy-and-dispersion.html"><i class="fa fa-check"></i><b>1.1</b> Central Tendancy and Dispersion</a></li>
<li class="chapter" data-level="1.2" data-path="hypothesis-testing.html"><a href="hypothesis-testing.html"><i class="fa fa-check"></i><b>1.2</b> Hypothesis Testing</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="likelihood-statistics.html"><a href="likelihood-statistics.html"><i class="fa fa-check"></i><b>2</b> Likelihood Statistics</a>
<ul>
<li class="chapter" data-level="2.1" data-path="maximum-likelihood-estimation.html"><a href="maximum-likelihood-estimation.html"><i class="fa fa-check"></i><b>2.1</b> Maximum Likelihood Estimation</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="bayesian-statistics.html"><a href="bayesian-statistics.html"><i class="fa fa-check"></i><b>3</b> Bayesian Statistics</a>
<ul>
<li class="chapter" data-level="3.1" data-path="bayes-theorem.html"><a href="bayes-theorem.html"><i class="fa fa-check"></i><b>3.1</b> Bayes’ Theorem</a></li>
<li class="chapter" data-level="3.2" data-path="bayesian-inference.html"><a href="bayesian-inference.html"><i class="fa fa-check"></i><b>3.2</b> Bayesian Inference</a></li>
<li class="chapter" data-level="3.3" data-path="discrete-cases.html"><a href="discrete-cases.html"><i class="fa fa-check"></i><b>3.3</b> Discrete Cases</a></li>
<li class="chapter" data-level="3.4" data-path="continuous-cases.html"><a href="continuous-cases.html"><i class="fa fa-check"></i><b>3.4</b> Continuous Cases</a></li>
<li class="chapter" data-level="3.5" data-path="bayes-factors.html"><a href="bayes-factors.html"><i class="fa fa-check"></i><b>3.5</b> Bayes Factors</a></li>
<li class="chapter" data-level="3.6" data-path="gamma-poisson.html"><a href="gamma-poisson.html"><i class="fa fa-check"></i><b>3.6</b> Gamma Poisson</a></li>
<li class="chapter" data-level="3.7" data-path="normal.html"><a href="normal.html"><i class="fa fa-check"></i><b>3.7</b> Normal</a></li>
<li class="chapter" data-level="3.8" data-path="discrete-cases-and-the-beta-binomial.html"><a href="discrete-cases-and-the-beta-binomial.html"><i class="fa fa-check"></i><b>3.8</b> Discrete Cases and the Beta Binomial</a></li>
<li class="chapter" data-level="3.9" data-path="appendix-gentle-introduction.html"><a href="appendix-gentle-introduction.html"><i class="fa fa-check"></i><b>3.9</b> Appendix: Gentle Introduction</a></li>
<li class="chapter" data-level="3.10" data-path="further-reading-1.html"><a href="further-reading-1.html"><i class="fa fa-check"></i><b>3.10</b> Further Reading</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="one-sample.html"><a href="one-sample.html"><i class="fa fa-check"></i><b>4</b> One-Sample</a>
<ul>
<li class="chapter" data-level="4.1" data-path="one-sample-mean-z-test.html"><a href="one-sample-mean-z-test.html"><i class="fa fa-check"></i><b>4.1</b> One-Sample Mean z Test</a></li>
<li class="chapter" data-level="4.2" data-path="one-sample-mean-t-test.html"><a href="one-sample-mean-t-test.html"><i class="fa fa-check"></i><b>4.2</b> One-Sample Mean t Test</a></li>
<li class="chapter" data-level="4.3" data-path="one-sample-median-wilcoxon-test.html"><a href="one-sample-median-wilcoxon-test.html"><i class="fa fa-check"></i><b>4.3</b> One-Sample Median Wilcoxon Test</a></li>
<li class="chapter" data-level="4.4" data-path="chi-squared-goodness-of-fit-test.html"><a href="chi-squared-goodness-of-fit-test.html"><i class="fa fa-check"></i><b>4.4</b> Chi-Squared Goodness-of-Fit Test</a></li>
<li class="chapter" data-level="4.5" data-path="g-test.html"><a href="g-test.html"><i class="fa fa-check"></i><b>4.5</b> G-Test</a></li>
<li class="chapter" data-level="4.6" data-path="one-sample-poisson-test.html"><a href="one-sample-poisson-test.html"><i class="fa fa-check"></i><b>4.6</b> One-Sample Poisson Test</a></li>
<li class="chapter" data-level="4.7" data-path="exact-binomial-test.html"><a href="exact-binomial-test.html"><i class="fa fa-check"></i><b>4.7</b> Exact Binomial Test</a></li>
<li class="chapter" data-level="4.8" data-path="one-sample-proportion-z-test.html"><a href="one-sample-proportion-z-test.html"><i class="fa fa-check"></i><b>4.8</b> One-Sample Proportion z Test</a></li>
<li class="chapter" data-level="4.9" data-path="sample-t-test-for-categorical-var.html"><a href="sample-t-test-for-categorical-var.html"><i class="fa fa-check"></i><b>4.9</b> 1 sample t Test for Categorical Var</a></li>
<li class="chapter" data-level="4.10" data-path="wilcoxon-1-sample-median-test-for-categorical-var.html"><a href="wilcoxon-1-sample-median-test-for-categorical-var.html"><i class="fa fa-check"></i><b>4.10</b> Wilcoxon 1-Sample Median Test for Categorical Var</a></li>
<li class="chapter" data-level="4.11" data-path="multivariate-statistics.html"><a href="multivariate-statistics.html"><i class="fa fa-check"></i><b>4.11</b> Multivariate Statistics</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="group-differences.html"><a href="group-differences.html"><i class="fa fa-check"></i><b>5</b> Group Differences</a>
<ul>
<li class="chapter" data-level="5.1" data-path="ttest.html"><a href="ttest.html"><i class="fa fa-check"></i><b>5.1</b> Independent Samples t-Test</a></li>
<li class="chapter" data-level="5.2" data-path="wilcoxonranksum.html"><a href="wilcoxonranksum.html"><i class="fa fa-check"></i><b>5.2</b> Wilcoxon Rank Sum Test</a></li>
<li class="chapter" data-level="" data-path="case-study-1.html"><a href="case-study-1.html"><i class="fa fa-check"></i>Case Study 1</a></li>
<li class="chapter" data-level="5.3" data-path="pairedttest.html"><a href="pairedttest.html"><i class="fa fa-check"></i><b>5.3</b> Paired Samples t-Test</a></li>
<li class="chapter" data-level="5.4" data-path="wilcoxonsignedrank.html"><a href="wilcoxonsignedrank.html"><i class="fa fa-check"></i><b>5.4</b> Wilcoxon Signed-Rank Test</a></li>
<li class="chapter" data-level="" data-path="case-study-2.html"><a href="case-study-2.html"><i class="fa fa-check"></i>Case Study 2</a></li>
<li class="chapter" data-level="5.5" data-path="onewayanova.html"><a href="onewayanova.html"><i class="fa fa-check"></i><b>5.5</b> One-way ANOVA</a></li>
<li class="chapter" data-level="5.6" data-path="kw.html"><a href="kw.html"><i class="fa fa-check"></i><b>5.6</b> Kruskal–Wallis Test</a></li>
<li class="chapter" data-level="" data-path="groupdiffscs3.html"><a href="groupdiffscs3.html"><i class="fa fa-check"></i>Case Study 3</a></li>
<li class="chapter" data-level="5.7" data-path="chisqhomogeneity.html"><a href="chisqhomogeneity.html"><i class="fa fa-check"></i><b>5.7</b> Chi-Square Test of Homogeneity</a></li>
<li class="chapter" data-level="5.8" data-path="fisherexact.html"><a href="fisherexact.html"><i class="fa fa-check"></i><b>5.8</b> Fisher’s Exact Test</a></li>
<li class="chapter" data-level="" data-path="case-study-4.html"><a href="case-study-4.html"><i class="fa fa-check"></i>Case Study 4</a></li>
<li class="chapter" data-level="5.9" data-path="pairwiseproptest.html"><a href="pairwiseproptest.html"><i class="fa fa-check"></i><b>5.9</b> Pairwise Prop Test</a></li>
<li class="chapter" data-level="5.10" data-path="mcnemar.html"><a href="mcnemar.html"><i class="fa fa-check"></i><b>5.10</b> McNemar’s Test</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="association.html"><a href="association.html"><i class="fa fa-check"></i><b>6</b> Association</a>
<ul>
<li class="chapter" data-level="6.1" data-path="pearson.html"><a href="pearson.html"><i class="fa fa-check"></i><b>6.1</b> Pearson’s Correlation</a></li>
<li class="chapter" data-level="6.2" data-path="spearman.html"><a href="spearman.html"><i class="fa fa-check"></i><b>6.2</b> Spearman’s Rho</a></li>
<li class="chapter" data-level="6.3" data-path="kendall.html"><a href="kendall.html"><i class="fa fa-check"></i><b>6.3</b> Kendal’s Tau</a></li>
<li class="chapter" data-level="6.4" data-path="case-study-pearson-spearman-kendall.html"><a href="case-study-pearson-spearman-kendall.html"><i class="fa fa-check"></i><b>6.4</b> Case Study: Pearson, Spearman, Kendall</a></li>
<li class="chapter" data-level="6.5" data-path="chisq-independence.html"><a href="chisq-independence.html"><i class="fa fa-check"></i><b>6.5</b> Chi-Square Test of Independence</a></li>
<li class="chapter" data-level="6.6" data-path="fisher-exact.html"><a href="fisher-exact.html"><i class="fa fa-check"></i><b>6.6</b> Fisher’s Exact Test</a></li>
<li class="chapter" data-level="6.7" data-path="case-study-chi-square-fisher.html"><a href="case-study-chi-square-fisher.html"><i class="fa fa-check"></i><b>6.7</b> Case Study: Chi-Square, Fisher</a></li>
<li class="chapter" data-level="6.8" data-path="kruskals-lambda.html"><a href="kruskals-lambda.html"><i class="fa fa-check"></i><b>6.8</b> Kruskal’s Lambda</a></li>
<li class="chapter" data-level="6.9" data-path="relative-risk.html"><a href="relative-risk.html"><i class="fa fa-check"></i><b>6.9</b> Relative Risk</a></li>
<li class="chapter" data-level="6.10" data-path="odds-ratio.html"><a href="odds-ratio.html"><i class="fa fa-check"></i><b>6.10</b> Odds Ratio</a></li>
<li class="chapter" data-level="6.11" data-path="partial-correlation.html"><a href="partial-correlation.html"><i class="fa fa-check"></i><b>6.11</b> Partial Correlation</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="matrix-algebra.html"><a href="matrix-algebra.html"><i class="fa fa-check"></i><b>7</b> Matrix Algebra</a>
<ul>
<li class="chapter" data-level="7.1" data-path="central-tendancy-dispersion-and-association.html"><a href="central-tendancy-dispersion-and-association.html"><i class="fa fa-check"></i><b>7.1</b> Central Tendancy, Dispersion, and Association</a></li>
<li class="chapter" data-level="7.2" data-path="linear-transformations.html"><a href="linear-transformations.html"><i class="fa fa-check"></i><b>7.2</b> Linear Transformations</a></li>
<li class="chapter" data-level="7.3" data-path="multivariate-normal-distribution.html"><a href="multivariate-normal-distribution.html"><i class="fa fa-check"></i><b>7.3</b> Multivariate Normal Distribution</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Statistical Inference</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="discrete-cases-and-the-beta-binomial" class="section level2 hasAnchor" number="3.8">
<h2><span class="header-section-number">3.8</span> Discrete Cases and the Beta Binomial<a href="discrete-cases-and-the-beta-binomial.html#discrete-cases-and-the-beta-binomial" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Suppose <span class="math inline">\(y = 35\)</span> of <span class="math inline">\(n = 50\)</span> seeds germinate within 72hrs. What is the expected germination probability, <span class="math inline">\(p\)</span>, of a single seed? Seed germination can be modeled as a Bernoulli data generating process where events occur with probability, <span class="math inline">\(p\)</span>, and the observed <span class="math inline">\(y = \sum_i^n y_i\)</span> is the sum of <span class="math inline">\(n\)</span> Bernoulli trials. The question becomes what <span class="math inline">\(p\)</span> was used in the Bernoulli function?</p>
<p>The classical approach is to construct a 95% CI around <span class="math inline">\(p\)</span> with a <a href="https://mpfoley73.github.io/statistics/one-sample-proportion-z-test.html">one-sample proportion test</a>.</p>
<div class="sourceCode" id="cb84"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb84-1"><a href="discrete-cases-and-the-beta-binomial.html#cb84-1" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="dv">35</span></span>
<span id="cb84-2"><a href="discrete-cases-and-the-beta-binomial.html#cb84-2" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">50</span></span>
<span id="cb84-3"><a href="discrete-cases-and-the-beta-binomial.html#cb84-3" tabindex="-1"></a></span>
<span id="cb84-4"><a href="discrete-cases-and-the-beta-binomial.html#cb84-4" tabindex="-1"></a><span class="fu">prop.test</span>(y, n)</span></code></pre></div>
<pre><code>## 
##  1-sample proportions test with continuity correction
## 
## data:  y out of n, null probability 0.5
## X-squared = 7.22, df = 1, p-value = 0.00721
## alternative hypothesis: true p is not equal to 0.5
## 95 percent confidence interval:
##  0.5521660 0.8171438
## sample estimates:
##   p 
## 0.7</code></pre>
<p>The Bayesian approach is to posit an expected distribution of <span class="math inline">\(p\)</span> <em>prior</em> to observing the data, then update the distribution based on the relative <em>likelihood</em> of observing the data given the values in the distribution. The likelihood of <span class="math inline">\(y\)</span> events in <span class="math inline">\(n\)</span> trials follows the binomial distribution, <span class="math inline">\(y|p \sim \text{Bin}(n, p)\)</span>. In practice, Bayesian analyses take advantage of proportionality and would the binomial coefficient.</p>
<p><span class="math display">\[
\begin{align}
f(y|p) &amp;= {n \choose y} p^y (1-p)^{n-y} \\
&amp;\propto p^y (1-p)^{n-y}
\end{align}
\]</span></p>
<p>The Bayesian approach to estimating <span class="math inline">\(p\)</span> is to treat it as a probability distribution, choosing a prior distribution and updating it with observed data. Take a uniform prior for <span class="math inline">\(p\)</span> as a first approximation. That is, all values of <span class="math inline">\(p\)</span> are equally likely.</p>
<div class="sourceCode" id="cb86"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb86-1"><a href="discrete-cases-and-the-beta-binomial.html#cb86-1" tabindex="-1"></a><span class="co"># Explore the parameter space [0,1] in .01 increments</span></span>
<span id="cb86-2"><a href="discrete-cases-and-the-beta-binomial.html#cb86-2" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="at">by =</span> <span class="fl">0.01</span>)</span>
<span id="cb86-3"><a href="discrete-cases-and-the-beta-binomial.html#cb86-3" tabindex="-1"></a></span>
<span id="cb86-4"><a href="discrete-cases-and-the-beta-binomial.html#cb86-4" tabindex="-1"></a><span class="co"># The prior distribution is uniform, 1/101 for all parameter values.</span></span>
<span id="cb86-5"><a href="discrete-cases-and-the-beta-binomial.html#cb86-5" tabindex="-1"></a>prior <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">1</span><span class="sc">/</span><span class="fu">length</span>(p), <span class="fu">length</span>(p))</span>
<span id="cb86-6"><a href="discrete-cases-and-the-beta-binomial.html#cb86-6" tabindex="-1"></a></span>
<span id="cb86-7"><a href="discrete-cases-and-the-beta-binomial.html#cb86-7" tabindex="-1"></a><span class="co"># Binomial likelihood for the 101 p&#39;s.</span></span>
<span id="cb86-8"><a href="discrete-cases-and-the-beta-binomial.html#cb86-8" tabindex="-1"></a>likelihood <span class="ot">&lt;-</span> <span class="fu">dbinom</span>(<span class="dv">35</span>, <span class="dv">50</span>, p)</span>
<span id="cb86-9"><a href="discrete-cases-and-the-beta-binomial.html#cb86-9" tabindex="-1"></a></span>
<span id="cb86-10"><a href="discrete-cases-and-the-beta-binomial.html#cb86-10" tabindex="-1"></a><span class="co"># Bayes&#39; Theorem: posterior = joint density / marginal density.</span></span>
<span id="cb86-11"><a href="discrete-cases-and-the-beta-binomial.html#cb86-11" tabindex="-1"></a>joint_density <span class="ot">&lt;-</span> likelihood <span class="sc">*</span> prior</span>
<span id="cb86-12"><a href="discrete-cases-and-the-beta-binomial.html#cb86-12" tabindex="-1"></a>marginal_density <span class="ot">&lt;-</span> <span class="fu">sum</span>(joint_density)</span>
<span id="cb86-13"><a href="discrete-cases-and-the-beta-binomial.html#cb86-13" tabindex="-1"></a>posterior <span class="ot">&lt;-</span> joint_density <span class="sc">/</span> marginal_density</span>
<span id="cb86-14"><a href="discrete-cases-and-the-beta-binomial.html#cb86-14" tabindex="-1"></a></span>
<span id="cb86-15"><a href="discrete-cases-and-the-beta-binomial.html#cb86-15" tabindex="-1"></a><span class="co"># 95% credible interval</span></span>
<span id="cb86-16"><a href="discrete-cases-and-the-beta-binomial.html#cb86-16" tabindex="-1"></a>(pi <span class="ot">&lt;-</span> <span class="fu">sum</span>(posterior <span class="sc">*</span> p) <span class="sc">/</span> <span class="fu">sum</span>(posterior))</span>
<span id="cb86-17"><a href="discrete-cases-and-the-beta-binomial.html#cb86-17" tabindex="-1"></a><span class="do">## [1] 0.6923077</span></span>
<span id="cb86-18"><a href="discrete-cases-and-the-beta-binomial.html#cb86-18" tabindex="-1"></a>(ci <span class="ot">&lt;-</span> p[<span class="fu">c</span>(<span class="fu">min</span>(<span class="fu">which</span>(<span class="fu">cumsum</span>(posterior) <span class="sc">&gt;</span> .<span class="dv">025</span>)),</span>
<span id="cb86-19"><a href="discrete-cases-and-the-beta-binomial.html#cb86-19" tabindex="-1"></a>          <span class="fu">max</span>(<span class="fu">which</span>(<span class="fu">cumsum</span>(posterior) <span class="sc">&lt;</span> .<span class="dv">975</span>)))])</span>
<span id="cb86-20"><a href="discrete-cases-and-the-beta-binomial.html#cb86-20" tabindex="-1"></a><span class="do">## [1] 0.56 0.80</span></span>
<span id="cb86-21"><a href="discrete-cases-and-the-beta-binomial.html#cb86-21" tabindex="-1"></a></span>
<span id="cb86-22"><a href="discrete-cases-and-the-beta-binomial.html#cb86-22" tabindex="-1"></a><span class="fu">tibble</span>(p, prior, posterior) <span class="sc">%&gt;%</span></span>
<span id="cb86-23"><a href="discrete-cases-and-the-beta-binomial.html#cb86-23" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="fu">c</span>(prior, posterior)) <span class="sc">%&gt;%</span></span>
<span id="cb86-24"><a href="discrete-cases-and-the-beta-binomial.html#cb86-24" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> p)) <span class="sc">+</span></span>
<span id="cb86-25"><a href="discrete-cases-and-the-beta-binomial.html#cb86-25" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> value, <span class="at">color =</span> name)) <span class="sc">+</span></span>
<span id="cb86-26"><a href="discrete-cases-and-the-beta-binomial.html#cb86-26" tabindex="-1"></a>  <span class="fu">geom_area</span>(<span class="at">data =</span> <span class="fu">tibble</span>(p, posterior, <span class="at">y =</span> <span class="fu">if_else</span>(p <span class="sc">&lt;=</span> ci[<span class="dv">1</span>], posterior, <span class="cn">NA_real_</span>)),</span>
<span id="cb86-27"><a href="discrete-cases-and-the-beta-binomial.html#cb86-27" tabindex="-1"></a>            <span class="fu">aes</span>(<span class="at">y =</span> y), <span class="at">fill =</span> <span class="st">&quot;#F8766D&quot;</span>) <span class="sc">+</span></span>
<span id="cb86-28"><a href="discrete-cases-and-the-beta-binomial.html#cb86-28" tabindex="-1"></a>  <span class="fu">geom_area</span>(<span class="at">data =</span> <span class="fu">tibble</span>(p, posterior, <span class="at">y =</span> <span class="fu">if_else</span>(p <span class="sc">&gt;=</span> ci[<span class="dv">2</span>], posterior, <span class="cn">NA_real_</span>)),</span>
<span id="cb86-29"><a href="discrete-cases-and-the-beta-binomial.html#cb86-29" tabindex="-1"></a>            <span class="fu">aes</span>(<span class="at">y =</span> y), <span class="at">fill =</span> <span class="st">&quot;#F8766D&quot;</span>) <span class="sc">+</span></span>
<span id="cb86-30"><a href="discrete-cases-and-the-beta-binomial.html#cb86-30" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="fu">aes</span>(<span class="at">xintercept =</span> pi), <span class="at">color =</span> <span class="st">&quot;#F8766D&quot;</span>) <span class="sc">+</span></span>
<span id="cb86-31"><a href="discrete-cases-and-the-beta-binomial.html#cb86-31" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> <span class="fu">round</span>(<span class="fu">c</span>(<span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">1</span>), ci, pi), <span class="dv">4</span>)) <span class="sc">+</span></span>
<span id="cb86-32"><a href="discrete-cases-and-the-beta-binomial.html#cb86-32" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y =</span> <span class="st">&quot;density&quot;</span>, <span class="at">color =</span> <span class="cn">NULL</span>, <span class="at">title =</span> <span class="st">&quot;From Prior to Posterior&quot;</span>,</span>
<span id="cb86-33"><a href="discrete-cases-and-the-beta-binomial.html#cb86-33" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">&quot;Data: y=35, n=50.&quot;</span>)</span></code></pre></div>
<p><img src="statistics_files/figure-html/unnamed-chunk-39-1.png" width="672" /></p>
<p>This was good, but we could have done better. The uniform prior took on discrete values, so the 95% CI was constrained to the one of those values. Instead, you can model continuous probability values with the <a href="https://mpfoley73.github.io/probability/random-variables-and-distributions.html#beta">Beta</a> distribution, <span class="math inline">\(p \sim \text{Beta}(a, b)\)</span>.</p>
<p><span class="math display">\[
\begin{align}
f(p) &amp;= \frac{1}{\text{B}(a,b)} p^{a-1} (1-p)^{b-1} \\
&amp;\propto p^{a-1} (1 - p)^{b -1}
\end{align}
\]</span></p>
<p>where <span class="math inline">\(a\)</span> is the success count, <span class="math inline">\(b\)</span> the failure count, and <span class="math inline">\(\text{B} = \frac{\Gamma(a)\Gamma(b)}{\Gamma(a+b)}\)</span> is the beta function. Use Bayes’ formula to derive the posterior distribution, <span class="math inline">\(f(p|y)\)</span>. This time we <em>will</em> take advantage of proportionality.</p>
<p><span class="math display">\[
\begin{align}
f(p|y) =&amp;\propto f(y|p)f(p) \\
&amp;\propto p^y (1-p)^{n-y} p^{a-1} (1 - p)^{b -1} \\
&amp;\propto p^{a+y-1}(1-p)^{b+n-y-1} \\
&amp;\sim \text{Beta}(a + y, b + (n - y))
\end{align}
\]</span></p>
<p>The expected value of the Beta distribution is <span class="math inline">\(a / (a + b)\)</span>, or in this case,</p>
<p><span class="math display">\[
E(p|y) = \frac{a+y}{(a+y)+(b+(n-y))} = \frac{a + y}{a + b + n} = \frac{a + n \bar{y}}{a + b + n}
\]</span></p>
<p>As the sample size increases, <span class="math inline">\(a\)</span> and <span class="math inline">\(b\)</span> become less important and <span class="math inline">\(E(p|y) \rightarrow \bar{y}\)</span>.</p>
<p>In the absence of any other information, use a uniform distribution as the prior again, but this time use <span class="math inline">\(\text{Beta}(a = 1, b = 1)\)</span>. The posterior expected value is <span class="math inline">\(E(p|y) = \frac{1 + 35}{(1+35) + (1 + (50 - 35))}\)</span>. The posterior distribution is <span class="math inline">\(p|y = \text{Beta}(1 + 35, 1 + 15)\)</span>.</p>
<div class="sourceCode" id="cb87"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb87-1"><a href="discrete-cases-and-the-beta-binomial.html#cb87-1" tabindex="-1"></a><span class="co"># Explore the parameter space [0,1] in .01 increments</span></span>
<span id="cb87-2"><a href="discrete-cases-and-the-beta-binomial.html#cb87-2" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="at">by =</span> <span class="fl">0.01</span>)</span>
<span id="cb87-3"><a href="discrete-cases-and-the-beta-binomial.html#cb87-3" tabindex="-1"></a></span>
<span id="cb87-4"><a href="discrete-cases-and-the-beta-binomial.html#cb87-4" tabindex="-1"></a><span class="co"># The prior distribution is uniform, Beta(1, 1).</span></span>
<span id="cb87-5"><a href="discrete-cases-and-the-beta-binomial.html#cb87-5" tabindex="-1"></a>a <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb87-6"><a href="discrete-cases-and-the-beta-binomial.html#cb87-6" tabindex="-1"></a>b <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb87-7"><a href="discrete-cases-and-the-beta-binomial.html#cb87-7" tabindex="-1"></a>prior <span class="ot">&lt;-</span> <span class="fu">dbeta</span>(p, a, a)</span>
<span id="cb87-8"><a href="discrete-cases-and-the-beta-binomial.html#cb87-8" tabindex="-1"></a></span>
<span id="cb87-9"><a href="discrete-cases-and-the-beta-binomial.html#cb87-9" tabindex="-1"></a><span class="co"># Instead of calculating the likelihood, joint density, marginal density, and</span></span>
<span id="cb87-10"><a href="discrete-cases-and-the-beta-binomial.html#cb87-10" tabindex="-1"></a><span class="co"># finally the posterior, we can go straight to the posterior.</span></span>
<span id="cb87-11"><a href="discrete-cases-and-the-beta-binomial.html#cb87-11" tabindex="-1"></a>a <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">+</span> <span class="dv">35</span></span>
<span id="cb87-12"><a href="discrete-cases-and-the-beta-binomial.html#cb87-12" tabindex="-1"></a>b <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">+</span> (<span class="dv">50-35</span>)</span>
<span id="cb87-13"><a href="discrete-cases-and-the-beta-binomial.html#cb87-13" tabindex="-1"></a>posterior <span class="ot">&lt;-</span> <span class="fu">dbeta</span>(p, a, b)</span>
<span id="cb87-14"><a href="discrete-cases-and-the-beta-binomial.html#cb87-14" tabindex="-1"></a></span>
<span id="cb87-15"><a href="discrete-cases-and-the-beta-binomial.html#cb87-15" tabindex="-1"></a><span class="co"># 95% credible interval. This time we don&#39;t need p - we can go straight to the soln.</span></span>
<span id="cb87-16"><a href="discrete-cases-and-the-beta-binomial.html#cb87-16" tabindex="-1"></a>(pi <span class="ot">&lt;-</span> a <span class="sc">/</span> (a <span class="sc">+</span> b))</span>
<span id="cb87-17"><a href="discrete-cases-and-the-beta-binomial.html#cb87-17" tabindex="-1"></a><span class="do">## [1] 0.6923077</span></span>
<span id="cb87-18"><a href="discrete-cases-and-the-beta-binomial.html#cb87-18" tabindex="-1"></a>(ci <span class="ot">&lt;-</span> <span class="fu">qbeta</span>(<span class="fu">c</span>(.<span class="dv">025</span>, .<span class="dv">975</span>), a, b))</span>
<span id="cb87-19"><a href="discrete-cases-and-the-beta-binomial.html#cb87-19" tabindex="-1"></a><span class="do">## [1] 0.5617113 0.8088960</span></span>
<span id="cb87-20"><a href="discrete-cases-and-the-beta-binomial.html#cb87-20" tabindex="-1"></a></span>
<span id="cb87-21"><a href="discrete-cases-and-the-beta-binomial.html#cb87-21" tabindex="-1"></a><span class="fu">tibble</span>(p, prior, posterior) <span class="sc">%&gt;%</span></span>
<span id="cb87-22"><a href="discrete-cases-and-the-beta-binomial.html#cb87-22" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="fu">c</span>(prior, posterior)) <span class="sc">%&gt;%</span></span>
<span id="cb87-23"><a href="discrete-cases-and-the-beta-binomial.html#cb87-23" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> p)) <span class="sc">+</span></span>
<span id="cb87-24"><a href="discrete-cases-and-the-beta-binomial.html#cb87-24" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> value, <span class="at">color =</span> name)) <span class="sc">+</span></span>
<span id="cb87-25"><a href="discrete-cases-and-the-beta-binomial.html#cb87-25" tabindex="-1"></a>  <span class="fu">geom_area</span>(<span class="at">data =</span> <span class="fu">tibble</span>(p, posterior, <span class="at">y =</span> <span class="fu">if_else</span>(p <span class="sc">&lt;=</span> ci[<span class="dv">1</span>], posterior, <span class="cn">NA_real_</span>)),</span>
<span id="cb87-26"><a href="discrete-cases-and-the-beta-binomial.html#cb87-26" tabindex="-1"></a>            <span class="fu">aes</span>(<span class="at">y =</span> y), <span class="at">fill =</span> <span class="st">&quot;#F8766D&quot;</span>) <span class="sc">+</span></span>
<span id="cb87-27"><a href="discrete-cases-and-the-beta-binomial.html#cb87-27" tabindex="-1"></a>  <span class="fu">geom_area</span>(<span class="at">data =</span> <span class="fu">tibble</span>(p, posterior, <span class="at">y =</span> <span class="fu">if_else</span>(p <span class="sc">&gt;=</span> ci[<span class="dv">2</span>], posterior, <span class="cn">NA_real_</span>)),</span>
<span id="cb87-28"><a href="discrete-cases-and-the-beta-binomial.html#cb87-28" tabindex="-1"></a>            <span class="fu">aes</span>(<span class="at">y =</span> y), <span class="at">fill =</span> <span class="st">&quot;#F8766D&quot;</span>) <span class="sc">+</span></span>
<span id="cb87-29"><a href="discrete-cases-and-the-beta-binomial.html#cb87-29" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="fu">aes</span>(<span class="at">xintercept =</span> pi), <span class="at">color =</span> <span class="st">&quot;#F8766D&quot;</span>) <span class="sc">+</span></span>
<span id="cb87-30"><a href="discrete-cases-and-the-beta-binomial.html#cb87-30" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> <span class="fu">round</span>(<span class="fu">c</span>(<span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">1</span>), ci, pi), <span class="dv">4</span>)) <span class="sc">+</span></span>
<span id="cb87-31"><a href="discrete-cases-and-the-beta-binomial.html#cb87-31" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y =</span> <span class="st">&quot;density&quot;</span>, <span class="at">color =</span> <span class="cn">NULL</span>, <span class="at">title =</span> <span class="st">&quot;From Prior to Posterior, using Beta(1, 1) prior.&quot;</span>,</span>
<span id="cb87-32"><a href="discrete-cases-and-the-beta-binomial.html#cb87-32" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">&quot;Data: y=35, n=50.&quot;</span>)</span></code></pre></div>
<p><img src="statistics_files/figure-html/unnamed-chunk-40-1.png" width="672" /></p>
<p>Suppose in a second experiment 63 of 80 seeds germinate. Update your posterior.</p>
<div class="sourceCode" id="cb88"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb88-1"><a href="discrete-cases-and-the-beta-binomial.html#cb88-1" tabindex="-1"></a>a <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">+</span> <span class="dv">35</span> <span class="sc">+</span> <span class="dv">63</span></span>
<span id="cb88-2"><a href="discrete-cases-and-the-beta-binomial.html#cb88-2" tabindex="-1"></a>b <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">+</span> (<span class="dv">50-35</span>) <span class="sc">+</span> (<span class="dv">80-63</span>)</span>
<span id="cb88-3"><a href="discrete-cases-and-the-beta-binomial.html#cb88-3" tabindex="-1"></a></span>
<span id="cb88-4"><a href="discrete-cases-and-the-beta-binomial.html#cb88-4" tabindex="-1"></a><span class="co"># 95% credible interval. This time we don&#39;t need p - we can go straight to the soln.</span></span>
<span id="cb88-5"><a href="discrete-cases-and-the-beta-binomial.html#cb88-5" tabindex="-1"></a>a <span class="sc">/</span> (a <span class="sc">+</span> b)</span>
<span id="cb88-6"><a href="discrete-cases-and-the-beta-binomial.html#cb88-6" tabindex="-1"></a><span class="do">## [1] 0.75</span></span>
<span id="cb88-7"><a href="discrete-cases-and-the-beta-binomial.html#cb88-7" tabindex="-1"></a><span class="fu">qbeta</span>(<span class="fu">c</span>(.<span class="dv">025</span>, .<span class="dv">975</span>), a, b)</span>
<span id="cb88-8"><a href="discrete-cases-and-the-beta-binomial.html#cb88-8" tabindex="-1"></a><span class="do">## [1] 0.6730063 0.8198209</span></span>
<span id="cb88-9"><a href="discrete-cases-and-the-beta-binomial.html#cb88-9" tabindex="-1"></a></span>
<span id="cb88-10"><a href="discrete-cases-and-the-beta-binomial.html#cb88-10" tabindex="-1"></a><span class="co"># probability that p &gt; .80</span></span>
<span id="cb88-11"><a href="discrete-cases-and-the-beta-binomial.html#cb88-11" tabindex="-1"></a><span class="fu">pbeta</span>(.<span class="dv">80</span>, a, b, <span class="at">lower.tail =</span> <span class="cn">FALSE</span>)</span>
<span id="cb88-12"><a href="discrete-cases-and-the-beta-binomial.html#cb88-12" tabindex="-1"></a><span class="do">## [1] 0.08699946</span></span>
<span id="cb88-13"><a href="discrete-cases-and-the-beta-binomial.html#cb88-13" tabindex="-1"></a></span>
<span id="cb88-14"><a href="discrete-cases-and-the-beta-binomial.html#cb88-14" tabindex="-1"></a><span class="co"># posterior predictive probability that x &gt;= 80 of 100 seeds will germinate</span></span>
<span id="cb88-15"><a href="discrete-cases-and-the-beta-binomial.html#cb88-15" tabindex="-1"></a>sample_beta <span class="ot">&lt;-</span> <span class="fu">rbeta</span>(<span class="dv">1000</span>, a, b)</span>
<span id="cb88-16"><a href="discrete-cases-and-the-beta-binomial.html#cb88-16" tabindex="-1"></a>sample_binom <span class="ot">&lt;-</span> <span class="fu">rbinom</span>(<span class="dv">1000</span>, <span class="dv">100</span>, sample_beta)</span>
<span id="cb88-17"><a href="discrete-cases-and-the-beta-binomial.html#cb88-17" tabindex="-1"></a><span class="fu">mean</span>(sample_binom <span class="sc">&gt;=</span> <span class="dv">80</span>)</span>
<span id="cb88-18"><a href="discrete-cases-and-the-beta-binomial.html#cb88-18" tabindex="-1"></a><span class="do">## [1] 0.209</span></span></code></pre></div>
<p>If instead of observing a single proportion of <span class="math inline">\(y\)</span> events in <span class="math inline">\(n\)</span> trials, you observe <span class="math inline">\(j\)</span> proportions of <span class="math inline">\(y_i\)</span> events in <span class="math inline">\(n_i\)</span> trials? E.g., suppose 100 persons report the number of days per week they consume alcohol (0 - 7).</p>
<div class="sourceCode" id="cb89"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb89-1"><a href="discrete-cases-and-the-beta-binomial.html#cb89-1" tabindex="-1"></a>days <span class="ot">&lt;-</span> <span class="dv">0</span><span class="sc">:</span><span class="dv">7</span></span>
<span id="cb89-2"><a href="discrete-cases-and-the-beta-binomial.html#cb89-2" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">22</span>, <span class="dv">6</span>, <span class="dv">18</span>, <span class="dv">23</span>, <span class="dv">18</span>, <span class="dv">10</span>, <span class="dv">3</span>, <span class="dv">0</span>)</span>
<span id="cb89-3"><a href="discrete-cases-and-the-beta-binomial.html#cb89-3" tabindex="-1"></a></span>
<span id="cb89-4"><a href="discrete-cases-and-the-beta-binomial.html#cb89-4" tabindex="-1"></a><span class="co"># Actual drinking days per week</span></span>
<span id="cb89-5"><a href="discrete-cases-and-the-beta-binomial.html#cb89-5" tabindex="-1"></a>(y_days <span class="ot">&lt;-</span> <span class="fu">sum</span>(days <span class="sc">*</span> y))</span></code></pre></div>
<pre><code>## [1] 251</code></pre>
<div class="sourceCode" id="cb91"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb91-1"><a href="discrete-cases-and-the-beta-binomial.html#cb91-1" tabindex="-1"></a><span class="co"># Possible drinking days per week</span></span>
<span id="cb91-2"><a href="discrete-cases-and-the-beta-binomial.html#cb91-2" tabindex="-1"></a>(n <span class="ot">&lt;-</span> <span class="dv">7</span> <span class="sc">*</span> <span class="dv">100</span>)</span></code></pre></div>
<pre><code>## [1] 700</code></pre>
<div class="sourceCode" id="cb93"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb93-1"><a href="discrete-cases-and-the-beta-binomial.html#cb93-1" tabindex="-1"></a><span class="co"># Beta posterior.</span></span>
<span id="cb93-2"><a href="discrete-cases-and-the-beta-binomial.html#cb93-2" tabindex="-1"></a>a <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">+</span> y_days</span>
<span id="cb93-3"><a href="discrete-cases-and-the-beta-binomial.html#cb93-3" tabindex="-1"></a>b <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">+</span> (n <span class="sc">-</span> y_days)</span>
<span id="cb93-4"><a href="discrete-cases-and-the-beta-binomial.html#cb93-4" tabindex="-1"></a>(posterior_mean <span class="ot">&lt;-</span> a <span class="sc">/</span> (a <span class="sc">+</span> b))</span></code></pre></div>
<pre><code>## [1] 0.3589744</code></pre>
<div class="sourceCode" id="cb95"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb95-1"><a href="discrete-cases-and-the-beta-binomial.html#cb95-1" tabindex="-1"></a><span class="fu">qbeta</span>(<span class="fu">c</span>(.<span class="dv">025</span>, .<span class="dv">975</span>), a, b)</span></code></pre></div>
<pre><code>## [1] 0.3239070 0.3948028</code></pre>
<p>The posterior mean estimated probability of having a drink on any given day is .36, 95% CI (.32, .39). The predictive distribution of <span class="math inline">\(\tilde{y}\)</span> is <span class="math inline">\(f(\tilde{y}|y) = \int f(\tilde{y}|p) f(p|y) dp\)</span>. Instead of integrating for the solution, you can run a simulation. Sample a thousand <span class="math inline">\(p\)</span>’s from the posterior beta distribution, then pipe the sampled <span class="math inline">\(p\)</span>’s into the statistic function, in this case the binomial distribution, to get sampled <span class="math inline">\(y\)</span>’s.</p>
<div class="sourceCode" id="cb97"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb97-1"><a href="discrete-cases-and-the-beta-binomial.html#cb97-1" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">12345</span>)</span>
<span id="cb97-2"><a href="discrete-cases-and-the-beta-binomial.html#cb97-2" tabindex="-1"></a></span>
<span id="cb97-3"><a href="discrete-cases-and-the-beta-binomial.html#cb97-3" tabindex="-1"></a>sampled_p <span class="ot">&lt;-</span> <span class="fu">rbeta</span>(<span class="dv">10</span><span class="sc">^</span><span class="dv">3</span>, a, b)</span>
<span id="cb97-4"><a href="discrete-cases-and-the-beta-binomial.html#cb97-4" tabindex="-1"></a>y_tilde <span class="ot">&lt;-</span> <span class="fu">rbinom</span>(<span class="dv">10</span><span class="sc">^</span><span class="dv">3</span>, <span class="dv">7</span>, sampled_p)</span>
<span id="cb97-5"><a href="discrete-cases-and-the-beta-binomial.html#cb97-5" tabindex="-1"></a></span>
<span id="cb97-6"><a href="discrete-cases-and-the-beta-binomial.html#cb97-6" tabindex="-1"></a><span class="co"># mean and 95% CI predicted number of drinking days</span></span>
<span id="cb97-7"><a href="discrete-cases-and-the-beta-binomial.html#cb97-7" tabindex="-1"></a><span class="fu">mean</span>(y_tilde)</span>
<span id="cb97-8"><a href="discrete-cases-and-the-beta-binomial.html#cb97-8" tabindex="-1"></a><span class="do">## [1] 2.482</span></span>
<span id="cb97-9"><a href="discrete-cases-and-the-beta-binomial.html#cb97-9" tabindex="-1"></a><span class="fu">quantile</span>(y_tilde, <span class="fu">c</span>(.<span class="dv">025</span>, .<span class="dv">975</span>))</span>
<span id="cb97-10"><a href="discrete-cases-and-the-beta-binomial.html#cb97-10" tabindex="-1"></a><span class="do">##  2.5% 97.5% </span></span>
<span id="cb97-11"><a href="discrete-cases-and-the-beta-binomial.html#cb97-11" tabindex="-1"></a><span class="do">##     0     5</span></span></code></pre></div>
<p>Simulations of statistics based on the posterior distribution is a general procedure. E.g., you might run a simulation to predict the probability of <span class="math inline">\(y = 0\)</span> drinking days.</p>
<div class="sourceCode" id="cb98"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb98-1"><a href="discrete-cases-and-the-beta-binomial.html#cb98-1" tabindex="-1"></a><span class="fu">sum</span>(y_tilde <span class="sc">==</span> <span class="dv">0</span>) <span class="sc">/</span> <span class="fu">length</span>(y_tilde)</span></code></pre></div>
<pre><code>## [1] 0.049</code></pre>
<p>Use the Deviance Information Criterion (DIC) to compare group means.</p>
<p><span class="math display">\[
DIC = p_D + \overline{D(\theta)}
\]</span></p>
<p>where <span class="math inline">\(p_D = \overline{D(\theta)} - D(\hat{\theta})\)</span> and <span class="math inline">\(D(\theta) = -2 \log (f(y|\theta)) + C\)</span>.</p>
<p>Evaluate <span class="math inline">\(\overline{D(\theta)}\)</span> by producing samples from each distribution and evaluating the likelihoods of the data based on each realization and taking the mean of -2 log-likelihood.</p>
<div class="sourceCode" id="cb100"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb100-1"><a href="discrete-cases-and-the-beta-binomial.html#cb100-1" tabindex="-1"></a><span class="co"># Two samples with success rates 35/50 and 15/20</span></span>
<span id="cb100-2"><a href="discrete-cases-and-the-beta-binomial.html#cb100-2" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">35</span>, <span class="dv">15</span>)</span>
<span id="cb100-3"><a href="discrete-cases-and-the-beta-binomial.html#cb100-3" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">50</span>, <span class="dv">20</span>)</span>
<span id="cb100-4"><a href="discrete-cases-and-the-beta-binomial.html#cb100-4" tabindex="-1"></a></span>
<span id="cb100-5"><a href="discrete-cases-and-the-beta-binomial.html#cb100-5" tabindex="-1"></a><span class="co"># Priors</span></span>
<span id="cb100-6"><a href="discrete-cases-and-the-beta-binomial.html#cb100-6" tabindex="-1"></a>a <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb100-7"><a href="discrete-cases-and-the-beta-binomial.html#cb100-7" tabindex="-1"></a>b <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb100-8"><a href="discrete-cases-and-the-beta-binomial.html#cb100-8" tabindex="-1"></a></span>
<span id="cb100-9"><a href="discrete-cases-and-the-beta-binomial.html#cb100-9" tabindex="-1"></a><span class="co"># Posteriors</span></span>
<span id="cb100-10"><a href="discrete-cases-and-the-beta-binomial.html#cb100-10" tabindex="-1"></a>post <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb100-11"><a href="discrete-cases-and-the-beta-binomial.html#cb100-11" tabindex="-1"></a>  <span class="fu">rbeta</span>(<span class="dv">10</span><span class="sc">^</span><span class="dv">3</span>, a<span class="sc">+</span>y[<span class="dv">1</span>], b<span class="sc">+</span>n[<span class="dv">1</span>]<span class="sc">-</span>y[<span class="dv">1</span>]),</span>
<span id="cb100-12"><a href="discrete-cases-and-the-beta-binomial.html#cb100-12" tabindex="-1"></a>  <span class="fu">rbeta</span>(<span class="dv">10</span><span class="sc">^</span><span class="dv">3</span>, a<span class="sc">+</span>y[<span class="dv">2</span>], b<span class="sc">+</span>n[<span class="dv">2</span>]<span class="sc">-</span>y[<span class="dv">2</span>])</span>
<span id="cb100-13"><a href="discrete-cases-and-the-beta-binomial.html#cb100-13" tabindex="-1"></a>)</span>
<span id="cb100-14"><a href="discrete-cases-and-the-beta-binomial.html#cb100-14" tabindex="-1"></a></span>
<span id="cb100-15"><a href="discrete-cases-and-the-beta-binomial.html#cb100-15" tabindex="-1"></a><span class="co"># -2 * Mean log-likelihood</span></span>
<span id="cb100-16"><a href="discrete-cases-and-the-beta-binomial.html#cb100-16" tabindex="-1"></a>ll <span class="ot">&lt;-</span> </span>
<span id="cb100-17"><a href="discrete-cases-and-the-beta-binomial.html#cb100-17" tabindex="-1"></a>  <span class="fu">dbinom</span>(y[<span class="dv">1</span>], n[<span class="dv">1</span>], post[[<span class="dv">1</span>]], <span class="at">log =</span> <span class="cn">TRUE</span>) <span class="sc">+</span></span>
<span id="cb100-18"><a href="discrete-cases-and-the-beta-binomial.html#cb100-18" tabindex="-1"></a>  <span class="fu">dbinom</span>(y[<span class="dv">2</span>], n[<span class="dv">2</span>], post[[<span class="dv">2</span>]], <span class="at">log =</span> <span class="cn">TRUE</span>)</span>
<span id="cb100-19"><a href="discrete-cases-and-the-beta-binomial.html#cb100-19" tabindex="-1"></a>(mean_D <span class="ot">&lt;-</span> <span class="fu">mean</span>(<span class="sc">-</span><span class="dv">2</span> <span class="sc">*</span> ll))</span></code></pre></div>
<pre><code>## [1] 9.21603</code></pre>
<div class="sourceCode" id="cb102"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb102-1"><a href="discrete-cases-and-the-beta-binomial.html#cb102-1" tabindex="-1"></a><span class="co"># D(theta-bar) is the likelihood of the data based on the posterior means of p.</span></span>
<span id="cb102-2"><a href="discrete-cases-and-the-beta-binomial.html#cb102-2" tabindex="-1"></a>(D_mean <span class="ot">&lt;-</span> <span class="sc">-</span><span class="dv">2</span> <span class="sc">*</span> (</span>
<span id="cb102-3"><a href="discrete-cases-and-the-beta-binomial.html#cb102-3" tabindex="-1"></a>  <span class="fu">dbinom</span>(y[<span class="dv">1</span>], n[<span class="dv">1</span>], (a<span class="sc">+</span>y[<span class="dv">1</span>]) <span class="sc">/</span> (a<span class="sc">+</span>y[<span class="dv">1</span>] <span class="sc">+</span> b<span class="sc">+</span>n[<span class="dv">1</span>]<span class="sc">-</span>y[<span class="dv">1</span>]), <span class="at">log =</span> <span class="cn">TRUE</span>) <span class="sc">+</span></span>
<span id="cb102-4"><a href="discrete-cases-and-the-beta-binomial.html#cb102-4" tabindex="-1"></a>  <span class="fu">dbinom</span>(y[<span class="dv">2</span>], n[<span class="dv">2</span>], (a<span class="sc">+</span>y[<span class="dv">2</span>]) <span class="sc">/</span> (a<span class="sc">+</span>y[<span class="dv">2</span>] <span class="sc">+</span> b<span class="sc">+</span>n[<span class="dv">2</span>]<span class="sc">-</span>y[<span class="dv">2</span>]), <span class="at">log =</span> <span class="cn">TRUE</span>)</span>
<span id="cb102-5"><a href="discrete-cases-and-the-beta-binomial.html#cb102-5" tabindex="-1"></a>))</span></code></pre></div>
<pre><code>## [1] 7.46448</code></pre>
<div class="sourceCode" id="cb104"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb104-1"><a href="discrete-cases-and-the-beta-binomial.html#cb104-1" tabindex="-1"></a><span class="co">#p_D and DIC from equation</span></span>
<span id="cb104-2"><a href="discrete-cases-and-the-beta-binomial.html#cb104-2" tabindex="-1"></a>(p_D <span class="ot">&lt;-</span> mean_D <span class="sc">-</span> D_mean)</span></code></pre></div>
<pre><code>## [1] 1.75155</code></pre>
<div class="sourceCode" id="cb106"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb106-1"><a href="discrete-cases-and-the-beta-binomial.html#cb106-1" tabindex="-1"></a>(DIC <span class="ot">&lt;-</span> p_D <span class="sc">+</span> mean_D)</span></code></pre></div>
<pre><code>## [1] 10.96758</code></pre>
<div class="sourceCode" id="cb108"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb108-1"><a href="discrete-cases-and-the-beta-binomial.html#cb108-1" tabindex="-1"></a><span class="co"># Repeat these steps for a single model of both groups</span></span>
<span id="cb108-2"><a href="discrete-cases-and-the-beta-binomial.html#cb108-2" tabindex="-1"></a>post_group <span class="ot">&lt;-</span> <span class="fu">rbeta</span>(<span class="dv">10</span><span class="sc">^</span><span class="dv">3</span>, a<span class="sc">+</span><span class="fu">sum</span>(y), b<span class="sc">+</span><span class="fu">sum</span>(n)<span class="sc">-</span><span class="fu">sum</span>(y))</span>
<span id="cb108-3"><a href="discrete-cases-and-the-beta-binomial.html#cb108-3" tabindex="-1"></a>ll_group <span class="ot">&lt;-</span> </span>
<span id="cb108-4"><a href="discrete-cases-and-the-beta-binomial.html#cb108-4" tabindex="-1"></a>  <span class="fu">dbinom</span>(y[<span class="dv">1</span>], n[<span class="dv">1</span>], post_group, <span class="at">log =</span> <span class="cn">TRUE</span>) <span class="sc">+</span></span>
<span id="cb108-5"><a href="discrete-cases-and-the-beta-binomial.html#cb108-5" tabindex="-1"></a>  <span class="fu">dbinom</span>(y[<span class="dv">2</span>], n[<span class="dv">2</span>], post_group, <span class="at">log =</span> <span class="cn">TRUE</span>)</span>
<span id="cb108-6"><a href="discrete-cases-and-the-beta-binomial.html#cb108-6" tabindex="-1"></a>(mean_D_group <span class="ot">&lt;-</span> <span class="fu">mean</span>(<span class="sc">-</span><span class="dv">2</span> <span class="sc">*</span> ll_group))</span></code></pre></div>
<pre><code>## [1] 8.608443</code></pre>
<div class="sourceCode" id="cb110"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb110-1"><a href="discrete-cases-and-the-beta-binomial.html#cb110-1" tabindex="-1"></a>(D_mean_group <span class="ot">&lt;-</span> <span class="sc">-</span><span class="dv">2</span> <span class="sc">*</span> (</span>
<span id="cb110-2"><a href="discrete-cases-and-the-beta-binomial.html#cb110-2" tabindex="-1"></a>  <span class="fu">dbinom</span>(y[<span class="dv">1</span>], n[<span class="dv">1</span>], (a<span class="sc">+</span><span class="fu">sum</span>(y)) <span class="sc">/</span> (a<span class="sc">+</span><span class="fu">sum</span>(y) <span class="sc">+</span> b<span class="sc">+</span><span class="fu">sum</span>(n)<span class="sc">-</span><span class="fu">sum</span>(y)), <span class="at">log =</span> <span class="cn">TRUE</span>) <span class="sc">+</span></span>
<span id="cb110-3"><a href="discrete-cases-and-the-beta-binomial.html#cb110-3" tabindex="-1"></a>  <span class="fu">dbinom</span>(y[<span class="dv">2</span>], n[<span class="dv">2</span>], (a<span class="sc">+</span><span class="fu">sum</span>(y)) <span class="sc">/</span> (a<span class="sc">+</span><span class="fu">sum</span>(y) <span class="sc">+</span> b<span class="sc">+</span><span class="fu">sum</span>(n)<span class="sc">-</span><span class="fu">sum</span>(y)), <span class="at">log =</span> <span class="cn">TRUE</span>)</span>
<span id="cb110-4"><a href="discrete-cases-and-the-beta-binomial.html#cb110-4" tabindex="-1"></a>))</span></code></pre></div>
<pre><code>## [1] 7.587449</code></pre>
<div class="sourceCode" id="cb112"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb112-1"><a href="discrete-cases-and-the-beta-binomial.html#cb112-1" tabindex="-1"></a>(p_D_group <span class="ot">&lt;-</span> mean_D_group <span class="sc">-</span> D_mean_group)</span></code></pre></div>
<pre><code>## [1] 1.020994</code></pre>
<div class="sourceCode" id="cb114"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb114-1"><a href="discrete-cases-and-the-beta-binomial.html#cb114-1" tabindex="-1"></a>(DIC_group <span class="ot">&lt;-</span> p_D_group <span class="sc">+</span> mean_D_group)</span></code></pre></div>
<pre><code>## [1] 9.629437</code></pre>
<p>The DIC for the two group model is 10.9675802 and for the one common group model it is 9.6294374. The DIC for one common group model is smaller, so we do not have enough statistical evidence for two groups. If the DIC for the group-specific model is at least 3 units smaller than that for the common model, there is sufficient statistical evidence for difference between groups.</p>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="normal.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="appendix-gentle-introduction.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="assets/gitbook-2.6.7/js/app.min.js"></script>
<script src="assets/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="assets/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="assets/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="assets/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="assets/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="assets/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="assets/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection",
"scroll_highlight": true
},
"toolbar": {
"position": "static"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
