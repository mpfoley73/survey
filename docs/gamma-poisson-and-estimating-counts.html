<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>3.4 Gamma Poisson and Estimating Counts | Statistical Inference</title>
  <meta name="description" content="Notes cobbled together from books, online classes, etc. to be used as quick reference for common work projects." />
  <meta name="generator" content="bookdown 0.35 and GitBook 2.6.7" />

  <meta property="og:title" content="3.4 Gamma Poisson and Estimating Counts | Statistical Inference" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="Notes cobbled together from books, online classes, etc. to be used as quick reference for common work projects." />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="3.4 Gamma Poisson and Estimating Counts | Statistical Inference" />
  
  <meta name="twitter:description" content="Notes cobbled together from books, online classes, etc. to be used as quick reference for common work projects." />
  

<meta name="author" content="Michael Foley" />


<meta name="date" content="2023-11-02" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="markov-chain-monte-carlo-mcmc.html"/>
<link rel="next" href="normal-and-estimating-means.html"/>
<script src="assets/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="assets/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="assets/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="assets/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="assets/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="assets/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="assets/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="assets/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="assets/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="assets/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="assets/anchor-sections-1.1.0/anchor-sections.js"></script>
<link href="assets/tabwid-1.1.3/tabwid.css" rel="stylesheet" />
<script src="assets/tabwid-1.1.3/tabwid.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>
<style type="text/css">
/* Used with Pandoc 2.11+ new --citeproc when CSL is used */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Preface</a></li>
<li class="chapter" data-level="1" data-path="frequentist-statistics.html"><a href="frequentist-statistics.html"><i class="fa fa-check"></i><b>1</b> Frequentist Statistics</a>
<ul>
<li class="chapter" data-level="1.1" data-path="central-tendancy-and-dispersion.html"><a href="central-tendancy-and-dispersion.html"><i class="fa fa-check"></i><b>1.1</b> Central Tendancy and Dispersion</a></li>
<li class="chapter" data-level="1.2" data-path="hypothesis-testing.html"><a href="hypothesis-testing.html"><i class="fa fa-check"></i><b>1.2</b> Hypothesis Testing</a>
<ul>
<li class="chapter" data-level="" data-path="hypothesis-testing.html"><a href="hypothesis-testing.html#type-i-and-ii-errors"><i class="fa fa-check"></i>Type I and II Errors</a></li>
<li class="chapter" data-level="" data-path="hypothesis-testing.html"><a href="hypothesis-testing.html#statistical-power"><i class="fa fa-check"></i>Statistical Power</a></li>
<li class="chapter" data-level="" data-path="hypothesis-testing.html"><a href="hypothesis-testing.html#what-p-values-would-you-expect"><i class="fa fa-check"></i>What p-values would you expect?</a></li>
<li class="chapter" data-level="1.2.1" data-path="hypothesis-testing.html"><a href="hypothesis-testing.html#further-reading"><i class="fa fa-check"></i><b>1.2.1</b> Further Reading</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="2" data-path="likelihood-statistics.html"><a href="likelihood-statistics.html"><i class="fa fa-check"></i><b>2</b> Likelihood Statistics</a>
<ul>
<li class="chapter" data-level="2.1" data-path="maximum-likelihood-estimation.html"><a href="maximum-likelihood-estimation.html"><i class="fa fa-check"></i><b>2.1</b> Maximum Likelihood Estimation</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="bayesian-statistics.html"><a href="bayesian-statistics.html"><i class="fa fa-check"></i><b>3</b> Bayesian Statistics</a>
<ul>
<li class="chapter" data-level="3.1" data-path="bayes-theorem.html"><a href="bayes-theorem.html"><i class="fa fa-check"></i><b>3.1</b> Bayes’ Theorem</a></li>
<li class="chapter" data-level="3.2" data-path="bayesian-inference.html"><a href="bayesian-inference.html"><i class="fa fa-check"></i><b>3.2</b> Bayesian Inference</a></li>
<li class="chapter" data-level="3.3" data-path="markov-chain-monte-carlo-mcmc.html"><a href="markov-chain-monte-carlo-mcmc.html"><i class="fa fa-check"></i><b>3.3</b> Markov Chain Monte Carlo (MCMC)</a>
<ul>
<li class="chapter" data-level="3.3.1" data-path="markov-chain-monte-carlo-mcmc.html"><a href="markov-chain-monte-carlo-mcmc.html#the-classical-approach"><i class="fa fa-check"></i><b>3.3.1</b> The Classical Approach</a></li>
<li class="chapter" data-level="3.3.2" data-path="markov-chain-monte-carlo-mcmc.html"><a href="markov-chain-monte-carlo-mcmc.html#rejection-sampling"><i class="fa fa-check"></i><b>3.3.2</b> Rejection Sampling</a></li>
<li class="chapter" data-level="3.3.3" data-path="markov-chain-monte-carlo-mcmc.html"><a href="markov-chain-monte-carlo-mcmc.html#gibbs-sampler"><i class="fa fa-check"></i><b>3.3.3</b> Gibbs Sampler</a></li>
<li class="chapter" data-level="3.3.4" data-path="markov-chain-monte-carlo-mcmc.html"><a href="markov-chain-monte-carlo-mcmc.html#metropolis-hastings"><i class="fa fa-check"></i><b>3.3.4</b> Metropolis-Hastings</a></li>
<li class="chapter" data-level="3.3.5" data-path="markov-chain-monte-carlo-mcmc.html"><a href="markov-chain-monte-carlo-mcmc.html#other-notes"><i class="fa fa-check"></i><b>3.3.5</b> Other Notes</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="gamma-poisson-and-estimating-counts.html"><a href="gamma-poisson-and-estimating-counts.html"><i class="fa fa-check"></i><b>3.4</b> Gamma Poisson and Estimating Counts</a></li>
<li class="chapter" data-level="3.5" data-path="normal-and-estimating-means.html"><a href="normal-and-estimating-means.html"><i class="fa fa-check"></i><b>3.5</b> Normal and Estimating Means</a>
<ul>
<li class="chapter" data-level="3.5.1" data-path="normal-and-estimating-means.html"><a href="normal-and-estimating-means.html#normal-pop-est"><i class="fa fa-check"></i><b>3.5.1</b> Population Estimate</a></li>
<li class="chapter" data-level="3.5.2" data-path="normal-and-estimating-means.html"><a href="normal-and-estimating-means.html#regression"><i class="fa fa-check"></i><b>3.5.2</b> Regression</a></li>
<li class="chapter" data-level="3.5.3" data-path="normal-and-estimating-means.html"><a href="normal-and-estimating-means.html#generalized-linear-models"><i class="fa fa-check"></i><b>3.5.3</b> Generalized Linear Models</a></li>
<li class="chapter" data-level="3.5.4" data-path="normal-and-estimating-means.html"><a href="normal-and-estimating-means.html#missing-data"><i class="fa fa-check"></i><b>3.5.4</b> Missing Data</a></li>
<li class="chapter" data-level="3.5.5" data-path="normal-and-estimating-means.html"><a href="normal-and-estimating-means.html#change-point-regression"><i class="fa fa-check"></i><b>3.5.5</b> Change Point Regression</a></li>
<li class="chapter" data-level="3.5.6" data-path="normal-and-estimating-means.html"><a href="normal-and-estimating-means.html#cluster-analysis"><i class="fa fa-check"></i><b>3.5.6</b> Cluster Analysis</a></li>
</ul></li>
<li class="chapter" data-level="3.6" data-path="beta-binomial-and-estimating-proportions.html"><a href="beta-binomial-and-estimating-proportions.html"><i class="fa fa-check"></i><b>3.6</b> Beta Binomial and Estimating Proportions</a></li>
<li class="chapter" data-level="3.7" data-path="zero-inflation-and-latent-variables.html"><a href="zero-inflation-and-latent-variables.html"><i class="fa fa-check"></i><b>3.7</b> Zero-Inflation and Latent Variables</a></li>
<li class="chapter" data-level="3.8" data-path="dic.html"><a href="dic.html"><i class="fa fa-check"></i><b>3.8</b> DIC</a></li>
<li class="chapter" data-level="3.9" data-path="monte-carlo-integration.html"><a href="monte-carlo-integration.html"><i class="fa fa-check"></i><b>3.9</b> Monte Carlo Integration</a>
<ul>
<li class="chapter" data-level="3.9.1" data-path="monte-carlo-integration.html"><a href="monte-carlo-integration.html#inverse-sampling"><i class="fa fa-check"></i><b>3.9.1</b> Inverse Sampling</a></li>
<li class="chapter" data-level="3.9.2" data-path="monte-carlo-integration.html"><a href="monte-carlo-integration.html#rejection-sampling-1"><i class="fa fa-check"></i><b>3.9.2</b> Rejection Sampling</a></li>
<li class="chapter" data-level="3.9.3" data-path="monte-carlo-integration.html"><a href="monte-carlo-integration.html#importance-sampling"><i class="fa fa-check"></i><b>3.9.3</b> Importance Sampling</a></li>
</ul></li>
<li class="chapter" data-level="3.10" data-path="metropolis-hastings-1.html"><a href="metropolis-hastings-1.html"><i class="fa fa-check"></i><b>3.10</b> Metropolis-Hastings</a></li>
<li class="chapter" data-level="3.11" data-path="mixed-effects-linear-regression.html"><a href="mixed-effects-linear-regression.html"><i class="fa fa-check"></i><b>3.11</b> Mixed Effects Linear Regression</a></li>
<li class="chapter" data-level="3.12" data-path="appendix-bayes-factors.html"><a href="appendix-bayes-factors.html"><i class="fa fa-check"></i><b>3.12</b> Appendix: Bayes Factors</a></li>
<li class="chapter" data-level="3.13" data-path="further-reading-1.html"><a href="further-reading-1.html"><i class="fa fa-check"></i><b>3.13</b> Further Reading</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="one-sample.html"><a href="one-sample.html"><i class="fa fa-check"></i><b>4</b> One-Sample</a>
<ul>
<li class="chapter" data-level="4.1" data-path="one-sample-mean-z-test.html"><a href="one-sample-mean-z-test.html"><i class="fa fa-check"></i><b>4.1</b> One-Sample Mean z Test</a></li>
<li class="chapter" data-level="4.2" data-path="one-sample-mean-t-test.html"><a href="one-sample-mean-t-test.html"><i class="fa fa-check"></i><b>4.2</b> One-Sample Mean t Test</a></li>
<li class="chapter" data-level="4.3" data-path="one-sample-median-wilcoxon-test.html"><a href="one-sample-median-wilcoxon-test.html"><i class="fa fa-check"></i><b>4.3</b> One-Sample Median Wilcoxon Test</a></li>
<li class="chapter" data-level="4.4" data-path="chi-squared-goodness-of-fit-test.html"><a href="chi-squared-goodness-of-fit-test.html"><i class="fa fa-check"></i><b>4.4</b> Chi-Squared Goodness-of-Fit Test</a></li>
<li class="chapter" data-level="4.5" data-path="g-test.html"><a href="g-test.html"><i class="fa fa-check"></i><b>4.5</b> G-Test</a></li>
<li class="chapter" data-level="4.6" data-path="one-sample-poisson-test.html"><a href="one-sample-poisson-test.html"><i class="fa fa-check"></i><b>4.6</b> One-Sample Poisson Test</a></li>
<li class="chapter" data-level="4.7" data-path="exact-binomial-test.html"><a href="exact-binomial-test.html"><i class="fa fa-check"></i><b>4.7</b> Exact Binomial Test</a></li>
<li class="chapter" data-level="4.8" data-path="one-sample-proportion-z-test.html"><a href="one-sample-proportion-z-test.html"><i class="fa fa-check"></i><b>4.8</b> One-Sample Proportion z Test</a></li>
<li class="chapter" data-level="4.9" data-path="sample-t-test-for-categorical-var.html"><a href="sample-t-test-for-categorical-var.html"><i class="fa fa-check"></i><b>4.9</b> 1 sample t Test for Categorical Var</a></li>
<li class="chapter" data-level="4.10" data-path="wilcoxon-1-sample-median-test-for-categorical-var.html"><a href="wilcoxon-1-sample-median-test-for-categorical-var.html"><i class="fa fa-check"></i><b>4.10</b> Wilcoxon 1-Sample Median Test for Categorical Var</a></li>
<li class="chapter" data-level="4.11" data-path="multivariate-statistics.html"><a href="multivariate-statistics.html"><i class="fa fa-check"></i><b>4.11</b> Multivariate Statistics</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="group-differences.html"><a href="group-differences.html"><i class="fa fa-check"></i><b>5</b> Group Differences</a>
<ul>
<li class="chapter" data-level="5.1" data-path="ttest.html"><a href="ttest.html"><i class="fa fa-check"></i><b>5.1</b> Independent Samples t-Test</a></li>
<li class="chapter" data-level="5.2" data-path="wilcoxonranksum.html"><a href="wilcoxonranksum.html"><i class="fa fa-check"></i><b>5.2</b> Wilcoxon Rank Sum Test</a></li>
<li class="chapter" data-level="" data-path="case-study-1.html"><a href="case-study-1.html"><i class="fa fa-check"></i>Case Study 1</a></li>
<li class="chapter" data-level="5.3" data-path="pairedttest.html"><a href="pairedttest.html"><i class="fa fa-check"></i><b>5.3</b> Paired Samples t-Test</a></li>
<li class="chapter" data-level="5.4" data-path="wilcoxonsignedrank.html"><a href="wilcoxonsignedrank.html"><i class="fa fa-check"></i><b>5.4</b> Wilcoxon Signed-Rank Test</a>
<ul>
<li class="chapter" data-level="" data-path="wilcoxonsignedrank.html"><a href="wilcoxonsignedrank.html#sign-test"><i class="fa fa-check"></i>Sign Test</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="case-study-2.html"><a href="case-study-2.html"><i class="fa fa-check"></i>Case Study 2</a></li>
<li class="chapter" data-level="5.5" data-path="onewayanova.html"><a href="onewayanova.html"><i class="fa fa-check"></i><b>5.5</b> One-way ANOVA</a></li>
<li class="chapter" data-level="5.6" data-path="kw.html"><a href="kw.html"><i class="fa fa-check"></i><b>5.6</b> Kruskal–Wallis Test</a></li>
<li class="chapter" data-level="" data-path="groupdiffscs3.html"><a href="groupdiffscs3.html"><i class="fa fa-check"></i>Case Study 3</a>
<ul>
<li class="chapter" data-level="5.6.1" data-path="groupdiffscs3.html"><a href="groupdiffscs3.html#assumptions"><i class="fa fa-check"></i><b>5.6.1</b> Assumptions</a></li>
<li class="chapter" data-level="5.6.2" data-path="groupdiffscs3.html"><a href="groupdiffscs3.html#anova"><i class="fa fa-check"></i><b>5.6.2</b> ANOVA</a></li>
<li class="chapter" data-level="5.6.3" data-path="groupdiffscs3.html"><a href="groupdiffscs3.html#kruskal-wallis-test"><i class="fa fa-check"></i><b>5.6.3</b> Kruskal-Wallis Test</a></li>
</ul></li>
<li class="chapter" data-level="5.7" data-path="chisqhomogeneity.html"><a href="chisqhomogeneity.html"><i class="fa fa-check"></i><b>5.7</b> Chi-Square Test of Homogeneity</a></li>
<li class="chapter" data-level="5.8" data-path="fisherexact.html"><a href="fisherexact.html"><i class="fa fa-check"></i><b>5.8</b> Fisher’s Exact Test</a></li>
<li class="chapter" data-level="" data-path="case-study-4.html"><a href="case-study-4.html"><i class="fa fa-check"></i>Case Study 4</a></li>
<li class="chapter" data-level="5.9" data-path="pairwiseproptest.html"><a href="pairwiseproptest.html"><i class="fa fa-check"></i><b>5.9</b> Pairwise Prop Test</a></li>
<li class="chapter" data-level="5.10" data-path="mcnemar.html"><a href="mcnemar.html"><i class="fa fa-check"></i><b>5.10</b> McNemar’s Test</a>
<ul>
<li class="chapter" data-level="5.10.1" data-path="mcnemar.html"><a href="mcnemar.html#manova"><i class="fa fa-check"></i><b>5.10.1</b> MANOVA</a></li>
<li class="chapter" data-level="5.10.2" data-path="mcnemar.html"><a href="mcnemar.html#multiple-variance-comparison-f-test"><i class="fa fa-check"></i><b>5.10.2</b> Multiple Variance Comparison F Test</a></li>
<li class="chapter" data-level="5.10.3" data-path="mcnemar.html"><a href="mcnemar.html#example-5"><i class="fa fa-check"></i><b>5.10.3</b> Example</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="6" data-path="association.html"><a href="association.html"><i class="fa fa-check"></i><b>6</b> Association</a>
<ul>
<li class="chapter" data-level="6.1" data-path="pearson.html"><a href="pearson.html"><i class="fa fa-check"></i><b>6.1</b> Pearson’s Correlation</a></li>
<li class="chapter" data-level="6.2" data-path="spearman.html"><a href="spearman.html"><i class="fa fa-check"></i><b>6.2</b> Spearman’s Rho</a></li>
<li class="chapter" data-level="6.3" data-path="kendall.html"><a href="kendall.html"><i class="fa fa-check"></i><b>6.3</b> Kendal’s Tau</a></li>
<li class="chapter" data-level="6.4" data-path="case-study-pearson-spearman-kendall.html"><a href="case-study-pearson-spearman-kendall.html"><i class="fa fa-check"></i><b>6.4</b> Case Study: Pearson, Spearman, Kendall</a></li>
<li class="chapter" data-level="6.5" data-path="chisq-independence.html"><a href="chisq-independence.html"><i class="fa fa-check"></i><b>6.5</b> Chi-Square Test of Independence</a></li>
<li class="chapter" data-level="6.6" data-path="fisher-exact.html"><a href="fisher-exact.html"><i class="fa fa-check"></i><b>6.6</b> Fisher’s Exact Test</a></li>
<li class="chapter" data-level="6.7" data-path="case-study-chi-square-fisher.html"><a href="case-study-chi-square-fisher.html"><i class="fa fa-check"></i><b>6.7</b> Case Study: Chi-Square, Fisher</a></li>
<li class="chapter" data-level="6.8" data-path="kruskals-lambda.html"><a href="kruskals-lambda.html"><i class="fa fa-check"></i><b>6.8</b> Kruskal’s Lambda</a></li>
<li class="chapter" data-level="6.9" data-path="relative-risk.html"><a href="relative-risk.html"><i class="fa fa-check"></i><b>6.9</b> Relative Risk</a></li>
<li class="chapter" data-level="6.10" data-path="odds-ratio.html"><a href="odds-ratio.html"><i class="fa fa-check"></i><b>6.10</b> Odds Ratio</a></li>
<li class="chapter" data-level="6.11" data-path="partial-correlation.html"><a href="partial-correlation.html"><i class="fa fa-check"></i><b>6.11</b> Partial Correlation</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="matrix-algebra.html"><a href="matrix-algebra.html"><i class="fa fa-check"></i><b>7</b> Matrix Algebra</a>
<ul>
<li class="chapter" data-level="7.1" data-path="central-tendancy-dispersion-and-association.html"><a href="central-tendancy-dispersion-and-association.html"><i class="fa fa-check"></i><b>7.1</b> Central Tendancy, Dispersion, and Association</a></li>
<li class="chapter" data-level="7.2" data-path="linear-transformations.html"><a href="linear-transformations.html"><i class="fa fa-check"></i><b>7.2</b> Linear Transformations</a></li>
<li class="chapter" data-level="7.3" data-path="multivariate-normal-distribution.html"><a href="multivariate-normal-distribution.html"><i class="fa fa-check"></i><b>7.3</b> Multivariate Normal Distribution</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Statistical Inference</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="gamma-poisson-and-estimating-counts" class="section level2 hasAnchor" number="3.4">
<h2><span class="header-section-number">3.4</span> Gamma Poisson and Estimating Counts<a href="gamma-poisson-and-estimating-counts.html#gamma-poisson-and-estimating-counts" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>The gamma and Poisson distributions are used to model count data. Consider the following counts of weekday sandwich sales. What is the expected value of sales?</p>
<div class="sourceCode" id="cb37"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb37-1"><a href="gamma-poisson-and-estimating-counts.html#cb37-1" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">50</span>, <span class="dv">65</span>, <span class="dv">72</span>, <span class="dv">63</span>, <span class="dv">70</span>)</span></code></pre></div>
<p>Count data have a Poisson distribution, <span class="math inline">\(y_i|\lambda \sim Pois(\lambda)\)</span>, with expected value <span class="math inline">\(\lambda\)</span> and PMF <span class="math inline">\(f(y_i | \lambda) = e^{-\lambda}\frac{\lambda^{y_i}}{y_i!}\)</span>. Using Bayes’ Theorem, the posterior distribution of <span class="math inline">\(\lambda\)</span> given evidence <span class="math inline">\(\textbf{y}\)</span> is the joint likelihood of <span class="math inline">\(\lambda\)</span> and <span class="math inline">\(\textbf{y}\)</span> divided by the likelihood of <span class="math inline">\(\textbf{y}\)</span>.</p>
<p><span class="math display">\[
f(\lambda |\textbf{y}) = \frac{f(\mathbf{y}|\lambda) f(\lambda)}{\int_\Lambda f(\mathbf{y}|\lambda) f(\lambda) d\lambda}
\]</span></p>
<p>The conditional likelihood, <span class="math inline">\(f(\textbf{y}|\lambda)\)</span>, is the sum-product of the Poisson distribution PMF.</p>
<p><span class="math display">\[
\begin{align}
f(\textbf{y}|\lambda) = f(y_i,\ldots, y_n | \lambda) &amp;= \prod_i f(y_i | \lambda) \\
&amp;= \prod_i e^{-\lambda}\frac{\lambda^{y_i}}{y_i!}
\end{align}
\]</span></p>
<p>The prior distribution, <span class="math inline">\(f(\lambda)\)</span>, should take on only positive values. Model it with the <a href="https://mpfoley73.github.io/probability/random-variables-and-distributions.html#gamma">gamma distribution</a>, <span class="math inline">\(\lambda|a,b = \mathrm{Gamma}(a,b)\)</span>.</p>
<p><span class="math display">\[
f(\lambda) = f(\lambda | a,b) = \frac{b^a \lambda^{a-1} e^{-b\lambda}}{\Gamma(a)}
\]</span></p>
<p>where <span class="math inline">\(\Gamma\)</span> is the gamma function<a href="#fn3" class="footnote-ref" id="fnref3"><sup>3</sup></a>. Substituting into Bayes’ Theorem and simplifying, you have this nightmare:</p>
<p><span class="math display">\[
f(\lambda |\textbf{y}) = \frac{\lambda^{a + \sum_i y_i-1}e^{-(b+n)\lambda}}{\int_0^\infty \lambda^{a + \sum_i y_i-1}e^{-(b+n)\lambda} d\lambda}
\]</span></p>
<p>However, there is good news. The integration in the denominator removes the dependence on <span class="math inline">\(\lambda\)</span>, so <span class="math inline">\(f(\lambda |\textbf{y}, a, b)\)</span> is proportional to the numerator up to a constant.</p>
<p><span class="math display">\[
f(\lambda |\textbf{y}) \propto f(\textbf{y} | \lambda) f(\lambda)
\]</span></p>
<p>Since <span class="math inline">\(f(\lambda |\textbf{y})\)</span> is a PMF, it integrates (sums) to 1 and you can always figure out the constant later. What makes this good news is that this has the form of the PDF of the gamma distribution.</p>
<p><span class="math display" id="eq:gamma-posterior">\[
\begin{equation}
\lambda | \textbf{y}, a, b \sim \mathrm{Gamma}(a + \sum_i y_i, b + n)
\tag{3.1}
\end{equation}
\]</span></p>
<p>Equation <a href="gamma-poisson-and-estimating-counts.html#eq:gamma-posterior">(3.1)</a> is the posterior distribution of <span class="math inline">\(\lambda\)</span>. We combined a gamma prior with the Poisson likelihood of evidence, <span class="math inline">\(\textbf{y}\)</span>, to produce a gamma posterior. We call priors that produce posteriors of the same form, <em>conjugate priors</em> for the likelihood. Conjugate priors are popular because of their computational convenience.</p>
<p>Return to the sandwich sales data. We need values to plug into Equation <a href="gamma-poisson-and-estimating-counts.html#eq:gamma-posterior">(3.1)</a>. For the gamma distribution, <span class="math inline">\(E(X) = a / b\)</span> and <span class="math inline">\(\mathrm{Var}(X) = a / b^2\)</span>. You might guess from intuition that mean daily sandwich sales are 70 +/- 5. Interpreting +/- 5 as a 95% CI and using the rule of thumb that a 95% CI is 2 SD, <span class="math inline">\(\mathrm{Var} = (2.5)^2 = 6.25\)</span>. Solve for <span class="math inline">\(a = 784\)</span> and <span class="math inline">\(b = 11.2\)</span>. We also have <span class="math inline">\(\sum_i y_i = 320\)</span> and <span class="math inline">\(n = 5\)</span>.</p>
<p><span class="math display">\[
\lambda | \textbf{y}, a, b \sim \mathrm{Gamma}(784 + 320, 11.2 + 5) \sim \mathrm{Gamma}(1104, 16.2)
\]</span></p>
<p>The posterior <span class="math inline">\(E(y) = 1104 / 16.2 = 68.1\)</span> and <span class="math inline">\(\mathrm{Var}(y) = 1104 / 16.2^2 = 4.2\)</span>. Use the gamma distribution function to get the posterior 95% <em>credible</em> interval.</p>
<div class="sourceCode" id="cb38"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb38-1"><a href="gamma-poisson-and-estimating-counts.html#cb38-1" tabindex="-1"></a><span class="co"># Prior distribution</span></span>
<span id="cb38-2"><a href="gamma-poisson-and-estimating-counts.html#cb38-2" tabindex="-1"></a><span class="fu">qgamma</span>(<span class="at">p =</span> <span class="fu">c</span>(.<span class="dv">025</span>, .<span class="dv">975</span>), <span class="dv">784</span>, <span class="fl">11.2</span>)</span>
<span id="cb38-3"><a href="gamma-poisson-and-estimating-counts.html#cb38-3" tabindex="-1"></a><span class="do">## [1] 65.18520 74.98392</span></span>
<span id="cb38-4"><a href="gamma-poisson-and-estimating-counts.html#cb38-4" tabindex="-1"></a></span>
<span id="cb38-5"><a href="gamma-poisson-and-estimating-counts.html#cb38-5" tabindex="-1"></a><span class="co"># Posterior distribution</span></span>
<span id="cb38-6"><a href="gamma-poisson-and-estimating-counts.html#cb38-6" tabindex="-1"></a><span class="fu">qgamma</span>(<span class="at">p =</span> <span class="fu">c</span>(.<span class="dv">025</span>, .<span class="dv">975</span>), <span class="dv">784</span> <span class="sc">+</span> <span class="dv">320</span>, <span class="fl">11.2</span> <span class="sc">+</span> <span class="dv">5</span>)</span>
<span id="cb38-7"><a href="gamma-poisson-and-estimating-counts.html#cb38-7" tabindex="-1"></a><span class="do">## [1] 64.18701 72.22621</span></span></code></pre></div>
<p>Whereas the prior expected mean daily sandwich sales was 70 (95% CI: 65, 75), the posterior is 68 (95% CI: 64, 72). Compare this to classical statistics: <span class="math inline">\(E(y) = \bar{y} = 64\)</span>, <span class="math inline">\(SE = \sqrt{\bar{y} / n} = 3.6\)</span>:</p>
<div class="sourceCode" id="cb39"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb39-1"><a href="gamma-poisson-and-estimating-counts.html#cb39-1" tabindex="-1"></a><span class="co"># Classical estimate</span></span>
<span id="cb39-2"><a href="gamma-poisson-and-estimating-counts.html#cb39-2" tabindex="-1"></a><span class="fu">qnorm</span>(<span class="at">p =</span> <span class="fu">c</span>(.<span class="dv">025</span>, .<span class="dv">975</span>), <span class="dv">64</span>, <span class="fl">3.6</span>)</span>
<span id="cb39-3"><a href="gamma-poisson-and-estimating-counts.html#cb39-3" tabindex="-1"></a><span class="do">## [1] 56.94413 71.05587</span></span></code></pre></div>
<p>You might think that the reasonable Bayesian outcome was predicated on good <span class="math inline">\(a\)</span> and <span class="math inline">\(b\)</span> priors, but no. Suppose <span class="math inline">\(a = .01\)</span> and <span class="math inline">\(b = .01\)</span>. The posterior is still reasonable.</p>
<div class="sourceCode" id="cb40"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb40-1"><a href="gamma-poisson-and-estimating-counts.html#cb40-1" tabindex="-1"></a><span class="co"># Informal prior</span></span>
<span id="cb40-2"><a href="gamma-poisson-and-estimating-counts.html#cb40-2" tabindex="-1"></a><span class="fu">qgamma</span>(<span class="at">p =</span> <span class="fu">c</span>(.<span class="dv">025</span>, .<span class="dv">975</span>), .<span class="dv">01</span> <span class="sc">+</span> <span class="dv">320</span>, .<span class="dv">01</span> <span class="sc">+</span> <span class="dv">5</span>)</span>
<span id="cb40-3"><a href="gamma-poisson-and-estimating-counts.html#cb40-3" tabindex="-1"></a><span class="do">## [1] 57.06689 71.05964</span></span></code></pre></div>
<div class="sourceCode" id="cb41"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb41-1"><a href="gamma-poisson-and-estimating-counts.html#cb41-1" tabindex="-1"></a><span class="fu">tibble</span>(</span>
<span id="cb41-2"><a href="gamma-poisson-and-estimating-counts.html#cb41-2" tabindex="-1"></a>  <span class="at">lambda =</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">80</span>, .<span class="dv">1</span>),</span>
<span id="cb41-3"><a href="gamma-poisson-and-estimating-counts.html#cb41-3" tabindex="-1"></a>  <span class="st">`</span><span class="at">Gamma(.01, .01)</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">dgamma</span>(lambda, .<span class="dv">01</span>, .<span class="dv">01</span>),</span>
<span id="cb41-4"><a href="gamma-poisson-and-estimating-counts.html#cb41-4" tabindex="-1"></a>  <span class="st">`</span><span class="at">Gamma(.01 + 320, .01 + 5)</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">dgamma</span>(lambda, .<span class="dv">01</span> <span class="sc">+</span> <span class="dv">320</span>, .<span class="dv">01</span> <span class="sc">+</span> <span class="dv">5</span>),</span>
<span id="cb41-5"><a href="gamma-poisson-and-estimating-counts.html#cb41-5" tabindex="-1"></a>  <span class="st">`</span><span class="at">Gamma(784, 11.2)</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">dgamma</span>(lambda, <span class="dv">784</span>, <span class="fl">11.2</span>),</span>
<span id="cb41-6"><a href="gamma-poisson-and-estimating-counts.html#cb41-6" tabindex="-1"></a>  <span class="st">`</span><span class="at">Gamma(784 + 320, 11.2 + 5)</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">dgamma</span>(lambda, <span class="dv">784</span> <span class="sc">+</span> <span class="dv">320</span>, <span class="fl">11.2</span> <span class="sc">+</span> <span class="dv">5</span>)</span>
<span id="cb41-7"><a href="gamma-poisson-and-estimating-counts.html#cb41-7" tabindex="-1"></a>) <span class="sc">%&gt;%</span></span>
<span id="cb41-8"><a href="gamma-poisson-and-estimating-counts.html#cb41-8" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="sc">-</span>lambda) <span class="sc">%&gt;%</span></span>
<span id="cb41-9"><a href="gamma-poisson-and-estimating-counts.html#cb41-9" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">name =</span> <span class="fu">fct_inorder</span>(name)) <span class="sc">%&gt;%</span></span>
<span id="cb41-10"><a href="gamma-poisson-and-estimating-counts.html#cb41-10" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">prior =</span> <span class="fu">if_else</span>(<span class="fu">str_detect</span>(name, <span class="st">&quot;</span><span class="sc">\\</span><span class="st">+&quot;</span>), <span class="st">&quot;posterior&quot;</span>, <span class="st">&quot;prior&quot;</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb41-11"><a href="gamma-poisson-and-estimating-counts.html#cb41-11" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> lambda, <span class="at">y =</span> value, <span class="at">color =</span> name, <span class="at">linetype =</span> prior)) <span class="sc">+</span></span>
<span id="cb41-12"><a href="gamma-poisson-and-estimating-counts.html#cb41-12" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">linewidth =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb41-13"><a href="gamma-poisson-and-estimating-counts.html#cb41-13" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="fu">rep</span>(<span class="st">&quot;seagreen&quot;</span>, <span class="dv">2</span>), <span class="fu">rep</span>(<span class="st">&quot;firebrick&quot;</span>, <span class="dv">2</span>))) <span class="sc">+</span></span>
<span id="cb41-14"><a href="gamma-poisson-and-estimating-counts.html#cb41-14" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">color =</span> <span class="cn">NULL</span>, <span class="at">linetype =</span> <span class="cn">NULL</span>, <span class="at">y =</span> <span class="st">&quot;density&quot;</span>,</span>
<span id="cb41-15"><a href="gamma-poisson-and-estimating-counts.html#cb41-15" tabindex="-1"></a>       <span class="at">title =</span> <span class="st">&quot;Posteriors from Conservative and Informed Priors.&quot;</span>)</span></code></pre></div>
<p><img src="statistics_files/figure-html/unnamed-chunk-25-1.png" width="672" /></p>
<p>The Bayesian posterior approaches the classical <span class="math inline">\(\bar{y}\)</span> with increasing sample size.</p>
<p><span class="math display">\[
E(\lambda|\textbf{y}, a, b) = \frac{a + \sum_i y_i}{b + n} = \frac{a + n \bar{y}}{b + n}
\]</span></p>
<p>Taking the limit, <span class="math inline">\(\lim_{n \rightarrow \infty} E(\lambda|\textbf{y}, a, b) = \bar{y}\)</span>.</p>
<p>The <em>central</em> credible interval is the standard Bayesian credible interval. But when the posterior distribution is not perfectly symmetric, the shortest credible interval capturing x% of the distribution might have different endpoints. Our example has a pretty symmetric distribution, but let’s calculate the <em>highest density region (HDR)</em> anyway.</p>
<div class="sourceCode" id="cb42"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb42-1"><a href="gamma-poisson-and-estimating-counts.html#cb42-1" tabindex="-1"></a>pp <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="fl">0.01</span>, .<span class="dv">99</span>, <span class="at">by =</span> .<span class="dv">0001</span>)</span>
<span id="cb42-2"><a href="gamma-poisson-and-estimating-counts.html#cb42-2" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">map_dbl</span>(pp, <span class="sc">~</span><span class="fu">qgamma</span>(., <span class="dv">784</span> <span class="sc">+</span> <span class="dv">320</span>, <span class="fl">11.2</span> <span class="sc">+</span> <span class="dv">5</span>))</span>
<span id="cb42-3"><a href="gamma-poisson-and-estimating-counts.html#cb42-3" tabindex="-1"></a>hdrcde<span class="sc">::</span><span class="fu">hdr</span>(x, <span class="at">prob =</span> <span class="dv">95</span>)<span class="sc">$</span>hdr</span>
<span id="cb42-4"><a href="gamma-poisson-and-estimating-counts.html#cb42-4" tabindex="-1"></a><span class="do">##         [,1]     [,2]</span></span>
<span id="cb42-5"><a href="gamma-poisson-and-estimating-counts.html#cb42-5" tabindex="-1"></a><span class="do">## 95% 64.40786 71.86588</span></span></code></pre></div>
<p>The posterior predictive distribution of a predicted value, <span class="math inline">\(\tilde{y}\)</span> is</p>
<p><span class="math display">\[
f(\tilde{y} | x) = \int f(\tilde{y}|\lambda) f(\lambda | \textbf{y}) d\lambda
\]</span></p>
<p>Our sandwich example has a well defined functional solution: the expected value from <span class="math inline">\(\mathrm{Gamma}(1104, 16.2)\)</span> is <span class="math inline">\(1104/16.2 = 68\)</span>. Had we not known this, we could have simulated posterior values (Monte Carlo simulation) and calculated the mean and variance. The procedure is to take a random sample of perhaps 1,000 <span class="math inline">\(\lambda\)</span> values from the gamma posterior distribution, then for each <span class="math inline">\(\lambda\)</span> draw a single random <span class="math inline">\(\tilde{y}\)</span> from the Poisson distribution.</p>
<div class="sourceCode" id="cb43"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb43-1"><a href="gamma-poisson-and-estimating-counts.html#cb43-1" tabindex="-1"></a>a <span class="ot">&lt;-</span> <span class="dv">1104</span> </span>
<span id="cb43-2"><a href="gamma-poisson-and-estimating-counts.html#cb43-2" tabindex="-1"></a>b <span class="ot">&lt;-</span> <span class="fl">16.2</span> </span>
<span id="cb43-3"><a href="gamma-poisson-and-estimating-counts.html#cb43-3" tabindex="-1"></a></span>
<span id="cb43-4"><a href="gamma-poisson-and-estimating-counts.html#cb43-4" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1234</span>)</span>
<span id="cb43-5"><a href="gamma-poisson-and-estimating-counts.html#cb43-5" tabindex="-1"></a></span>
<span id="cb43-6"><a href="gamma-poisson-and-estimating-counts.html#cb43-6" tabindex="-1"></a><span class="co"># random sample of lambdas, and a single random y_tilde for each lambda</span></span>
<span id="cb43-7"><a href="gamma-poisson-and-estimating-counts.html#cb43-7" tabindex="-1"></a>lambda_r <span class="ot">&lt;-</span> <span class="fu">rgamma</span>(<span class="dv">1000</span>, a, b)</span>
<span id="cb43-8"><a href="gamma-poisson-and-estimating-counts.html#cb43-8" tabindex="-1"></a>y_tilde <span class="ot">&lt;-</span> <span class="fu">rpois</span>(<span class="dv">1000</span>, lambda_r)</span>
<span id="cb43-9"><a href="gamma-poisson-and-estimating-counts.html#cb43-9" tabindex="-1"></a></span>
<span id="cb43-10"><a href="gamma-poisson-and-estimating-counts.html#cb43-10" tabindex="-1"></a><span class="co"># posterior predictive distribution</span></span>
<span id="cb43-11"><a href="gamma-poisson-and-estimating-counts.html#cb43-11" tabindex="-1"></a><span class="fu">mean</span>(y_tilde)</span>
<span id="cb43-12"><a href="gamma-poisson-and-estimating-counts.html#cb43-12" tabindex="-1"></a><span class="do">## [1] 68.252</span></span>
<span id="cb43-13"><a href="gamma-poisson-and-estimating-counts.html#cb43-13" tabindex="-1"></a><span class="fu">quantile</span>(y_tilde, <span class="fu">c</span>(.<span class="dv">025</span>, .<span class="dv">975</span>))</span>
<span id="cb43-14"><a href="gamma-poisson-and-estimating-counts.html#cb43-14" tabindex="-1"></a><span class="do">##   2.5%  97.5% </span></span>
<span id="cb43-15"><a href="gamma-poisson-and-estimating-counts.html#cb43-15" tabindex="-1"></a><span class="do">## 50.975 85.000</span></span></code></pre></div>
<p>So on any given day, the predicted value of sandwich sales is 68.3 with 95% prediction interval 51.0, 85.0. The probability of exceeding 80 sandwiches, <span class="math inline">\(P(\tilde{y} &gt; 80 | \textbf{y})\)</span>, is <code>mean(y_tilde &gt; 80)</code> = 8.3%, and 99% of the time, sandwich sales will be less than <code>quantile(y_tilde, .99)</code> = 89.</p>
<p>You can also predict individual weekdays. Suppose you take a <span class="math inline">\(\mathrm{Gamma}(700, 10)\)</span> distribution as your prior.</p>
<div class="sourceCode" id="cb44"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb44-1"><a href="gamma-poisson-and-estimating-counts.html#cb44-1" tabindex="-1"></a>day_tbl <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb44-2"><a href="gamma-poisson-and-estimating-counts.html#cb44-2" tabindex="-1"></a>  <span class="at">dow =</span> <span class="fu">fct_inorder</span>(<span class="fu">c</span>(<span class="st">&quot;Mon&quot;</span>, <span class="st">&quot;Tue&quot;</span>, <span class="st">&quot;Wed&quot;</span>, <span class="st">&quot;Thu&quot;</span>, <span class="st">&quot;Fri&quot;</span>)),</span>
<span id="cb44-3"><a href="gamma-poisson-and-estimating-counts.html#cb44-3" tabindex="-1"></a>  <span class="at">d =</span> <span class="fu">c</span>(<span class="dv">50</span>, <span class="dv">65</span>, <span class="dv">72</span>, <span class="dv">63</span>, <span class="dv">70</span>)</span>
<span id="cb44-4"><a href="gamma-poisson-and-estimating-counts.html#cb44-4" tabindex="-1"></a>) <span class="sc">%&gt;%</span></span>
<span id="cb44-5"><a href="gamma-poisson-and-estimating-counts.html#cb44-5" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb44-6"><a href="gamma-poisson-and-estimating-counts.html#cb44-6" tabindex="-1"></a>    <span class="at">post_a =</span> <span class="dv">700</span> <span class="sc">+</span> d,</span>
<span id="cb44-7"><a href="gamma-poisson-and-estimating-counts.html#cb44-7" tabindex="-1"></a>    <span class="at">post_b =</span> <span class="dv">10</span> <span class="sc">+</span> <span class="dv">1</span>,</span>
<span id="cb44-8"><a href="gamma-poisson-and-estimating-counts.html#cb44-8" tabindex="-1"></a>    <span class="at">post_mean =</span> post_a <span class="sc">/</span> post_b,</span>
<span id="cb44-9"><a href="gamma-poisson-and-estimating-counts.html#cb44-9" tabindex="-1"></a>    <span class="at">post_lci =</span> <span class="fu">qgamma</span>(.<span class="dv">025</span>, post_a, post_b),</span>
<span id="cb44-10"><a href="gamma-poisson-and-estimating-counts.html#cb44-10" tabindex="-1"></a>    <span class="at">post_uci =</span> <span class="fu">qgamma</span>(.<span class="dv">975</span>, post_a, post_b)</span>
<span id="cb44-11"><a href="gamma-poisson-and-estimating-counts.html#cb44-11" tabindex="-1"></a>  )</span>
<span id="cb44-12"><a href="gamma-poisson-and-estimating-counts.html#cb44-12" tabindex="-1"></a></span>
<span id="cb44-13"><a href="gamma-poisson-and-estimating-counts.html#cb44-13" tabindex="-1"></a>day_tbl</span></code></pre></div>
<pre><code>## # A tibble: 5 × 7
##   dow       d post_a post_b post_mean post_lci post_uci
##   &lt;fct&gt; &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;     &lt;dbl&gt;    &lt;dbl&gt;    &lt;dbl&gt;
## 1 Mon      50    750     11      68.2     63.4     73.1
## 2 Tue      65    765     11      69.5     64.7     74.6
## 3 Wed      72    772     11      70.2     65.3     75.2
## 4 Thu      63    763     11      69.4     64.5     74.4
## 5 Fri      70    770     11      70       65.1     75.0</code></pre>
<p>What is the probability that Mon sales are less than Tue?</p>
<div class="sourceCode" id="cb46"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb46-1"><a href="gamma-poisson-and-estimating-counts.html#cb46-1" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb46-2"><a href="gamma-poisson-and-estimating-counts.html#cb46-2" tabindex="-1"></a>lambda_r_mon <span class="ot">&lt;-</span> <span class="fu">rgamma</span>(<span class="dv">1000</span>, <span class="dv">750</span>, <span class="dv">11</span>)</span>
<span id="cb46-3"><a href="gamma-poisson-and-estimating-counts.html#cb46-3" tabindex="-1"></a>lambda_r_tue <span class="ot">&lt;-</span> <span class="fu">rgamma</span>(<span class="dv">1000</span>, <span class="dv">765</span>, <span class="dv">11</span>)</span>
<span id="cb46-4"><a href="gamma-poisson-and-estimating-counts.html#cb46-4" tabindex="-1"></a></span>
<span id="cb46-5"><a href="gamma-poisson-and-estimating-counts.html#cb46-5" tabindex="-1"></a><span class="co"># posterior probability </span></span>
<span id="cb46-6"><a href="gamma-poisson-and-estimating-counts.html#cb46-6" tabindex="-1"></a><span class="fu">mean</span>(lambda_r_mon <span class="sc">&lt;</span> lambda_r_tue)</span>
<span id="cb46-7"><a href="gamma-poisson-and-estimating-counts.html#cb46-7" tabindex="-1"></a><span class="do">## [1] 0.664</span></span></code></pre></div>
<p>Which day of the week has the highest sandwich sales?</p>
<div class="sourceCode" id="cb47"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb47-1"><a href="gamma-poisson-and-estimating-counts.html#cb47-1" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">12345</span>)</span>
<span id="cb47-2"><a href="gamma-poisson-and-estimating-counts.html#cb47-2" tabindex="-1"></a></span>
<span id="cb47-3"><a href="gamma-poisson-and-estimating-counts.html#cb47-3" tabindex="-1"></a>lambda_r <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb47-4"><a href="gamma-poisson-and-estimating-counts.html#cb47-4" tabindex="-1"></a>  <span class="at">r_mon =</span> <span class="fu">rgamma</span>(<span class="dv">1000</span>, <span class="dv">750</span>, <span class="dv">11</span>),</span>
<span id="cb47-5"><a href="gamma-poisson-and-estimating-counts.html#cb47-5" tabindex="-1"></a>  <span class="at">r_tue =</span> <span class="fu">rgamma</span>(<span class="dv">1000</span>, <span class="dv">765</span>, <span class="dv">11</span>),</span>
<span id="cb47-6"><a href="gamma-poisson-and-estimating-counts.html#cb47-6" tabindex="-1"></a>  <span class="at">r_wed =</span> <span class="fu">rgamma</span>(<span class="dv">1000</span>, <span class="dv">772</span>, <span class="dv">11</span>),</span>
<span id="cb47-7"><a href="gamma-poisson-and-estimating-counts.html#cb47-7" tabindex="-1"></a>  <span class="at">r_thu =</span> <span class="fu">rgamma</span>(<span class="dv">1000</span>, <span class="dv">763</span>, <span class="dv">11</span>),</span>
<span id="cb47-8"><a href="gamma-poisson-and-estimating-counts.html#cb47-8" tabindex="-1"></a>  <span class="at">r_fri =</span> <span class="fu">rgamma</span>(<span class="dv">1000</span>, <span class="dv">770</span>, <span class="dv">11</span>),</span>
<span id="cb47-9"><a href="gamma-poisson-and-estimating-counts.html#cb47-9" tabindex="-1"></a>  <span class="at">r_dow =</span> <span class="fu">pmap</span>(<span class="fu">list</span>(r_mon, r_tue, r_wed, r_thu, r_fri), </span>
<span id="cb47-10"><a href="gamma-poisson-and-estimating-counts.html#cb47-10" tabindex="-1"></a>                   <span class="cf">function</span>(m, t, w, r, f) <span class="fu">c</span>(m, t, w, r, f)),</span>
<span id="cb47-11"><a href="gamma-poisson-and-estimating-counts.html#cb47-11" tabindex="-1"></a>  <span class="at">max_dow_idx =</span> <span class="fu">map_dbl</span>(r_dow, <span class="sc">~</span><span class="fu">which.max</span>(.)),</span>
<span id="cb47-12"><a href="gamma-poisson-and-estimating-counts.html#cb47-12" tabindex="-1"></a>  <span class="at">max_dow =</span> <span class="fu">map_chr</span>(max_dow_idx, <span class="sc">~</span><span class="fu">c</span>(<span class="st">&quot;Mon&quot;</span>, <span class="st">&quot;Tue&quot;</span>, <span class="st">&quot;Wed&quot;</span>, <span class="st">&quot;Thu&quot;</span>, <span class="st">&quot;Fri&quot;</span>)[.])</span>
<span id="cb47-13"><a href="gamma-poisson-and-estimating-counts.html#cb47-13" tabindex="-1"></a>)</span>
<span id="cb47-14"><a href="gamma-poisson-and-estimating-counts.html#cb47-14" tabindex="-1"></a></span>
<span id="cb47-15"><a href="gamma-poisson-and-estimating-counts.html#cb47-15" tabindex="-1"></a>lambda_r <span class="sc">%&gt;%</span> janitor<span class="sc">::</span><span class="fu">tabyl</span>(max_dow)</span>
<span id="cb47-16"><a href="gamma-poisson-and-estimating-counts.html#cb47-16" tabindex="-1"></a><span class="do">##  max_dow   n percent</span></span>
<span id="cb47-17"><a href="gamma-poisson-and-estimating-counts.html#cb47-17" tabindex="-1"></a><span class="do">##      Fri 248   0.248</span></span>
<span id="cb47-18"><a href="gamma-poisson-and-estimating-counts.html#cb47-18" tabindex="-1"></a><span class="do">##      Mon  77   0.077</span></span>
<span id="cb47-19"><a href="gamma-poisson-and-estimating-counts.html#cb47-19" tabindex="-1"></a><span class="do">##      Thu 188   0.188</span></span>
<span id="cb47-20"><a href="gamma-poisson-and-estimating-counts.html#cb47-20" tabindex="-1"></a><span class="do">##      Tue 190   0.190</span></span>
<span id="cb47-21"><a href="gamma-poisson-and-estimating-counts.html#cb47-21" tabindex="-1"></a><span class="do">##      Wed 297   0.297</span></span></code></pre></div>
<p>Use the Deviance Information Criterion (DIC) to evaluate whether the day means differ from each other.</p>
<p><span class="math display">\[
DIC = p_D + \overline{D(\theta)}
\]</span></p>
<p>where <span class="math inline">\(p_D = \overline{D(\theta)} - D(\hat{\theta})\)</span> and <span class="math inline">\(D(\theta) = -2 \log (f(y|\theta)) + C\)</span>.</p>
<p>Evaluate <span class="math inline">\(\overline{D(\theta)}\)</span> by producing samples from each distribution and evaluating the likelihoods of the data based on each realization and taking the mean of -2 log-likelihood.</p>
<div class="sourceCode" id="cb48"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb48-1"><a href="gamma-poisson-and-estimating-counts.html#cb48-1" tabindex="-1"></a><span class="co"># Reset the example. Sandwich counts by dow.</span></span>
<span id="cb48-2"><a href="gamma-poisson-and-estimating-counts.html#cb48-2" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">50</span>, <span class="dv">65</span>, <span class="dv">72</span>, <span class="dv">63</span>, <span class="dv">70</span>)</span>
<span id="cb48-3"><a href="gamma-poisson-and-estimating-counts.html#cb48-3" tabindex="-1"></a></span>
<span id="cb48-4"><a href="gamma-poisson-and-estimating-counts.html#cb48-4" tabindex="-1"></a><span class="co"># Priors</span></span>
<span id="cb48-5"><a href="gamma-poisson-and-estimating-counts.html#cb48-5" tabindex="-1"></a>a <span class="ot">&lt;-</span> .<span class="dv">01</span></span>
<span id="cb48-6"><a href="gamma-poisson-and-estimating-counts.html#cb48-6" tabindex="-1"></a>b <span class="ot">&lt;-</span> .<span class="dv">01</span></span>
<span id="cb48-7"><a href="gamma-poisson-and-estimating-counts.html#cb48-7" tabindex="-1"></a></span>
<span id="cb48-8"><a href="gamma-poisson-and-estimating-counts.html#cb48-8" tabindex="-1"></a><span class="co"># Posteriors</span></span>
<span id="cb48-9"><a href="gamma-poisson-and-estimating-counts.html#cb48-9" tabindex="-1"></a>post <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb48-10"><a href="gamma-poisson-and-estimating-counts.html#cb48-10" tabindex="-1"></a>  <span class="fu">rgamma</span>(<span class="dv">10</span><span class="sc">^</span><span class="dv">3</span>, a<span class="sc">+</span>y[<span class="dv">1</span>], b<span class="sc">+</span><span class="fu">length</span>(y[<span class="dv">1</span>])),</span>
<span id="cb48-11"><a href="gamma-poisson-and-estimating-counts.html#cb48-11" tabindex="-1"></a>  <span class="fu">rgamma</span>(<span class="dv">10</span><span class="sc">^</span><span class="dv">3</span>, a<span class="sc">+</span>y[<span class="dv">2</span>], b<span class="sc">+</span><span class="fu">length</span>(y[<span class="dv">2</span>])),</span>
<span id="cb48-12"><a href="gamma-poisson-and-estimating-counts.html#cb48-12" tabindex="-1"></a>  <span class="fu">rgamma</span>(<span class="dv">10</span><span class="sc">^</span><span class="dv">3</span>, a<span class="sc">+</span>y[<span class="dv">3</span>], b<span class="sc">+</span><span class="fu">length</span>(y[<span class="dv">3</span>])),</span>
<span id="cb48-13"><a href="gamma-poisson-and-estimating-counts.html#cb48-13" tabindex="-1"></a>  <span class="fu">rgamma</span>(<span class="dv">10</span><span class="sc">^</span><span class="dv">3</span>, a<span class="sc">+</span>y[<span class="dv">4</span>], b<span class="sc">+</span><span class="fu">length</span>(y[<span class="dv">4</span>])),</span>
<span id="cb48-14"><a href="gamma-poisson-and-estimating-counts.html#cb48-14" tabindex="-1"></a>  <span class="fu">rgamma</span>(<span class="dv">10</span><span class="sc">^</span><span class="dv">3</span>, a<span class="sc">+</span>y[<span class="dv">5</span>], b<span class="sc">+</span><span class="fu">length</span>(y[<span class="dv">5</span>]))</span>
<span id="cb48-15"><a href="gamma-poisson-and-estimating-counts.html#cb48-15" tabindex="-1"></a>)</span>
<span id="cb48-16"><a href="gamma-poisson-and-estimating-counts.html#cb48-16" tabindex="-1"></a></span>
<span id="cb48-17"><a href="gamma-poisson-and-estimating-counts.html#cb48-17" tabindex="-1"></a><span class="co"># -2 * Mean log-likelihood</span></span>
<span id="cb48-18"><a href="gamma-poisson-and-estimating-counts.html#cb48-18" tabindex="-1"></a>ll <span class="ot">&lt;-</span> </span>
<span id="cb48-19"><a href="gamma-poisson-and-estimating-counts.html#cb48-19" tabindex="-1"></a>  <span class="fu">dpois</span>(y[<span class="dv">1</span>], post[[<span class="dv">1</span>]], <span class="at">log =</span> <span class="cn">TRUE</span>) <span class="sc">+</span></span>
<span id="cb48-20"><a href="gamma-poisson-and-estimating-counts.html#cb48-20" tabindex="-1"></a>  <span class="fu">dpois</span>(y[<span class="dv">2</span>], post[[<span class="dv">2</span>]], <span class="at">log =</span> <span class="cn">TRUE</span>) <span class="sc">+</span></span>
<span id="cb48-21"><a href="gamma-poisson-and-estimating-counts.html#cb48-21" tabindex="-1"></a>  <span class="fu">dpois</span>(y[<span class="dv">3</span>], post[[<span class="dv">3</span>]], <span class="at">log =</span> <span class="cn">TRUE</span>) <span class="sc">+</span></span>
<span id="cb48-22"><a href="gamma-poisson-and-estimating-counts.html#cb48-22" tabindex="-1"></a>  <span class="fu">dpois</span>(y[<span class="dv">4</span>], post[[<span class="dv">4</span>]], <span class="at">log =</span> <span class="cn">TRUE</span>) <span class="sc">+</span></span>
<span id="cb48-23"><a href="gamma-poisson-and-estimating-counts.html#cb48-23" tabindex="-1"></a>  <span class="fu">dpois</span>(y[<span class="dv">5</span>], post[[<span class="dv">5</span>]], <span class="at">log =</span> <span class="cn">TRUE</span>)</span>
<span id="cb48-24"><a href="gamma-poisson-and-estimating-counts.html#cb48-24" tabindex="-1"></a>(mean_D <span class="ot">&lt;-</span> <span class="fu">mean</span>(<span class="sc">-</span><span class="dv">2</span> <span class="sc">*</span> ll))</span></code></pre></div>
<pre><code>## [1] 34.89608</code></pre>
<div class="sourceCode" id="cb50"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb50-1"><a href="gamma-poisson-and-estimating-counts.html#cb50-1" tabindex="-1"></a><span class="co"># D(theta-bar) is the likelihood of the data based on the posterior means of p.</span></span>
<span id="cb50-2"><a href="gamma-poisson-and-estimating-counts.html#cb50-2" tabindex="-1"></a>(D_mean <span class="ot">&lt;-</span> <span class="sc">-</span><span class="dv">2</span> <span class="sc">*</span> (</span>
<span id="cb50-3"><a href="gamma-poisson-and-estimating-counts.html#cb50-3" tabindex="-1"></a>  <span class="fu">dpois</span>(y[<span class="dv">1</span>], (a<span class="sc">+</span>y[<span class="dv">1</span>]) <span class="sc">/</span> (b<span class="sc">+</span><span class="fu">length</span>(y[<span class="dv">1</span>])), <span class="at">log =</span> <span class="cn">TRUE</span>) <span class="sc">+</span></span>
<span id="cb50-4"><a href="gamma-poisson-and-estimating-counts.html#cb50-4" tabindex="-1"></a>  <span class="fu">dpois</span>(y[<span class="dv">2</span>], (a<span class="sc">+</span>y[<span class="dv">2</span>]) <span class="sc">/</span> (b<span class="sc">+</span><span class="fu">length</span>(y[<span class="dv">2</span>])), <span class="at">log =</span> <span class="cn">TRUE</span>) <span class="sc">+</span></span>
<span id="cb50-5"><a href="gamma-poisson-and-estimating-counts.html#cb50-5" tabindex="-1"></a>  <span class="fu">dpois</span>(y[<span class="dv">3</span>], (a<span class="sc">+</span>y[<span class="dv">3</span>]) <span class="sc">/</span> (b<span class="sc">+</span><span class="fu">length</span>(y[<span class="dv">3</span>])), <span class="at">log =</span> <span class="cn">TRUE</span>) <span class="sc">+</span></span>
<span id="cb50-6"><a href="gamma-poisson-and-estimating-counts.html#cb50-6" tabindex="-1"></a>  <span class="fu">dpois</span>(y[<span class="dv">4</span>], (a<span class="sc">+</span>y[<span class="dv">4</span>]) <span class="sc">/</span> (b<span class="sc">+</span><span class="fu">length</span>(y[<span class="dv">4</span>])), <span class="at">log =</span> <span class="cn">TRUE</span>) <span class="sc">+</span></span>
<span id="cb50-7"><a href="gamma-poisson-and-estimating-counts.html#cb50-7" tabindex="-1"></a>  <span class="fu">dpois</span>(y[<span class="dv">5</span>], (a<span class="sc">+</span>y[<span class="dv">5</span>]) <span class="sc">/</span> (b<span class="sc">+</span><span class="fu">length</span>(y[<span class="dv">5</span>])), <span class="at">log =</span> <span class="cn">TRUE</span>) </span>
<span id="cb50-8"><a href="gamma-poisson-and-estimating-counts.html#cb50-8" tabindex="-1"></a>))</span></code></pre></div>
<pre><code>## [1] 29.98793</code></pre>
<div class="sourceCode" id="cb52"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb52-1"><a href="gamma-poisson-and-estimating-counts.html#cb52-1" tabindex="-1"></a><span class="co">#p_D and DIC from equation</span></span>
<span id="cb52-2"><a href="gamma-poisson-and-estimating-counts.html#cb52-2" tabindex="-1"></a>(p_D <span class="ot">&lt;-</span> mean_D <span class="sc">-</span> D_mean)</span></code></pre></div>
<pre><code>## [1] 4.908155</code></pre>
<div class="sourceCode" id="cb54"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb54-1"><a href="gamma-poisson-and-estimating-counts.html#cb54-1" tabindex="-1"></a>(DIC <span class="ot">&lt;-</span> p_D <span class="sc">+</span> mean_D)</span></code></pre></div>
<pre><code>## [1] 39.80424</code></pre>
<div class="sourceCode" id="cb56"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb56-1"><a href="gamma-poisson-and-estimating-counts.html#cb56-1" tabindex="-1"></a><span class="co"># Repeat these steps for a single model of all groups</span></span>
<span id="cb56-2"><a href="gamma-poisson-and-estimating-counts.html#cb56-2" tabindex="-1"></a>post_group <span class="ot">&lt;-</span> <span class="fu">rgamma</span>(<span class="dv">10</span><span class="sc">^</span><span class="dv">3</span>, a<span class="sc">+</span><span class="fu">sum</span>(y), b<span class="sc">+</span><span class="fu">length</span>(y))</span>
<span id="cb56-3"><a href="gamma-poisson-and-estimating-counts.html#cb56-3" tabindex="-1"></a>ll_group <span class="ot">&lt;-</span> </span>
<span id="cb56-4"><a href="gamma-poisson-and-estimating-counts.html#cb56-4" tabindex="-1"></a>  <span class="fu">dpois</span>(y[<span class="dv">1</span>], post_group, <span class="at">log =</span> <span class="cn">TRUE</span>) <span class="sc">+</span></span>
<span id="cb56-5"><a href="gamma-poisson-and-estimating-counts.html#cb56-5" tabindex="-1"></a>  <span class="fu">dpois</span>(y[<span class="dv">2</span>], post_group, <span class="at">log =</span> <span class="cn">TRUE</span>) <span class="sc">+</span></span>
<span id="cb56-6"><a href="gamma-poisson-and-estimating-counts.html#cb56-6" tabindex="-1"></a>  <span class="fu">dpois</span>(y[<span class="dv">3</span>], post_group, <span class="at">log =</span> <span class="cn">TRUE</span>) <span class="sc">+</span></span>
<span id="cb56-7"><a href="gamma-poisson-and-estimating-counts.html#cb56-7" tabindex="-1"></a>  <span class="fu">dpois</span>(y[<span class="dv">4</span>], post_group, <span class="at">log =</span> <span class="cn">TRUE</span>) <span class="sc">+</span></span>
<span id="cb56-8"><a href="gamma-poisson-and-estimating-counts.html#cb56-8" tabindex="-1"></a>  <span class="fu">dpois</span>(y[<span class="dv">5</span>], post_group, <span class="at">log =</span> <span class="cn">TRUE</span>)</span>
<span id="cb56-9"><a href="gamma-poisson-and-estimating-counts.html#cb56-9" tabindex="-1"></a>(mean_D_group <span class="ot">&lt;-</span> <span class="fu">mean</span>(<span class="sc">-</span><span class="dv">2</span> <span class="sc">*</span> ll_group))</span></code></pre></div>
<pre><code>## [1] 35.87018</code></pre>
<div class="sourceCode" id="cb58"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb58-1"><a href="gamma-poisson-and-estimating-counts.html#cb58-1" tabindex="-1"></a>(D_mean_group <span class="ot">&lt;-</span> <span class="sc">-</span><span class="dv">2</span> <span class="sc">*</span> (</span>
<span id="cb58-2"><a href="gamma-poisson-and-estimating-counts.html#cb58-2" tabindex="-1"></a>  <span class="fu">dpois</span>(y[<span class="dv">1</span>], (a<span class="sc">+</span><span class="fu">sum</span>(y)) <span class="sc">/</span> (b<span class="sc">+</span><span class="fu">length</span>(y)), <span class="at">log =</span> <span class="cn">TRUE</span>) <span class="sc">+</span></span>
<span id="cb58-3"><a href="gamma-poisson-and-estimating-counts.html#cb58-3" tabindex="-1"></a>  <span class="fu">dpois</span>(y[<span class="dv">2</span>], (a<span class="sc">+</span><span class="fu">sum</span>(y)) <span class="sc">/</span> (b<span class="sc">+</span><span class="fu">length</span>(y)), <span class="at">log =</span> <span class="cn">TRUE</span>) <span class="sc">+</span></span>
<span id="cb58-4"><a href="gamma-poisson-and-estimating-counts.html#cb58-4" tabindex="-1"></a>  <span class="fu">dpois</span>(y[<span class="dv">3</span>], (a<span class="sc">+</span><span class="fu">sum</span>(y)) <span class="sc">/</span> (b<span class="sc">+</span><span class="fu">length</span>(y)), <span class="at">log =</span> <span class="cn">TRUE</span>) <span class="sc">+</span></span>
<span id="cb58-5"><a href="gamma-poisson-and-estimating-counts.html#cb58-5" tabindex="-1"></a>  <span class="fu">dpois</span>(y[<span class="dv">4</span>], (a<span class="sc">+</span><span class="fu">sum</span>(y)) <span class="sc">/</span> (b<span class="sc">+</span><span class="fu">length</span>(y)), <span class="at">log =</span> <span class="cn">TRUE</span>) <span class="sc">+</span></span>
<span id="cb58-6"><a href="gamma-poisson-and-estimating-counts.html#cb58-6" tabindex="-1"></a>  <span class="fu">dpois</span>(y[<span class="dv">5</span>], (a<span class="sc">+</span><span class="fu">sum</span>(y)) <span class="sc">/</span> (b<span class="sc">+</span><span class="fu">length</span>(y)), <span class="at">log =</span> <span class="cn">TRUE</span>)</span>
<span id="cb58-7"><a href="gamma-poisson-and-estimating-counts.html#cb58-7" tabindex="-1"></a>))</span></code></pre></div>
<pre><code>## [1] 34.81027</code></pre>
<div class="sourceCode" id="cb60"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb60-1"><a href="gamma-poisson-and-estimating-counts.html#cb60-1" tabindex="-1"></a>(p_D_group <span class="ot">&lt;-</span> mean_D_group <span class="sc">-</span> D_mean_group)</span></code></pre></div>
<pre><code>## [1] 1.059915</code></pre>
<div class="sourceCode" id="cb62"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb62-1"><a href="gamma-poisson-and-estimating-counts.html#cb62-1" tabindex="-1"></a>(DIC_group <span class="ot">&lt;-</span> p_D_group <span class="sc">+</span> mean_D_group)</span></code></pre></div>
<pre><code>## [1] 36.9301</code></pre>
<p>The DIC for the weekday specific model is 39.8042369 and for the one common group model it is 36.9300995. The DIC for one common group model is smaller, so we do not have enough statistical evidence for two groups.</p>
</div>
<div class="footnotes">
<hr />
<ol start="3">
<li id="fn3"><p>The gamma function is a generic function, just like sin, cos, etc., and is a kind of generalized factorial.<a href="gamma-poisson-and-estimating-counts.html#fnref3" class="footnote-back">↩︎</a></p></li>
</ol>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="markov-chain-monte-carlo-mcmc.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="normal-and-estimating-means.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="assets/gitbook-2.6.7/js/app.min.js"></script>
<script src="assets/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="assets/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="assets/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="assets/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="assets/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="assets/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="assets/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection",
"scroll_highlight": true
},
"toolbar": {
"position": "static"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
